<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of UncertView</title>
  <meta name="keywords" content="UncertView">
  <meta name="description" content=" is an extra subGUI to show results of the uncertainty">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../../../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- # nucleus --><!-- # functions --><!-- ../menu.html interface --><!-- menu.html subGUIs -->
<h1>UncertView
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="box"><strong> is an extra subGUI to show results of the uncertainty</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="box"><strong>function UncertView(src,~) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="fragment"><pre class="comment">UncertView is an extra subGUI to show results of the uncertainty
calculation

 Syntax:
       UncertView

 Inputs:
       src - handle of the calling object

 Outputs:
       none

 Example:
       UncertView(src,~)

 Other m-files required:
       beautifyAxes
       clearAllAxes
       estimateUncertainty
       createKernelMatrix
       updatePlotsSignal
       updatePlotsDistribution
       updateInfo

 Subfunctions:
       uv_closeme
       uv_onEditValue
       uv_updateMASK
       uv_onPushRun
       uv_onPushUpdate
       uv_onPushReset
       uv_updateInformation
       uv_updatePlots

 MAT-files required:
       none

 See also: NUCLEUSinv
 Author: see AUTHORS.md
 email: see AUTHORS.md
 License: MIT License (at end)</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../../matlabicon.gif)">
<li><a href="../../../../nucleus/callbacks/menus/onMenuView.html" class="code" title="function onMenuView(src,~)">onMenuView</a>	 handles the view menu entries</li><li><a href="../../../../nucleus/functions/interface/beautifyAxes.html" class="code" title="function beautifyAxes(figh)">beautifyAxes</a>	 can be used to globally change the general appearance of axes</li><li><a href="../../../../nucleus/functions/interface/changeColorTheme.html" class="code" title="function changeColorTheme(fig_tag,th)">changeColorTheme</a>	 changes the color theme of the calling figure</li><li><a href="../../../../nucleus/functions/interface/clearAllAxes.html" class="code" title="function clearAllAxes(figh)">clearAllAxes</a>	 clears all axes of a given figure</li><li><a href="../../../../nucleus/functions/interface/displayStatusText.html" class="code" title="function displayStatusText(gui,string)">displayStatusText</a>	 shows status information either in the GUI or on the</li><li><a href="../../../../nucleus/functions/interface/fixVerticalTextAlignment.html" class="code" title="function fixVerticalTextAlignment(fig)">fixVerticalTextAlignment</a>	 fixes the vertical positioning of all text</li><li><a href="../../../../nucleus/functions/interface/getKernelDensityEstimate.html" class="code" title="function [f,x] = getKernelDensityEstimate(y)">getKernelDensityEstimate</a>	 computes the one dimensional kernel density estimate</li><li><a href="../../../../nucleus/functions/interface/minimizePanel.html" class="code" title="function minimizePanel(src,~)">minimizePanel</a>	 handles the minimization/maximization of all box-panels for</li><li><a href="../../../../nucleus/functions/interface/updateInfo.html" class="code" title="function updateInfo(src,~) %#ok<INUSD>">updateInfo</a>	 updates the information shown in all information list boxes</li><li><a href="../../../../nucleus/functions/interface/updatePlotsDistribution.html" class="code" title="function updatePlotsDistribution">updatePlotsDistribution</a>	 plots the RTD and PSD curves into NUCLEUSinv</li><li><a href="../../../../nucleus/functions/interface/updatePlotsSignal.html" class="code" title="function updatePlotsSignal">updatePlotsSignal</a>	 plots the raw and processed NMR signals in NUCLEUSinv</li><li><a href="../../../../nucleus/functions/inversion/createKernelMatrix.html" class="code" title="function K = createKernelMatrix(t,T,Tbulk,Tdiff,Tflag,T1IRfac)">createKernelMatrix</a>	 creates a Kernel matrix from signal time vector "t"</li><li><a href="../../../../nucleus/functions/inversion/estimateUncertainty.html" class="code" title="function [invstd,uncert] = estimateUncertainty(invtype,invstd,iparam,parameter)">estimateUncertainty</a>	 calculates pseudo uncertainty estimates for multi</li><li><a href="../../../../nucleus/functions/inversion/getAAD.html" class="code" title="function aad = getAAD(x,flag,dim)">getAAD</a>	 gets the average absolute deviation from the values in x</li><li><a href="../../../../nucleus/functions/inversion/getUncertaintyStatistics.html" class="code" title="function out = getUncertaintyStatistics(T,RTDs,range,K0)">getUncertaintyStatistics</a>	</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../../matlabicon.gif)">
<li><a href="../../../../nucleus/callbacks/listboxes/onListboxData.html" class="code" title="function onListboxData(src,~)">onListboxData</a>	 handles the calls from the context menu of the data</li><li><a href="../../../../nucleus/callbacks/menus/onMenuSubGUIs.html" class="code" title="function onMenuSubGUIs(src,~)">onMenuSubGUIs</a>	 handles the extra menu entries to open NUCLEUS sub GUIs</li><li><a href="../../../../nucleus/functions/inversion/runUncertaintyCalculation.html" class="code" title="function runUncertaintyCalculation">runUncertaintyCalculation</a>	 caluclates inverison statistics in some kind of</li></ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<ul style="list-style-image:url(../../../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function uv_onEditValue(src,~)</a></li><li><a href="#_sub2" class="code">function uv_onPushSend(src,~)</a></li><li><a href="#_sub3" class="code">function uv_onContextPlotsColor(src,~)</a></li><li><a href="#_sub4" class="code">function uv_onContextPlotsRTD(src,~)</a></li><li><a href="#_sub5" class="code">function data = uv_updateMASK(data)</a></li><li><a href="#_sub6" class="code">function uv_onPopupMethod(src,~)</a></li><li><a href="#_sub7" class="code">function uv_onPushRun(src,~)</a></li><li><a href="#_sub8" class="code">function uv_onPushView(src,~)</a></li><li><a href="#_sub9" class="code">function uv_onPushUpdate(src,~)</a></li><li><a href="#_sub10" class="code">function uv_onPushReset(src,~)</a></li><li><a href="#_sub11" class="code">function uv_updateInformation(figh)</a></li><li><a href="#_sub12" class="code">function uv_updatePlots(figh)</a></li><li><a href="#_sub13" class="code">function uv_closeme(src,~)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function UncertView(src,~)</a>
0002 <span class="comment">%UncertView is an extra subGUI to show results of the uncertainty</span>
0003 <span class="comment">%calculation</span>
0004 <span class="comment">%</span>
0005 <span class="comment">% Syntax:</span>
0006 <span class="comment">%       UncertView</span>
0007 <span class="comment">%</span>
0008 <span class="comment">% Inputs:</span>
0009 <span class="comment">%       src - handle of the calling object</span>
0010 <span class="comment">%</span>
0011 <span class="comment">% Outputs:</span>
0012 <span class="comment">%       none</span>
0013 <span class="comment">%</span>
0014 <span class="comment">% Example:</span>
0015 <span class="comment">%       UncertView(src,~)</span>
0016 <span class="comment">%</span>
0017 <span class="comment">% Other m-files required:</span>
0018 <span class="comment">%       beautifyAxes</span>
0019 <span class="comment">%       clearAllAxes</span>
0020 <span class="comment">%       estimateUncertainty</span>
0021 <span class="comment">%       createKernelMatrix</span>
0022 <span class="comment">%       updatePlotsSignal</span>
0023 <span class="comment">%       updatePlotsDistribution</span>
0024 <span class="comment">%       updateInfo</span>
0025 <span class="comment">%</span>
0026 <span class="comment">% Subfunctions:</span>
0027 <span class="comment">%       uv_closeme</span>
0028 <span class="comment">%       uv_onEditValue</span>
0029 <span class="comment">%       uv_updateMASK</span>
0030 <span class="comment">%       uv_onPushRun</span>
0031 <span class="comment">%       uv_onPushUpdate</span>
0032 <span class="comment">%       uv_onPushReset</span>
0033 <span class="comment">%       uv_updateInformation</span>
0034 <span class="comment">%       uv_updatePlots</span>
0035 <span class="comment">%</span>
0036 <span class="comment">% MAT-files required:</span>
0037 <span class="comment">%       none</span>
0038 <span class="comment">%</span>
0039 <span class="comment">% See also: NUCLEUSinv</span>
0040 <span class="comment">% Author: see AUTHORS.md</span>
0041 <span class="comment">% email: see AUTHORS.md</span>
0042 <span class="comment">% License: MIT License (at end)</span>
0043 
0044 <span class="comment">%------------- BEGIN CODE --------------</span>
0045 
0046 <span class="comment">%% get GUI handle and data</span>
0047 figh_nucleus = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
0048 nucleus.data = getappdata(figh_nucleus,<span class="string">'data'</span>);
0049 nucleus.gui = getappdata(figh_nucleus,<span class="string">'gui'</span>);
0050 myui = nucleus.gui.myui;
0051 colors = myui.colors;
0052 
0053 hasUncert = false;
0054 <span class="keyword">if</span> isfield(nucleus.data.results,<span class="string">'invstd'</span>)
0055     <span class="keyword">if</span> isfield(nucleus.data.results.invstd,<span class="string">'uncert'</span>)
0056         hasUncert = true;
0057     <span class="keyword">end</span>
0058 <span class="keyword">end</span>
0059 
0060 <span class="comment">%% proceed only if there is already uncertainty data</span>
0061 <span class="keyword">if</span> hasUncert
0062     nucleus_data = nucleus.data;
0063 
0064     <span class="comment">% check if the figure is already open</span>
0065     fig_uncert = findobj(<span class="string">'Tag'</span>,<span class="string">'UNCERTVIEW'</span>);
0066     <span class="comment">% if not, create it</span>
0067     <span class="keyword">if</span> isempty(fig_uncert)
0068         <span class="comment">% draw the figure on top of NUCLEUSinv</span>
0069         fig_uncert = figure(<span class="string">'Name'</span>,<span class="string">'NUCLEUSinv - RTD Uncertainty'</span>,<span class="keyword">...</span>
0070             <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>,<span class="string">'Resize'</span>,<span class="string">'on'</span>,<span class="string">'ToolBar'</span>,<span class="string">'none'</span>,<span class="keyword">...</span>
0071             <span class="string">'CloseRequestFcn'</span>,@<a href="#_sub13" class="code" title="subfunction uv_closeme(src,~)">uv_closeme</a>,<span class="keyword">...</span>
0072             <span class="string">'MenuBar'</span>,<span class="string">'none'</span>,<span class="string">'Tag'</span>,<span class="string">'UNCERTVIEW'</span>);
0073         pos0 = get(figh_nucleus,<span class="string">'Position'</span>);
0074         cent(1) = (pos0(1)+pos0(3)/2);
0075         cent(2) = (pos0(2)+pos0(4)/2);
0076         <span class="comment">% posf = [cent(1)-pos0(3)/3 pos0(2)+22 pos0(3)/1.5 pos0(4)-22];</span>
0077         posf = [cent(1)-pos0(3)/2.5 pos0(2)+22 pos0(3)/1.25 pos0(4)-22];
0078         set(fig_uncert,<span class="string">'Position'</span>,posf);
0079 
0080         gui.menu.view = uimenu(fig_uncert,<span class="string">'Label'</span>,<span class="string">'View'</span>);
0081         gui.menu.view_toolbar = uimenu(gui.menu.view,<span class="string">'Label'</span>,<span class="string">'Figure Toolbar'</span>,<span class="keyword">...</span>
0082             <span class="string">'Callback'</span>,@<a href="../../../../nucleus/callbacks/menus/onMenuView.html" class="code" title="function onMenuView(src,~)">onMenuView</a>);
0083 
0084         cpanel_w = 175;
0085 
0086         <span class="comment">% create the main layout</span>
0087         gui.main = uix.HBox(<span class="string">'Parent'</span>,fig_uncert,<span class="string">'BackGroundColor'</span>,colors.panelBG,<span class="keyword">...</span>
0088             <span class="string">'Spacing'</span>,5,<span class="string">'Padding'</span>,5,<span class="string">'Visible'</span>,<span class="string">'off'</span>);
0089         gui.left = uix.VBox(<span class="string">'Parent'</span>,gui.main,<span class="string">'BackGroundColor'</span>,colors.panelBG,<span class="keyword">...</span>
0090             <span class="string">'Spacing'</span>,5,<span class="string">'Padding'</span>,0); <span class="comment">% controls</span>
0091         gui.right = uix.VBox(<span class="string">'Parent'</span>,gui.main,<span class="string">'BackGroundColor'</span>,colors.panelBG,<span class="keyword">...</span>
0092             <span class="string">'Spacing'</span>,5,<span class="string">'Padding'</span>,0); <span class="comment">% plots</span>
0093 
0094         set(gui.main,<span class="string">'Widths'</span>,[350 -1 ]);
0095 
0096         <span class="comment">% waitbar indicating the loading of the GUI</span>
0097         steps = 5;
0098         hwb = waitbar(0,<span class="string">'loading ...'</span>,<span class="string">'Name'</span>,<span class="string">'UncertView initialization'</span>,<span class="string">'Visible'</span>,<span class="string">'off'</span>);
0099         set(hwb,<span class="string">'Units'</span>,<span class="string">'Pixel'</span>)
0100         posw = get(hwb,<span class="string">'Position'</span>);
0101         set(hwb,<span class="string">'Position'</span>,[posf(1)+posf(3)/2-posw(3)/2 posf(2)+posf(4)/2-posw(4)/2 posw(3:4)]);
0102         set(hwb,<span class="string">'Visible'</span>,<span class="string">'on'</span>);
0103 
0104         <span class="comment">% --- control panel ---</span>
0105         waitbar(1/steps,hwb,<span class="string">'loading GUI elements - control'</span>);
0106         gui.panels.control.main = uix.BoxPanel(<span class="string">'Parent'</span>,gui.left,<span class="keyword">...</span>
0107             <span class="string">'Title'</span>,<span class="string">'Recalculate RTD Uncertainty'</span>,<span class="string">'MinimizeFcn'</span>,@<a href="../../../../nucleus/functions/interface/minimizePanel.html" class="code" title="function minimizePanel(src,~)">minimizePanel</a>,<span class="keyword">...</span>
0108             <span class="string">'TitleColor'</span>,colors.BoxINV,<span class="string">'ForegroundColor'</span>,colors.BoxTitle);
0109         gui.panels.control.VBox = uix.VBox(<span class="string">'Parent'</span>,gui.panels.control.main,<span class="keyword">...</span>
0110             <span class="string">'Spacing'</span>,3,<span class="string">'Padding'</span>,3);
0111         <span class="comment">% uncertainty method</span>
0112         gui.panels.control.HBox1 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.control.VBox,<span class="keyword">...</span>
0113             <span class="string">'Spacing'</span>,3);
0114         gui.text_handles.uncertMethod = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox1,<span class="keyword">...</span>
0115             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0116             <span class="string">'String'</span>,<span class="string">'Method'</span>);
0117         tstr = [<span class="string">'&lt;HTML&gt;Choose the uncertainty calculation method.&lt;br&gt;&lt;br&gt;'</span>,<span class="keyword">...</span>
0118             <span class="string">'&lt;u&gt;Available options:&lt;/u&gt;&lt;br&gt;'</span>,<span class="keyword">...</span>
0119             <span class="string">'&lt;font color=&quot;red&quot;&gt;Multi exp. (LSQ) | Multi exp. (LU decomp.):&lt;br&gt;'</span>,<span class="keyword">...</span>
0120             <span class="string">'&lt;font color=&quot;black&quot;&gt;'</span>,<span class="keyword">...</span>
0121             <span class="string">'&lt;b&gt;RMS - unbounded&lt;/b&gt; Keep all uncert models.&lt;br&gt;'</span>,<span class="keyword">...</span>
0122             <span class="string">'&lt;b&gt;RMS - bounded&lt;/b&gt; Only keep models within Lm and chi2 bounds.&lt;br&gt;'</span>,<span class="keyword">...</span>
0123             <span class="string">'&lt;font color=&quot;red&quot;&gt;Multi modal:&lt;br&gt;'</span>,<span class="keyword">...</span>
0124             <span class="string">'&lt;font color=&quot;black&quot;&gt;'</span>,<span class="keyword">...</span>
0125             <span class="string">'&lt;b&gt;RMS - unbounded&lt;/b&gt; Keep all uncert models.&lt;br&gt;'</span>,<span class="keyword">...</span>
0126             <span class="string">'&lt;b&gt;RMS - bounded&lt;/b&gt; Only keep models within Lm and chi2 bounds.&lt;br&gt;'</span>,<span class="keyword">...</span>
0127             <span class="string">'&lt;b&gt;Threshold&lt;/b&gt; Vary fit parameter by threshold.&lt;br&gt;'</span>,<span class="keyword">...</span>
0128             <span class="string">'&lt;b&gt;Conf. Interval&lt;/b&gt; Vary fit parameter randomly within confidence interval.&lt;br&gt;&lt;br&gt;'</span>,<span class="keyword">...</span>
0129             <span class="string">'&lt;u&gt;Default value:&lt;/u&gt;&lt;br&gt;'</span>,<span class="keyword">...</span>
0130             <span class="string">'&lt;b&gt;RMS - bounded&lt;/b&gt;&lt;br&gt;'</span>];
0131         gui.popup_handles.uncertMethod = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox1,<span class="keyword">...</span>
0132             <span class="string">'Style'</span>,<span class="string">'popup'</span>,<span class="string">'String'</span>,{<span class="string">'RMS - unbounded'</span>,<span class="string">'RMS - bounded'</span>},<span class="keyword">...</span>
0133             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0134             <span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'control'</span>,<span class="string">'Callback'</span>,@<a href="#_sub6" class="code" title="subfunction uv_onPopupMethod(src,~)">uv_onPopupMethod</a>);
0135         set(gui.panels.control.HBox1,<span class="string">'Widths'</span>,[cpanel_w -1]);
0136         <span class="comment">% number of uncertainty models</span>
0137         gui.panels.control.HBox2 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.control.VBox,<span class="keyword">...</span>
0138             <span class="string">'Spacing'</span>,3);
0139         gui.text_handles.uncertN = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox2,<span class="keyword">...</span>
0140             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0141             <span class="string">'String'</span>,<span class="string">'#models'</span>);
0142         uix.Empty(<span class="string">'Parent'</span>,gui.panels.control.HBox2);
0143         tstr = <span class="string">'Number of uncertainty models to calculate.'</span>;
0144         gui.edit_handles.uncertN = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox2,<span class="keyword">...</span>
0145             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'uncertN'</span>,<span class="keyword">...</span>
0146             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0147             <span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0148         set(gui.panels.control.HBox2,<span class="string">'Widths'</span>,[cpanel_w -1 -1]);
0149         <span class="comment">% bound1: chi2 range</span>
0150         gui.panels.control.HBox3 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.control.VBox,<span class="keyword">...</span>
0151             <span class="string">'Spacing'</span>,3);
0152         gui.text_handles.uncertchi2 = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox3,<span class="keyword">...</span>
0153             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0154             <span class="string">'String'</span>,[char(hex2dec(<span class="string">'03A7'</span>)),char(hex2dec(<span class="string">'00B2'</span>)),<span class="keyword">...</span>
0155             <span class="string">' range          min | max'</span>]);
0156         tstr = <span class="string">'Lower bound of chi2 range.'</span>;
0157         gui.edit_handles.uncertchi2_min = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox3,<span class="keyword">...</span>
0158             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'control'</span>,<span class="keyword">...</span>
0159             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0160             <span class="string">'Enable'</span>,<span class="string">'off'</span>,<span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0161         tstr = <span class="string">'Upper bound of chi2 range.'</span>;
0162         gui.edit_handles.uncertchi2_max = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox3,<span class="keyword">...</span>
0163             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'control'</span>,<span class="keyword">...</span>
0164             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0165             <span class="string">'Enable'</span>,<span class="string">'off'</span>,<span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0166         set(gui.panels.control.HBox3,<span class="string">'Widths'</span>,[cpanel_w -1 -1]);
0167         <span class="comment">% bound2: model norm range</span>
0168         gui.panels.control.HBox4 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.control.VBox,<span class="keyword">...</span>
0169             <span class="string">'Spacing'</span>,3);
0170         gui.text_handles.uncertmnorm = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox4,<span class="keyword">...</span>
0171             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0172             <span class="string">'String'</span>,[<span class="string">'|Lm|'</span>,char(hex2dec(<span class="string">'2082'</span>)),<span class="string">' range      min | max'</span>]);
0173         tstr = <span class="string">'Lower bound of model norm range.'</span>;
0174         gui.edit_handles.uncertmnorm_min = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox4,<span class="keyword">...</span>
0175             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'control'</span>,<span class="keyword">...</span>
0176             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0177             <span class="string">'Enable'</span>,<span class="string">'off'</span>,<span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0178         tstr = <span class="string">'Upper bound of model norm range.'</span>;
0179         gui.edit_handles.uncertmnorm_max = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox4,<span class="keyword">...</span>
0180             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'control'</span>,<span class="keyword">...</span>
0181             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0182             <span class="string">'Enable'</span>,<span class="string">'off'</span>,<span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0183         set(gui.panels.control.HBox4,<span class="string">'Widths'</span>,[cpanel_w -1 -1]);
0184         <span class="comment">% bound3: threshold</span>
0185         gui.panels.control.HBox5 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.control.VBox,<span class="keyword">...</span>
0186             <span class="string">'Spacing'</span>,3);
0187         gui.text_handles.uncertThresh = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox5,<span class="keyword">...</span>
0188             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0189             <span class="string">'String'</span>,<span class="string">'Threshold   |   Max. #tries'</span>);
0190         <span class="comment">% uix.Empty('Parent',gui.panels.control.HBox5);</span>
0191         tstr = <span class="string">'Threshold value (0.05 = 5%).'</span>;
0192         gui.edit_handles.uncertThresh = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox5,<span class="keyword">...</span>
0193             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'uncertThresh'</span>,<span class="keyword">...</span>
0194             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0195             <span class="string">'Enable'</span>,<span class="string">'off'</span>,<span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0196         <span class="comment">% set(gui.panels.control.HBox5,'Widths',[cpanel_w -1 -1]);</span>
0197         <span class="comment">% max tries</span>
0198         <span class="comment">% gui.panels.control.HBox6 = uix.HBox('Parent',gui.panels.control.VBox,...</span>
0199         <span class="comment">%     'Spacing',3);</span>
0200         <span class="comment">% gui.text_handles.uncertMax = uicontrol('Parent',gui.panels.control.HBox6,...</span>
0201         <span class="comment">%     'Style','text','FontSize',myui.fontsize,'HorizontalAlignment','center',...</span>
0202         <span class="comment">%     'String','Max. #tries');</span>
0203         <span class="comment">% uix.Empty('Parent',gui.panels.control.HBox6);</span>
0204         tstr = <span class="string">'Maximum number of unsuccesful tries.'</span>;
0205         gui.edit_handles.uncertMax = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox5,<span class="keyword">...</span>
0206             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'uncertMax'</span>,<span class="keyword">...</span>
0207             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0208             <span class="string">'Enable'</span>,<span class="string">'off'</span>,<span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0209         set(gui.panels.control.HBox5,<span class="string">'Widths'</span>,[cpanel_w -1 -1]);
0210         <span class="comment">% RUN button</span>
0211         gui.panels.control.HBox7 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.control.VBox,<span class="keyword">...</span>
0212             <span class="string">'Spacing'</span>,3);
0213         uix.Empty(<span class="string">'Parent'</span>,gui.panels.control.HBox7);        
0214         tstr = [<span class="string">'&lt;HTML&gt;RUN uncertainty calculation.&lt;br&gt;'</span>,<span class="keyword">...</span>
0215             <span class="string">'Regularization is the same as in main NUCLEUSinv GUI.'</span>];
0216         gui.push_handles.run = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox7,<span class="keyword">...</span>
0217             <span class="string">'String'</span>,<span class="string">'RUN UNCERT'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'process'</span>,<span class="keyword">...</span>
0218             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0219             <span class="string">'BackGroundColor'</span>,<span class="string">'g'</span>,<span class="string">'Callback'</span>,@<a href="#_sub7" class="code" title="subfunction uv_onPushRun(src,~)">uv_onPushRun</a>);
0220         set(gui.panels.control.HBox7,<span class="string">'Widths'</span>,[cpanel_w -1]);
0221 
0222         <span class="comment">% --- process panel ---</span>
0223         waitbar(2/steps,hwb,<span class="string">'loading GUI elements - process'</span>);
0224         gui.panels.process.main = uix.BoxPanel(<span class="string">'Parent'</span>,gui.left,<span class="keyword">...</span>
0225             <span class="string">'Title'</span>,<span class="string">'Process Uncertainty Runs'</span>,<span class="string">'MinimizeFcn'</span>,@<a href="../../../../nucleus/functions/interface/minimizePanel.html" class="code" title="function minimizePanel(src,~)">minimizePanel</a>,<span class="keyword">...</span>
0226             <span class="string">'TitleColor'</span>,colors.BoxINV,<span class="string">'ForegroundColor'</span>,colors.BoxTitle);
0227         gui.panels.process.VBox = uix.VBox(<span class="string">'Parent'</span>,gui.panels.process.main,<span class="keyword">...</span>
0228             <span class="string">'Spacing'</span>,3,<span class="string">'Padding'</span>,3);
0229         <span class="comment">% chi2 range</span>
0230         gui.panels.process.HBox1 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.process.VBox,<span class="keyword">...</span>
0231             <span class="string">'Spacing'</span>,3);
0232         gui.text_handles.chi2 = uicontrol(<span class="string">'Parent'</span>,gui.panels.process.HBox1,<span class="keyword">...</span>
0233             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0234             <span class="string">'String'</span>,[char(hex2dec(<span class="string">'03A7'</span>)),char(hex2dec(<span class="string">'00B2'</span>)),<span class="keyword">...</span>
0235             <span class="string">' range          min | max'</span>]);
0236         tstr = <span class="string">'Lower bound of chi2 range.'</span>;
0237         gui.edit_handles.chi2_min = uicontrol(<span class="string">'Parent'</span>,gui.panels.process.HBox1,<span class="keyword">...</span>
0238             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'process'</span>,<span class="keyword">...</span>
0239             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0240             <span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0241         tstr = <span class="string">'Upper bound of chi2 range.'</span>;
0242         gui.edit_handles.chi2_max = uicontrol(<span class="string">'Parent'</span>,gui.panels.process.HBox1,<span class="keyword">...</span>
0243             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'2'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'process'</span>,<span class="keyword">...</span>
0244             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0245             <span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0246         set(gui.panels.process.HBox1,<span class="string">'Widths'</span>,[cpanel_w -1 -1]);
0247         <span class="comment">% model norm range</span>
0248         gui.panels.process.HBox2 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.process.VBox,<span class="keyword">...</span>
0249             <span class="string">'Spacing'</span>,3);
0250         gui.text_handles.mnorm = uicontrol(<span class="string">'Parent'</span>,gui.panels.process.HBox2,<span class="keyword">...</span>
0251             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0252             <span class="string">'String'</span>,[<span class="string">'|Lm|'</span>,char(hex2dec(<span class="string">'2082'</span>)),<span class="string">' range      min | max'</span>]);
0253         tstr = <span class="string">'Lower bound of model norm range.'</span>;
0254         gui.edit_handles.mnorm_min = uicontrol(<span class="string">'Parent'</span>,gui.panels.process.HBox2,<span class="keyword">...</span>
0255             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'process'</span>,<span class="keyword">...</span>
0256             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0257             <span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0258         tstr = <span class="string">'Upper bound of model norm range.'</span>;
0259         gui.edit_handles.mnorm_max = uicontrol(<span class="string">'Parent'</span>,gui.panels.process.HBox2,<span class="keyword">...</span>
0260             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'2'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'process'</span>,<span class="keyword">...</span>
0261             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0262             <span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0263         set(gui.panels.process.HBox2,<span class="string">'Widths'</span>,[cpanel_w -1 -1]);
0264         <span class="comment">% RESET button</span>
0265         gui.panels.process.HBox3 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.process.VBox,<span class="keyword">...</span>
0266             <span class="string">'Spacing'</span>,3);
0267         uix.Empty(<span class="string">'Parent'</span>,gui.panels.process.HBox3);
0268         tstr = <span class="string">'SEND bounds to recaluclation panel above.'</span>;
0269         gui.push_handles.send = uicontrol(<span class="string">'Parent'</span>,gui.panels.process.HBox3,<span class="keyword">...</span>
0270             <span class="string">'String'</span>,<span class="string">'USE'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'process'</span>,<span class="keyword">...</span>
0271             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0272             <span class="string">'Callback'</span>,@<a href="#_sub2" class="code" title="subfunction uv_onPushSend(src,~)">uv_onPushSend</a>);
0273         tstr = <span class="string">'RESET processing bounds and plots.'</span>;
0274         gui.push_handles.reset = uicontrol(<span class="string">'Parent'</span>,gui.panels.process.HBox3,<span class="keyword">...</span>
0275             <span class="string">'String'</span>,<span class="string">'RESET'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'process'</span>,<span class="keyword">...</span>
0276             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0277             <span class="string">'Callback'</span>,@<a href="#_sub10" class="code" title="subfunction uv_onPushReset(src,~)">uv_onPushReset</a>);
0278         set(gui.panels.process.HBox3,<span class="string">'Widths'</span>,[cpanel_w -1 -1]);
0279 
0280         <span class="comment">% --- RTD panel ---</span>
0281         waitbar(3/steps,hwb,<span class="string">'loading GUI elements - RTD bounds'</span>);
0282         gui.panels.rtd.main = uix.BoxPanel(<span class="string">'Parent'</span>,gui.left,<span class="keyword">...</span>
0283             <span class="string">'Title'</span>,<span class="string">'RTD Calculation Bounds'</span>,<span class="string">'MinimizeFcn'</span>,@<a href="../../../../nucleus/functions/interface/minimizePanel.html" class="code" title="function minimizePanel(src,~)">minimizePanel</a>,<span class="keyword">...</span>
0284             <span class="string">'TitleColor'</span>,colors.BoxINV,<span class="string">'ForegroundColor'</span>,colors.BoxTitle);
0285         gui.panels.rtd.VBox = uix.VBox(<span class="string">'Parent'</span>,gui.panels.rtd.main,<span class="keyword">...</span>
0286             <span class="string">'Spacing'</span>,3,<span class="string">'Padding'</span>,3);
0287         <span class="comment">% RTD range</span>
0288         gui.panels.rtd.HBox1 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.rtd.VBox,<span class="keyword">...</span>
0289             <span class="string">'Spacing'</span>,3);
0290         gui.text_handles.rtd = uicontrol(<span class="string">'Parent'</span>,gui.panels.rtd.HBox1,<span class="keyword">...</span>
0291             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0292             <span class="string">'String'</span>,<span class="string">'RTD range       min | max'</span>);
0293         tstr = [<span class="string">'&lt;HTML&gt;Minimum relaxation time in RTDs used&lt;br&gt;'</span>,<span class="keyword">...</span>
0294             <span class="string">'for calculating statistics on E0 &amp; TLGM.'</span>];
0295         gui.edit_handles.rtd_min = uicontrol(<span class="string">'Parent'</span>,gui.panels.rtd.HBox1,<span class="keyword">...</span>
0296             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'rtd'</span>,<span class="keyword">...</span>
0297             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0298             <span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0299         tstr = [<span class="string">'&lt;HTML&gt;Maximum relaxation time in RTDs used&lt;br&gt;'</span>,<span class="keyword">...</span>
0300             <span class="string">'for calculating statistics on E0 &amp; TLGM.'</span>];
0301         gui.edit_handles.rtd_max = uicontrol(<span class="string">'Parent'</span>,gui.panels.rtd.HBox1,<span class="keyword">...</span>
0302             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'2'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'rtd'</span>,<span class="keyword">...</span>
0303             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0304             <span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0305         set(gui.panels.rtd.HBox1,<span class="string">'Widths'</span>,[cpanel_w -1 -1]);
0306         <span class="comment">% RESET button</span>
0307         gui.panels.rtd.HBox3 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.rtd.VBox,<span class="keyword">...</span>
0308             <span class="string">'Spacing'</span>,3);
0309         uix.Empty(<span class="string">'Parent'</span>,gui.panels.rtd.HBox3);
0310         uix.Empty(<span class="string">'Parent'</span>,gui.panels.rtd.HBox3);
0311         tstr = <span class="string">'RESET RTDs calculation bounds.'</span>;
0312         gui.push_handles.reset_rtd = uicontrol(<span class="string">'Parent'</span>,gui.panels.rtd.HBox3,<span class="keyword">...</span>
0313             <span class="string">'String'</span>,<span class="string">'RESET'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'rtd'</span>,<span class="keyword">...</span>
0314             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0315             <span class="string">'Callback'</span>,@<a href="#_sub10" class="code" title="subfunction uv_onPushReset(src,~)">uv_onPushReset</a>);
0316         set(gui.panels.rtd.HBox3,<span class="string">'Widths'</span>,[cpanel_w -1 -1]);
0317 
0318         <span class="comment">% --- Statistics panel ---</span>
0319         waitbar(4/steps,hwb,<span class="string">'loading GUI elements - statistics'</span>);
0320         gui.panels.info.main = uix.BoxPanel(<span class="string">'Parent'</span>,gui.left,<span class="keyword">...</span>
0321             <span class="string">'Title'</span>,<span class="string">'Uncertainty Statistics'</span>,<span class="string">'MinimizeFcn'</span>,@<a href="../../../../nucleus/functions/interface/minimizePanel.html" class="code" title="function minimizePanel(src,~)">minimizePanel</a>,<span class="keyword">...</span>
0322             <span class="string">'TitleColor'</span>,colors.BoxINV,<span class="string">'ForegroundColor'</span>,colors.BoxTitle);
0323         gui.panels.info.VBox = uix.VBox(<span class="string">'Parent'</span>,gui.panels.info.main,<span class="keyword">...</span>
0324             <span class="string">'Spacing'</span>,3,<span class="string">'Padding'</span>,3);
0325         <span class="comment">% mean TLGM</span>
0326         gui.panels.info.HBox1 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.info.VBox,<span class="keyword">...</span>
0327             <span class="string">'Spacing'</span>,3);
0328         gui.text_handles.TLGM = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox1,<span class="keyword">...</span>
0329             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0330             <span class="string">'String'</span>,<span class="string">'TLGM          mean | 2*std'</span>);
0331         tstr = <span class="string">'MEAN of all TLGM values.'</span>;
0332         gui.edit_handles.TLGM_mean = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox1,<span class="keyword">...</span>
0333             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="keyword">...</span>
0334             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0335             <span class="string">'BackgroundColor'</span>,colors.BoxPRC);
0336         tstr = <span class="string">'STD of all TLGM values.'</span>;
0337         gui.edit_handles.TLGM_std = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox1,<span class="keyword">...</span>
0338             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'2'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="keyword">...</span>
0339             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0340             <span class="string">'BackgroundColor'</span>,colors.BoxPRC);
0341         set(gui.panels.info.HBox1,<span class="string">'Widths'</span>,[cpanel_w -1 -1]);
0342         <span class="comment">% aad TLGM</span>
0343         gui.panels.info.HBox2 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.info.VBox,<span class="keyword">...</span>
0344             <span class="string">'Spacing'</span>,3);
0345         gui.text_handles.TLGM_aad = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox2,<span class="keyword">...</span>
0346             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0347             <span class="string">'String'</span>,<span class="string">'TLGM          2*aad(mean)'</span>);
0348         uix.Empty(<span class="string">'Parent'</span>,gui.panels.info.HBox2);
0349         tstr = <span class="string">'AAD (average absolute deviation from mean) of all TLGM values.'</span>;
0350         gui.edit_handles.TLGM_aad = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox2,<span class="keyword">...</span>
0351             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0352             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'2'</span>,<span class="string">'FontSize'</span>,myui.fontsize);
0353         set(gui.panels.info.HBox2,<span class="string">'Widths'</span>,[cpanel_w -1 -1]);
0354         <span class="comment">% median TLGM</span>
0355         gui.panels.info.HBox3 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.info.VBox,<span class="keyword">...</span>
0356             <span class="string">'Spacing'</span>,3);
0357         gui.text_handles.TLGM_med = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox3,<span class="keyword">...</span>
0358             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0359             <span class="string">'String'</span>,<span class="string">'TLGM median | 2*aad(med)'</span>);
0360         tstr = <span class="string">'MEDIAN of all TLGM values.'</span>;
0361         gui.edit_handles.TLGM_med = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox3,<span class="keyword">...</span>
0362             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="keyword">...</span>
0363             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0364             <span class="string">'BackgroundColor'</span>,colors.BoxCPS);
0365         tstr = <span class="string">'AAD (average absolute deviation from median) of all TLGM values.'</span>;
0366         gui.edit_handles.TLGM_aadmed = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox3,<span class="keyword">...</span>
0367             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'2'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="keyword">...</span>
0368             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0369             <span class="string">'BackgroundColor'</span>,colors.BoxCPS);
0370         set(gui.panels.info.HBox3,<span class="string">'Widths'</span>,[cpanel_w -1 -1]);
0371         <span class="comment">% mean E0</span>
0372         gui.panels.info.HBox4 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.info.VBox,<span class="keyword">...</span>
0373             <span class="string">'Spacing'</span>,3);
0374         gui.text_handles.E0 = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox4,<span class="keyword">...</span>
0375             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0376             <span class="string">'String'</span>,<span class="string">'E0              mean | 2*std'</span>);
0377         tstr = <span class="string">'MEAN of all E0 values.'</span>;
0378         gui.edit_handles.E0_mean = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox4,<span class="keyword">...</span>
0379             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="keyword">...</span>
0380             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0381             <span class="string">'BackgroundColor'</span>,colors.BoxPRC);
0382         tstr = <span class="string">'STD of all E0 values.'</span>;
0383         gui.edit_handles.E0_std = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox4,<span class="keyword">...</span>
0384             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'2'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="keyword">...</span>
0385             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0386             <span class="string">'BackgroundColor'</span>,colors.BoxPRC);
0387         set(gui.panels.info.HBox4,<span class="string">'Widths'</span>,[cpanel_w -1 -1]);
0388         <span class="comment">% aad E0</span>
0389         gui.panels.info.HBox5 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.info.VBox,<span class="keyword">...</span>
0390             <span class="string">'Spacing'</span>,3);
0391         gui.text_handles.E0_aad = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox5,<span class="keyword">...</span>
0392             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0393             <span class="string">'String'</span>,<span class="string">'E0              2*aad(mean)'</span>);
0394         uix.Empty(<span class="string">'Parent'</span>,gui.panels.info.HBox5);
0395         tstr = <span class="string">'AAD (average absolute deviation from mean) of all E0 values.'</span>;
0396         gui.edit_handles.E0_aad = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox5,<span class="keyword">...</span>
0397             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0398             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'2'</span>,<span class="string">'FontSize'</span>,myui.fontsize);
0399         set(gui.panels.info.HBox5,<span class="string">'Widths'</span>,[cpanel_w -1 -1]);
0400         <span class="comment">% median E0</span>
0401         gui.panels.info.HBox6 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.info.VBox,<span class="keyword">...</span>
0402             <span class="string">'Spacing'</span>,3);
0403         gui.text_handles.E0_med = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox6,<span class="keyword">...</span>
0404             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0405             <span class="string">'String'</span>,<span class="string">'E0   median | 2*aad(med)'</span>);
0406         tstr = <span class="string">'MEDIAN of all E0 values.'</span>;
0407         gui.edit_handles.E0_med = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox6,<span class="keyword">...</span>
0408             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="keyword">...</span>
0409             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0410             <span class="string">'BackgroundColor'</span>,colors.BoxCPS);
0411         tstr = <span class="string">'AAD (average absolute deviation from median) of all E0 values.'</span>;
0412         gui.edit_handles.E0_aadmed = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox6,<span class="keyword">...</span>
0413             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'2'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="keyword">...</span>
0414             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0415             <span class="string">'BackgroundColor'</span>,colors.BoxCPS);
0416         set(gui.panels.info.HBox6,<span class="string">'Widths'</span>,[cpanel_w -1 -1]);
0417 
0418         <span class="comment">% --- update MAIN GUI button ---</span>
0419         gui.panels.save.VBox1 = uix.VBox(<span class="string">'Parent'</span>,gui.left,<span class="keyword">...</span>
0420             <span class="string">'Spacing'</span>,3);
0421         tstr = <span class="string">'UPDATE uncertainty data in main NUCLEUSinv GUI.'</span>;
0422         gui.push_handles.update = uicontrol(<span class="string">'Parent'</span>,gui.panels.save.VBox1,<span class="keyword">...</span>
0423             <span class="string">'String'</span>,<span class="string">'UPDATE MAIN GUI'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'update'</span>,<span class="keyword">...</span>
0424             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0425             <span class="string">'Callback'</span>,@<a href="#_sub9" class="code" title="subfunction uv_onPushUpdate(src,~)">uv_onPushUpdate</a>);
0426         tstr = <span class="string">'APPLY RTD bounds to all signals with uncertainty data in main NUCLEUSinv GUI.'</span>;
0427         gui.push_handles.apply2all = uicontrol(<span class="string">'Parent'</span>,gui.panels.save.VBox1,<span class="keyword">...</span>
0428             <span class="string">'String'</span>,<span class="string">'APPLY RTD bounds 2 all'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'apply2all'</span>,<span class="keyword">...</span>
0429             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0430             <span class="string">'Callback'</span>,@<a href="#_sub9" class="code" title="subfunction uv_onPushUpdate(src,~)">uv_onPushUpdate</a>);
0431         tstr = <span class="string">'Export current graphics view to Figure.'</span>;
0432         gui.push_handles.view = uicontrol(<span class="string">'Parent'</span>,gui.panels.save.VBox1,<span class="keyword">...</span>
0433             <span class="string">'String'</span>,<span class="string">'VIEW2FIG'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'view'</span>,<span class="keyword">...</span>
0434             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0435             <span class="string">'Callback'</span>,@<a href="#_sub8" class="code" title="subfunction uv_onPushView(src,~)">uv_onPushView</a>);
0436 
0437         <span class="comment">% empty space at bottom of left side</span>
0438         uix.Empty(<span class="string">'Parent'</span>,gui.left);
0439         <span class="comment">% adjust the heights of all left-column-panels</span>
0440         heights = [22 22 22 22 28 -1; 22+6*24+8*3 22+3*24+5*3 22+2*24+4*4 22+6*24+8*3 28*3 -1];
0441         <span class="comment">% panel header is always 22 high</span>
0442         set(gui.left,<span class="string">'Heights'</span>,heights(2,:),<span class="keyword">...</span>
0443             <span class="string">'MinimumHeights'</span>,[22 22 22 22 28 0]);
0444 
0445         <span class="comment">% --- plot boxes ---</span>
0446         waitbar(5/steps,hwb,<span class="string">'loading GUI elements - graphics'</span>);
0447         gui.rightPanel = uix.TabPanel(<span class="string">'Parent'</span>,gui.right,<span class="keyword">...</span>
0448             <span class="string">'BackGroundColor'</span>,colors.panelBG);
0449         <span class="comment">% -- tab1</span>
0450         gui.righttop1 = uix.HBox(<span class="string">'Parent'</span>,gui.rightPanel,<span class="keyword">...</span>
0451             <span class="string">'BackGroundColor'</span>,colors.panelBG,<span class="string">'Spacing'</span>,5);
0452         gui.pbox11 = uicontainer(<span class="string">'Parent'</span>,gui.righttop1,<span class="keyword">...</span>
0453             <span class="string">'BackGroundColor'</span>,colors.panelBG);
0454         gui.pbox12 = uicontainer(<span class="string">'Parent'</span>,gui.righttop1,<span class="keyword">...</span>
0455             <span class="string">'BackGroundColor'</span>,colors.panelBG);
0456         set(gui.righttop1,<span class="string">'Widths'</span>,[-1 -1 ]);
0457         gui.rightbot = uix.HBox(<span class="string">'Parent'</span>,gui.right,<span class="keyword">...</span>
0458             <span class="string">'BackGroundColor'</span>,colors.panelBG,<span class="string">'Spacing'</span>,5);
0459         gui.pbox2 = uicontainer(<span class="string">'Parent'</span>,gui.rightbot,<span class="keyword">...</span>
0460             <span class="string">'BackGroundColor'</span>,colors.panelBG);
0461 
0462         <span class="comment">% -- tab2</span>
0463         gui.righttop2 = uix.HBox(<span class="string">'Parent'</span>,gui.rightPanel,<span class="keyword">...</span>
0464             <span class="string">'BackGroundColor'</span>,colors.panelBG,<span class="string">'Spacing'</span>,5);
0465         gui.pbox21 = uicontainer(<span class="string">'Parent'</span>,gui.righttop2,<span class="keyword">...</span>
0466             <span class="string">'BackGroundColor'</span>,colors.panelBG);
0467         gui.pbox22 = uicontainer(<span class="string">'Parent'</span>,gui.righttop2,<span class="keyword">...</span>
0468             <span class="string">'BackGroundColor'</span>,colors.panelBG);
0469         set(gui.righttop2,<span class="string">'Widths'</span>,[-1 -1 ]);
0470 
0471         gui.rightPanel.TabTitles = {<span class="string">'STATISTICS'</span>,<span class="string">'KDEs'</span>};
0472         gui.rightPanel.TabWidth = 75;
0473         gui.rightPanel.TabEnables = {<span class="string">'on'</span>,<span class="string">'on'</span>};
0474 
0475         <span class="comment">% -- plot axes --</span>
0476         gui.axes11 = axes(<span class="string">'Parent'</span>,gui.pbox12,<span class="string">'Box'</span>,<span class="string">'on'</span>);
0477         gui.axes12 = axes(<span class="string">'Parent'</span>,gui.pbox11,<span class="string">'Box'</span>,<span class="string">'on'</span>);
0478         gui.axes2 = axes(<span class="string">'Parent'</span>,gui.pbox2,<span class="string">'Box'</span>,<span class="string">'on'</span>);
0479         gui.axes21 = axes(<span class="string">'Parent'</span>,gui.pbox21,<span class="string">'Box'</span>,<span class="string">'on'</span>);
0480         gui.axes22 = axes(<span class="string">'Parent'</span>,gui.pbox22,<span class="string">'Box'</span>,<span class="string">'on'</span>);
0481 
0482         <span class="comment">% the chi2 vs. xn plot has a context menu</span>
0483         gui.cm_handles.axes_chi2 = uicontextmenu(fig_uncert);
0484         gui.cm_handles.axes_color = uimenu(gui.cm_handles.axes_chi2,<span class="keyword">...</span>
0485             <span class="string">'Label'</span>,<span class="string">'color by'</span>);
0486         gui.cm_handles.axes_color_none = uimenu(gui.cm_handles.axes_color,<span class="keyword">...</span>
0487             <span class="string">'Label'</span>,<span class="string">'none'</span>,<span class="string">'Tag'</span>,<span class="string">'none'</span>,<span class="string">'Checked'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0488             <span class="string">'Callback'</span>,@<a href="#_sub3" class="code" title="subfunction uv_onContextPlotsColor(src,~)">uv_onContextPlotsColor</a>);
0489         gui.cm_handles.axes_color_chi2 = uimenu(gui.cm_handles.axes_color,<span class="keyword">...</span>
0490             <span class="string">'Label'</span>,<span class="string">'X'</span>,<span class="string">'Tag'</span>,<span class="string">'chi2'</span>,<span class="string">'Callback'</span>,@<a href="#_sub3" class="code" title="subfunction uv_onContextPlotsColor(src,~)">uv_onContextPlotsColor</a>);
0491         gui.cm_handles.axes_color_mnorm = uimenu(gui.cm_handles.axes_color,<span class="keyword">...</span>
0492             <span class="string">'Label'</span>,[<span class="string">'|Lm|'</span>,char(hex2dec(<span class="string">'2082'</span>))],<span class="string">'Tag'</span>,<span class="string">'xn'</span>,<span class="string">'Callback'</span>,@<a href="#_sub3" class="code" title="subfunction uv_onContextPlotsColor(src,~)">uv_onContextPlotsColor</a>);
0493         set(gui.axes12,<span class="string">'UIContextMenu'</span>,gui.cm_handles.axes_chi2);
0494 
0495         <span class="comment">% the RTD plot has a context menu</span>
0496         gui.cm_handles.axes_rtd = uicontextmenu(fig_uncert);
0497         gui.cm_handles.axes_rtd_lines = uimenu(gui.cm_handles.axes_rtd,<span class="keyword">...</span>
0498             <span class="string">'Label'</span>,<span class="string">'lines'</span>,<span class="string">'Tag'</span>,<span class="string">'lines'</span>,<span class="string">'Checked'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0499             <span class="string">'Callback'</span>,@<a href="#_sub4" class="code" title="subfunction uv_onContextPlotsRTD(src,~)">uv_onContextPlotsRTD</a>);
0500         gui.cm_handles.axes_rtd_patch = uimenu(gui.cm_handles.axes_rtd,<span class="keyword">...</span>
0501             <span class="string">'Label'</span>,<span class="string">'patch'</span>);
0502         gui.cm_handles.axes_rtd_patch_mean = uimenu(gui.cm_handles.axes_rtd_patch,<span class="keyword">...</span>
0503             <span class="string">'Label'</span>,<span class="string">'mean / std'</span>,<span class="string">'Tag'</span>,<span class="string">'patchmean'</span>,<span class="keyword">...</span>
0504             <span class="string">'Callback'</span>,@<a href="#_sub4" class="code" title="subfunction uv_onContextPlotsRTD(src,~)">uv_onContextPlotsRTD</a>);
0505         gui.cm_handles.axes_rtd_patch_median = uimenu(gui.cm_handles.axes_rtd_patch,<span class="keyword">...</span>
0506             <span class="string">'Label'</span>,<span class="string">'median / aad'</span>,<span class="string">'Tag'</span>,<span class="string">'patchmedian'</span>,<span class="keyword">...</span>
0507             <span class="string">'Callback'</span>,@<a href="#_sub4" class="code" title="subfunction uv_onContextPlotsRTD(src,~)">uv_onContextPlotsRTD</a>);
0508         set(gui.axes2,<span class="string">'UIContextMenu'</span>,gui.cm_handles.axes_rtd);
0509 
0510         <span class="comment">% --- store main GUI settings ---</span>
0511         gui.myui = nucleus.gui.myui;
0512         gui.myui.heights = heights;
0513         gui.figh_nucleus = figh_nucleus;
0514 
0515         <span class="comment">% --- save gui data to GUI ---</span>
0516         setappdata(fig_uncert,<span class="string">'gui'</span>,gui);
0517         <a href="../../../../nucleus/functions/interface/fixVerticalTextAlignment.html" class="code" title="function fixVerticalTextAlignment(fig)">fixVerticalTextAlignment</a>(fig_uncert);
0518         <a href="../../../../nucleus/functions/interface/changeColorTheme.html" class="code" title="function changeColorTheme(fig_tag,th)">changeColorTheme</a>(<span class="string">'UNCERTVIEW'</span>,myui.colors.theme);
0519 
0520         <span class="comment">% make GUI visible</span>
0521         delete(hwb);
0522         set(gui.main,<span class="string">'Visible'</span>,<span class="string">'on'</span>);
0523 
0524         <span class="comment">% initialize color style</span>
0525         uv.colorstyle = <span class="string">'none'</span>;
0526         <span class="comment">% initialize RTD plot style</span>
0527         uv.rtd_plotstyle = <span class="string">'lines'</span>;
0528         <span class="comment">% save the initial id</span>
0529         uv.id0 = nucleus_data.results.invstd.uncert.params.id;
0530     <span class="keyword">else</span>
0531         data = getappdata(fig_uncert,<span class="string">'data'</span>);
0532         uv = data.uv;
0533     <span class="keyword">end</span>
0534     
0535     <span class="comment">% if the figure is already open load the GUI data</span>
0536     gui = getappdata(fig_uncert,<span class="string">'gui'</span>);
0537     <span class="comment">% update new NUCLEUSinv data</span>
0538     setappdata(fig_uncert,<span class="string">'data'</span>,nucleus_data);
0539     data = getappdata(fig_uncert,<span class="string">'data'</span>);
0540     <span class="comment">% clear axes</span>
0541     <a href="../../../../nucleus/functions/interface/clearAllAxes.html" class="code" title="function clearAllAxes(figh)">clearAllAxes</a>(fig_uncert);
0542 
0543     <span class="comment">% round all chi2 and xn values to 6 digits</span>
0544     chi2_all = data.results.invstd.uncert.chi2_all;
0545     chi2_all = round(1e6.*chi2_all)./1e6;
0546     data.results.invstd.uncert.chi2_all = chi2_all;
0547     mnorm_all = data.results.invstd.uncert.mnorm_all;
0548     mnorm_all = round(1e6.*mnorm_all)./1e6;
0549     data.results.invstd.uncert.mnorm_all = mnorm_all;
0550 
0551     <span class="comment">% create logical mask</span>
0552     uv.touse = ones(nucleus_data.uncert.N,1);
0553     <span class="comment">% --- fill the edit fields ---</span>
0554     invstd = data.results.invstd;
0555     uncert = invstd.uncert;
0556     <span class="comment">% 1.) control</span>
0557     uv.uncertMethod = uncert.params.uncert.Method;
0558     uv.uncertN = uncert.params.uncert.N;
0559     set(gui.edit_handles.uncertN,<span class="string">'String'</span>,num2str(uv.uncertN));
0560     uv.uncertThresh = uncert.params.uncert.Thresh;
0561     set(gui.edit_handles.uncertThresh,<span class="string">'String'</span>,num2str(uv.uncertThresh));
0562     uv.uncertMax = uncert.params.uncert.Max;
0563     set(gui.edit_handles.uncertMax,<span class="string">'String'</span>,num2str(uv.uncertMax));
0564     uv.chi2_range_calc  = [min(uncert.chi2_all) max(uncert.chi2_all)];
0565     uv.mnorm_range_calc = [min(uncert.mnorm_all) max(uncert.mnorm_all)];
0566     <span class="comment">% set popup menu</span>
0567     <span class="keyword">switch</span> invstd.invtype
0568         <span class="keyword">case</span> {<span class="string">'LU'</span>,<span class="string">'NNLS'</span>}
0569             set(gui.popup_handles.uncertMethod,<span class="keyword">...</span>
0570                 <span class="string">'String'</span>,{<span class="string">'RMS - unbounded'</span>,<span class="string">'RMS - bounded'</span>})
0571             <span class="keyword">switch</span> uncert.params.uncert.Method
0572                 <span class="keyword">case</span> <span class="string">'RMS_free'</span>
0573                     set(gui.popup_handles.uncertMethod,<span class="string">'Value'</span>,1);
0574                 <span class="keyword">case</span> <span class="string">'RMS_bound'</span>
0575                     set(gui.popup_handles.uncertMethod,<span class="string">'Value'</span>,2);
0576             <span class="keyword">end</span>
0577         <span class="keyword">case</span> <span class="string">'MUMO'</span>
0578             set(gui.popup_handles.uncertMethod,<span class="keyword">...</span>
0579                 <span class="string">'String'</span>,{<span class="string">'RMS - unbounded'</span>,<span class="string">'RMS - bounded'</span>,<span class="string">'Threshold'</span>,<span class="string">'Conf. Interval'</span>})
0580             <span class="keyword">switch</span> uncert.params.uncert.Method
0581                 <span class="keyword">case</span> <span class="string">'RMS_free'</span>
0582                     set(gui.popup_handles.uncertMethod,<span class="string">'Value'</span>,1);
0583                 <span class="keyword">case</span> <span class="string">'RMS_bound'</span>
0584                     set(gui.popup_handles.uncertMethod,<span class="string">'Value'</span>,2);
0585                 <span class="keyword">case</span> <span class="string">'thresh'</span>
0586                     set(gui.popup_handles.uncertMethod,<span class="string">'Value'</span>,3);
0587                 <span class="keyword">case</span> <span class="string">'ci'</span>
0588                     set(gui.popup_handles.uncertMethod,<span class="string">'Value'</span>,4);
0589             <span class="keyword">end</span>
0590     <span class="keyword">end</span>
0591     set(gui.edit_handles.uncertN,<span class="string">'String'</span>,num2str(uncert.params.uncert.N));
0592     <span class="comment">% 2.) process</span>
0593     chi2_range  = uv.chi2_range_calc;
0594     mnorm_range = uv.mnorm_range_calc;
0595     set(gui.edit_handles.chi2_min,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,chi2_range(1,1)));
0596     set(gui.edit_handles.chi2_max,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,chi2_range(1,2)));
0597     set(gui.edit_handles.mnorm_min,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,mnorm_range(1,1)));
0598     set(gui.edit_handles.mnorm_max,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,mnorm_range(1,2)));
0599     <span class="comment">% 3.) RTD range</span>
0600     rtd_range = uncert.statistics.RTD_bounds;
0601     set(gui.edit_handles.rtd_min,<span class="string">'String'</span>,num2str(rtd_range(1,1)));
0602     set(gui.edit_handles.rtd_max,<span class="string">'String'</span>,num2str(rtd_range(1,2)));
0603     uv.chi2_range = chi2_range;
0604     uv.mnorm_range = mnorm_range;
0605     uv.rtd_range = rtd_range;
0606 
0607     <span class="comment">% update data</span>
0608     data.uv = uv;
0609     setappdata(fig_uncert,<span class="string">'data'</span>,data);
0610     <a href="#_sub6" class="code" title="subfunction uv_onPopupMethod(src,~)">uv_onPopupMethod</a>(gui.popup_handles.uncertMethod);
0611 
0612     <span class="comment">% plot all uncertainty data</span>
0613     <a href="#_sub11" class="code" title="subfunction uv_updateInformation(figh)">uv_updateInformation</a>(fig_uncert);
0614     <a href="../../../../nucleus/functions/interface/beautifyAxes.html" class="code" title="function beautifyAxes(figh)">beautifyAxes</a>(fig_uncert);
0615 <span class="keyword">end</span>
0616 
0617 <span class="keyword">end</span>
0618 
0619 <span class="comment">%% subfunction to update the edit fields</span>
0620 <a name="_sub1" href="#_subfunctions" class="code">function uv_onEditValue(src,~)</a>
0621 figh = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
0622 gui = getappdata(figh,<span class="string">'gui'</span>);
0623 data = getappdata(figh,<span class="string">'data'</span>);
0624 uv = data.uv;
0625 
0626 <span class="comment">% get the edit field value</span>
0627 val = str2double(get(src,<span class="string">'String'</span>));
0628 
0629 <span class="keyword">switch</span> get(src,<span class="string">'Tag'</span>)
0630     <span class="keyword">case</span> <span class="string">'uncertN'</span>
0631         <span class="keyword">if</span> val &lt; 10
0632             uncertN = 10;
0633         <span class="keyword">else</span>
0634             uncertN = round(val);
0635         <span class="keyword">end</span>
0636         set(src,<span class="string">'String'</span>,num2str(uncertN));
0637         uv.uncertN = uncertN;
0638         data.uv = uv;
0639     <span class="keyword">case</span> <span class="string">'uncertThresh'</span>
0640     <span class="keyword">case</span> <span class="string">'uncertMax'</span>
0641     <span class="keyword">case</span> <span class="string">'control'</span>
0642         <span class="comment">% set the value with the desired layout</span>
0643         set(src,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,val));
0644         chi2_range_calc(1,1) = str2double(get(gui.edit_handles.uncertchi2_min,<span class="string">'String'</span>));
0645         chi2_range_calc(1,2) = str2double(get(gui.edit_handles.uncertchi2_max,<span class="string">'String'</span>));
0646         mnorm_range_calc(1,1) = str2double(get(gui.edit_handles.uncertmnorm_min,<span class="string">'String'</span>));
0647         mnorm_range_calc(1,2) = str2double(get(gui.edit_handles.uncertmnorm_max,<span class="string">'String'</span>));
0648         <span class="comment">% update data</span>
0649         uv.chi2_range_calc = chi2_range_calc;
0650         uv.mnorm_range_calc = mnorm_range_calc;
0651         data.uv = uv;
0652     <span class="keyword">case</span> <span class="string">'process'</span>
0653         <span class="comment">% set the value with the desired layout</span>
0654         set(src,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,val));
0655         <span class="comment">% get all range values</span>
0656         chi2_range(1,1) = str2double(get(gui.edit_handles.chi2_min,<span class="string">'String'</span>));
0657         chi2_range(1,2) = str2double(get(gui.edit_handles.chi2_max,<span class="string">'String'</span>));
0658         mnorm_range(1,1) = str2double(get(gui.edit_handles.mnorm_min,<span class="string">'String'</span>));
0659         mnorm_range(1,2) = str2double(get(gui.edit_handles.mnorm_max,<span class="string">'String'</span>));
0660         <span class="comment">% fix wrong user input</span>
0661         <span class="keyword">if</span> chi2_range(2) &lt;= chi2_range(1)
0662             warndlg({<span class="string">'function: UNCERTVIEW'</span>,<span class="keyword">...</span>
0663                 <span class="string">'Lower bound is larger than upper bound!'</span>},<span class="keyword">...</span>
0664                 <span class="string">'Resetting.'</span>);
0665             chi2_range(1) = min(data.results.invstd.uncert.chi2_all);
0666             chi2_range(2) = max(data.results.invstd.uncert.chi2_all);
0667             set(gui.edit_handles.chi2_min,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,chi2_range(1)));
0668             set(gui.edit_handles.chi2_max,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,chi2_range(2)));
0669         <span class="keyword">end</span>
0670         <span class="keyword">if</span> mnorm_range(2) &lt;= mnorm_range(1)
0671             warndlg({<span class="string">'function: UNCERTVIEW'</span>,<span class="keyword">...</span>
0672                 <span class="string">'Lower bound is larger than upper bound!'</span>},<span class="keyword">...</span>
0673                 <span class="string">'Resetting.'</span>);
0674             mnorm_range(1) = min(data.results.invstd.uncert.mnorm_all);
0675             mnorm_range(2) = max(data.results.invstd.uncert.mnorm_all);
0676             set(gui.edit_handles.mnorm_min,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,mnorm_range(1)));
0677             set(gui.edit_handles.mnorm_max,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,mnorm_range(2)));
0678         <span class="keyword">end</span>
0679         <span class="comment">% update data</span>
0680         uv.chi2_range = chi2_range;
0681         uv.mnorm_range = mnorm_range;
0682         data.uv = uv;
0683         <span class="comment">% update logical mask for plotting</span>
0684         data = <a href="#_sub5" class="code" title="subfunction data = uv_updateMASK(data)">uv_updateMASK</a>(data);
0685     <span class="keyword">case</span> <span class="string">'rtd'</span>
0686         <span class="comment">% set the value with the desired layout</span>
0687         set(src,<span class="string">'String'</span>,num2str(val));
0688         <span class="comment">% get all range values</span>
0689         rtd_range(1,1) = str2double(get(gui.edit_handles.rtd_min,<span class="string">'String'</span>));
0690         rtd_range(1,2) = str2double(get(gui.edit_handles.rtd_max,<span class="string">'String'</span>));
0691         <span class="comment">% update data</span>
0692         uv.rtd_range = rtd_range;
0693         data.uv = uv;
0694 <span class="keyword">end</span>
0695 
0696 <span class="comment">% in case of error reactivate the run button</span>
0697 set(gui.push_handles.run,<span class="string">'String'</span>,<span class="string">'RUN UNCERT'</span>,<span class="keyword">...</span>
0698     <span class="string">'BackgroundColor'</span>,<span class="string">'g'</span>,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="string">'Callback'</span>,@<a href="#_sub7" class="code" title="subfunction uv_onPushRun(src,~)">uv_onPushRun</a>);
0699 setappdata(figh,<span class="string">'gui'</span>,gui);
0700 <span class="comment">% update GUI data</span>
0701 setappdata(figh,<span class="string">'data'</span>,data);
0702 <span class="comment">% update information</span>
0703 <a href="#_sub11" class="code" title="subfunction uv_updateInformation(figh)">uv_updateInformation</a>(figh);
0704 <span class="keyword">end</span>
0705 
0706 <span class="comment">%% subfunction to copy the chi2 and xn range to the control panel</span>
0707 <a name="_sub2" href="#_subfunctions" class="code">function uv_onPushSend(src,~)</a>
0708 figh = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
0709 gui = getappdata(figh,<span class="string">'gui'</span>);
0710 data = getappdata(figh,<span class="string">'data'</span>);
0711 uv = data.uv;
0712 
0713 <span class="comment">% get all data</span>
0714 chi2_range(1,1) = str2double(get(gui.edit_handles.chi2_min,<span class="string">'String'</span>));
0715 chi2_range(1,2) = str2double(get(gui.edit_handles.chi2_max,<span class="string">'String'</span>));
0716 mnorm_range(1,1) = str2double(get(gui.edit_handles.mnorm_min,<span class="string">'String'</span>));
0717 mnorm_range(1,2) = str2double(get(gui.edit_handles.mnorm_max,<span class="string">'String'</span>));
0718 
0719 <span class="comment">% copy data to calc</span>
0720 uv.chi2_range_calc = chi2_range;
0721 uv.mnorm_range_calc = mnorm_range;
0722 data.uv = uv;
0723 
0724 <span class="comment">% write values to edit field</span>
0725 set(gui.edit_handles.uncertchi2_min,<span class="keyword">...</span>
0726     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range_calc(1)));
0727 set(gui.edit_handles.uncertchi2_max,<span class="keyword">...</span>
0728     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range_calc(2)));
0729 set(gui.edit_handles.uncertmnorm_min,<span class="keyword">...</span>
0730     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range_calc(1)));
0731 set(gui.edit_handles.uncertmnorm_max,<span class="keyword">...</span>
0732     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range_calc(2)));
0733 
0734 <span class="comment">% update GUI data</span>
0735 setappdata(figh,<span class="string">'data'</span>,data);
0736 <span class="keyword">end</span>
0737 
0738 <span class="comment">%% subfunction to control the line color</span>
0739 <a name="_sub3" href="#_subfunctions" class="code">function uv_onContextPlotsColor(src,~)</a>
0740 figh = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
0741 gui = getappdata(figh,<span class="string">'gui'</span>);
0742 data = getappdata(figh,<span class="string">'data'</span>);
0743 uv = data.uv;
0744 
0745 <span class="comment">% switch through different plot options</span>
0746 <span class="keyword">switch</span> get(src,<span class="string">'Tag'</span>)
0747     <span class="keyword">case</span> <span class="string">'none'</span>
0748         set(gui.cm_handles.axes_color_none,<span class="string">'Checked'</span>,<span class="string">'on'</span>);
0749         set(gui.cm_handles.axes_color_chi2,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0750         set(gui.cm_handles.axes_color_mnorm,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0751     <span class="keyword">case</span> <span class="string">'chi2'</span>
0752         set(gui.cm_handles.axes_color_none,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0753         set(gui.cm_handles.axes_color_chi2,<span class="string">'Checked'</span>,<span class="string">'on'</span>);
0754         set(gui.cm_handles.axes_color_mnorm,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0755     <span class="keyword">case</span> <span class="string">'xn'</span>
0756         set(gui.cm_handles.axes_color_none,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0757         set(gui.cm_handles.axes_color_chi2,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0758         set(gui.cm_handles.axes_color_mnorm,<span class="string">'Checked'</span>,<span class="string">'on'</span>);
0759 <span class="keyword">end</span>
0760 uv.colorstyle = get(src,<span class="string">'Tag'</span>);
0761 
0762 <span class="comment">% update GUI data</span>
0763 data.uv = uv;
0764 setappdata(figh,<span class="string">'data'</span>,data);
0765 <span class="comment">% update information and plots</span>
0766 <a href="#_sub11" class="code" title="subfunction uv_updateInformation(figh)">uv_updateInformation</a>(figh);
0767 <span class="keyword">end</span>
0768 
0769 <span class="comment">%% subfunction to control RTD axes context menu</span>
0770 <a name="_sub4" href="#_subfunctions" class="code">function uv_onContextPlotsRTD(src,~)</a>
0771 figh = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
0772 gui = getappdata(figh,<span class="string">'gui'</span>);
0773 data = getappdata(figh,<span class="string">'data'</span>);
0774 uv = data.uv;
0775 
0776 <span class="comment">% switch through different plot options</span>
0777 <span class="keyword">switch</span> get(src,<span class="string">'Tag'</span>)
0778     <span class="keyword">case</span> <span class="string">'lines'</span>
0779         set(gui.cm_handles.axes_rtd_lines,<span class="string">'Checked'</span>,<span class="string">'on'</span>);
0780         set(gui.cm_handles.axes_rtd_patch_mean,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0781         set(gui.cm_handles.axes_rtd_patch_median,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0782     <span class="keyword">case</span> <span class="string">'patchmean'</span>
0783         set(gui.cm_handles.axes_rtd_lines,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0784         set(gui.cm_handles.axes_rtd_patch_mean,<span class="string">'Checked'</span>,<span class="string">'on'</span>);
0785         set(gui.cm_handles.axes_rtd_patch_median,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0786     <span class="keyword">case</span> <span class="string">'patchmedian'</span>
0787         set(gui.cm_handles.axes_rtd_lines,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0788         set(gui.cm_handles.axes_rtd_patch_mean,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0789         set(gui.cm_handles.axes_rtd_patch_median,<span class="string">'Checked'</span>,<span class="string">'on'</span>);
0790 <span class="keyword">end</span>
0791 uv.rtd_plotstyle = get(src,<span class="string">'Tag'</span>);
0792 
0793 <span class="comment">% update GUI data</span>
0794 data.uv = uv;
0795 setappdata(figh,<span class="string">'data'</span>,data);
0796 <span class="comment">% update information and plots</span>
0797 <a href="#_sub11" class="code" title="subfunction uv_updateInformation(figh)">uv_updateInformation</a>(figh);
0798 <span class="keyword">end</span>
0799 
0800 <span class="comment">%% subfunction to update the logical mask</span>
0801 <a name="_sub5" href="#_subfunctions" class="code">function data = uv_updateMASK(data)</a>
0802 uncert = data.results.invstd.uncert;
0803 uv = data.uv;
0804 
0805 mask1 = uncert.chi2_all &gt;= uv.chi2_range(1) &amp; uncert.chi2_all &lt;= uv.chi2_range(2);
0806 mask2 = uncert.mnorm_all &gt;= uv.mnorm_range(1) &amp; uncert.mnorm_all &lt;= uv.mnorm_range(2);
0807 uv.touse = mask1 &amp; mask2;
0808 
0809 data.uv = uv;
0810 <span class="keyword">end</span>
0811 
0812 <span class="comment">%% subfunction to update control panel based on uncertainty method</span>
0813 <a name="_sub6" href="#_subfunctions" class="code">function uv_onPopupMethod(src,~)</a>
0814 figh = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
0815 gui = getappdata(figh,<span class="string">'gui'</span>);
0816 data = getappdata(figh,<span class="string">'data'</span>);
0817 uv = data.uv;
0818 invstd = data.results.invstd;
0819 
0820 val = get(gui.popup_handles.uncertMethod,<span class="string">'Value'</span>);
0821 
0822 <span class="keyword">switch</span> invstd.invtype
0823     <span class="keyword">case</span> {<span class="string">'LU'</span>,<span class="string">'NNLS'</span>}
0824         <span class="keyword">switch</span> val
0825             <span class="keyword">case</span> 1 <span class="comment">% RMS_free</span>
0826                 uv.uncertMethod = <span class="string">'RMS_free'</span>;
0827                 set(gui.edit_handles.uncertchi2_min,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0828                 set(gui.edit_handles.uncertchi2_max,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0829                 set(gui.edit_handles.uncertmnorm_min,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0830                 set(gui.edit_handles.uncertmnorm_max,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0831                 set(gui.edit_handles.uncertThresh,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0832                 set(gui.edit_handles.uncertMax,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0833             <span class="keyword">case</span> 2 <span class="comment">% RMS_bound</span>
0834                 uv.uncertMethod = <span class="string">'RMS_bound'</span>;
0835                 set(gui.edit_handles.uncertchi2_min,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0836                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range_calc(1)));
0837                 set(gui.edit_handles.uncertchi2_max,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0838                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range_calc(2)));
0839                 set(gui.edit_handles.uncertmnorm_min,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0840                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range_calc(1)));
0841                 set(gui.edit_handles.uncertmnorm_max,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0842                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range_calc(2)));
0843                 set(gui.edit_handles.uncertThresh,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0844                 set(gui.edit_handles.uncertMax,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0845                     <span class="string">'String'</span>,num2str(uv.uncertMax));
0846         <span class="keyword">end</span>
0847     <span class="keyword">case</span> <span class="string">'MUMO'</span>
0848         <span class="keyword">switch</span> val
0849             <span class="keyword">case</span> 1 <span class="comment">% RMS_free</span>
0850                 uv.uncertMethod = <span class="string">'RMS_free'</span>;
0851                 set(gui.edit_handles.uncertchi2_min,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0852                 set(gui.edit_handles.uncertchi2_max,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0853                 set(gui.edit_handles.uncertmnorm_min,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0854                 set(gui.edit_handles.uncertmnorm_max,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0855                 set(gui.edit_handles.uncertThresh,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0856                 set(gui.edit_handles.uncertMax,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0857             <span class="keyword">case</span> 2 <span class="comment">% RMS_bound</span>
0858                 uv.uncertMethod = <span class="string">'RMS_bound'</span>;
0859                 set(gui.edit_handles.uncertchi2_min,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0860                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range_calc(1)));
0861                 set(gui.edit_handles.uncertchi2_max,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0862                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range_calc(2)));
0863                 set(gui.edit_handles.uncertmnorm_min,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0864                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range_calc(1)));
0865                 set(gui.edit_handles.uncertmnorm_max,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0866                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range_calc(2)));
0867                 set(gui.edit_handles.uncertThresh,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0868                 set(gui.edit_handles.uncertMax,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0869                     <span class="string">'String'</span>,num2str(uv.uncertMax));
0870             <span class="keyword">case</span> 3 <span class="comment">% threshold</span>
0871                 uv.uncertMethod = <span class="string">'thresh'</span>;
0872                 uv.chi2_range_calc = [0 10];
0873                 uv.mnorm_range_calc = [0 10];
0874                 set(gui.edit_handles.uncertchi2_min,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0875                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range_calc(1)));
0876                 set(gui.edit_handles.uncertchi2_max,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0877                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range_calc(2)));
0878                 set(gui.edit_handles.uncertmnorm_min,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0879                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range_calc(1)));
0880                 set(gui.edit_handles.uncertmnorm_max,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0881                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range_calc(2)));
0882                 set(gui.edit_handles.uncertThresh,<span class="string">'Enable'</span>,<span class="string">'on'</span>);
0883                 set(gui.edit_handles.uncertMax,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0884                     <span class="string">'String'</span>,num2str(uv.uncertMax));
0885             <span class="keyword">case</span> 4 <span class="comment">% ci - confidence intrval</span>
0886                 uv.uncertMethod = <span class="string">'ci'</span>;
0887                 uv.chi2_range_calc = [0 10];
0888                 uv.mnorm_range_calc = [0 10];
0889                 set(gui.edit_handles.uncertchi2_min,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0890                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range_calc(1)));
0891                 set(gui.edit_handles.uncertchi2_max,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0892                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range_calc(2)));
0893                 set(gui.edit_handles.uncertmnorm_min,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0894                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range_calc(1)));
0895                 set(gui.edit_handles.uncertmnorm_max,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0896                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range_calc(2)));
0897                 set(gui.edit_handles.uncertThresh,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0898                 set(gui.edit_handles.uncertMax,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0899                     <span class="string">'String'</span>,num2str(uv.uncertMax));
0900         <span class="keyword">end</span>
0901 <span class="keyword">end</span>
0902 
0903 <span class="comment">% update GUI data</span>
0904 data.uv = uv;
0905 setappdata(figh,<span class="string">'data'</span>,data);
0906 <span class="keyword">end</span>
0907 
0908 <span class="comment">%% subfunction to start a new uncertainty calculation</span>
0909 <a name="_sub7" href="#_subfunctions" class="code">function uv_onPushRun(src,~)</a>
0910 figh = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
0911 gui = getappdata(figh,<span class="string">'gui'</span>);
0912 data = getappdata(figh,<span class="string">'data'</span>);
0913 uv = data.uv;
0914 invstd = data.results.invstd;
0915 uncert = invstd.uncert;
0916 
0917 <span class="comment">% disable the CALC: button to indicate a running calculation</span>
0918 set(gui.push_handles.run,<span class="string">'String'</span>,<span class="string">'RUNNING ...'</span>,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0919 pause(0.01);
0920 
0921 <span class="comment">% original fit parameter</span>
0922 iparam = invstd.invparams;
0923 <span class="comment">% original uncertainty parameter</span>
0924 uparam = uncert.params;
0925 <span class="comment">% new uncertainty parameter from GUI</span>
0926 uparam.uncert.Method = uv.uncertMethod;
0927 uparam.uncert.Thresh = uv.uncertThresh;
0928 uparam.uncert.chi2_range = uv.chi2_range_calc;
0929 uparam.uncert.mnorm_range = uv.mnorm_range_calc;
0930 uparam.uncert.N = uv.uncertN;
0931 uparam.uncert.Max = uv.uncertMax;
0932 invstd = <a href="../../../../nucleus/functions/inversion/estimateUncertainty.html" class="code" title="function [invstd,uncert] = estimateUncertainty(invtype,invstd,iparam,parameter)">estimateUncertainty</a>(invstd.invtype,invstd,iparam,uparam);
0933 
0934 <span class="comment">% enable the CALC. button</span>
0935 set(gui.push_handles.run,<span class="string">'String'</span>,<span class="string">'RUN UNCERT'</span>,<span class="keyword">...</span>
0936     <span class="string">'BackgroundColor'</span>,<span class="string">'g'</span>,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="string">'Callback'</span>,@<a href="#_sub7" class="code" title="subfunction uv_onPushRun(src,~)">uv_onPushRun</a>);
0937 setappdata(figh,<span class="string">'gui'</span>,gui);
0938 
0939 <span class="comment">% save updated inversion results</span>
0940 invstd.uncert.params = uparam;
0941 data.results.invstd = invstd;
0942 
0943 <span class="comment">% update GUI data</span>
0944 <span class="comment">% round all chi2 and xn values to 6 digits</span>
0945 chi2_all = data.results.invstd.uncert.chi2_all;
0946 chi2_all = round(1e6.*chi2_all)./1e6;
0947 data.results.invstd.uncert.chi2_all = chi2_all;
0948 mnorm_all = data.results.invstd.uncert.mnorm_all;
0949 mnorm_all = round(1e6.*mnorm_all)./1e6;
0950 data.results.invstd.uncert.mnorm_all = mnorm_all;
0951 
0952 <span class="comment">% create logical mask</span>
0953 uv.touse = ones(uv.uncertN,1);
0954 
0955 <span class="comment">% 1.) control</span>
0956 uv.chi2_range_calc = [min(chi2_all) max(chi2_all)];
0957 uv.mnorm_range_calc = [min(mnorm_all) max(mnorm_all)];
0958 
0959 <span class="comment">% 2.) process</span>
0960 uv.chi2_range = uv.chi2_range_calc;
0961 uv.mnorm_range = uv.mnorm_range_calc;
0962 set(gui.edit_handles.chi2_min,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range(1,1)));
0963 set(gui.edit_handles.chi2_max,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range(1,2)));
0964 set(gui.edit_handles.mnorm_min,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range(1,1)));
0965 set(gui.edit_handles.mnorm_max,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range(1,2)));
0966 
0967 <span class="comment">% update data</span>
0968 data.uv = uv;
0969 setappdata(figh,<span class="string">'data'</span>,data);
0970 
0971 <span class="comment">% plot all uncertainty data</span>
0972 <a href="#_sub11" class="code" title="subfunction uv_updateInformation(figh)">uv_updateInformation</a>(figh);
0973 <a href="../../../../nucleus/functions/interface/beautifyAxes.html" class="code" title="function beautifyAxes(figh)">beautifyAxes</a>(figh);
0974 <span class="keyword">end</span>
0975 
0976 <span class="comment">%% subfunction to export the current view to a figure</span>
0977 <a name="_sub8" href="#_subfunctions" class="code">function uv_onPushView(src,~)</a>
0978 figh = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
0979 <span class="comment">% local GUI data</span>
0980 gui = getappdata(figh,<span class="string">'gui'</span>);
0981 
0982 <span class="comment">% opening the export figure</span>
0983 expfig = figure(<span class="string">'Color'</span>,gui.myui.colors.panelBG);
0984 
0985 <span class="comment">% create axes layout depending on view</span>
0986 <span class="keyword">switch</span> get(gui.rightPanel,<span class="string">'Selection'</span>)
0987     <span class="keyword">case</span> 1
0988         <span class="comment">% create layout</span>
0989         ax1 = subplot(2,2,1,<span class="string">'Parent'</span>,expfig);
0990         ax2 = subplot(2,2,2,<span class="string">'Parent'</span>,expfig);
0991         ax3 = subplot(2,2,[3 4],<span class="string">'Parent'</span>,expfig);
0992         <span class="comment">% get positions</span>
0993         pos1 = get(ax1,<span class="string">'Position'</span>);
0994         pos2 = get(ax2,<span class="string">'Position'</span>);
0995         pos3 = get(ax3,<span class="string">'Position'</span>);
0996         <span class="comment">% delete axes</span>
0997         delete(ax1);delete(ax2);delete(ax3);
0998         <span class="comment">% copy GUI axes</span>
0999         ax1 = copyobj(gui.axes12,expfig);
1000         ax2 = copyobj(gui.axes11,expfig);
1001         ax3 = copyobj(gui.axes2,expfig);
1002         <span class="comment">% adjust positions</span>
1003         set(ax1,<span class="string">'Position'</span>,pos1);
1004         set(ax2,<span class="string">'Position'</span>,pos2);
1005         set(ax3,<span class="string">'Position'</span>,pos3);
1006         <span class="comment">% legend</span>
1007         lgh1 = legend(ax2,<span class="string">'Location'</span>,<span class="string">'best'</span>);
1008         set(lgh1,<span class="string">'EdgeColor'</span>,gui.myui.colors.axisFG,<span class="keyword">...</span>
1009             <span class="string">'TextColor'</span>,gui.myui.colors.axisFG);
1010     <span class="keyword">case</span> 2
1011         <span class="comment">% create layout</span>
1012         ax1 = subplot(2,2,1,<span class="string">'Parent'</span>,expfig);
1013         ax2 = subplot(2,2,2,<span class="string">'Parent'</span>,expfig);
1014         ax3 = subplot(2,2,[3 4],<span class="string">'Parent'</span>,expfig);
1015         <span class="comment">% get positions</span>
1016         pos1 = get(ax1,<span class="string">'Position'</span>);
1017         pos2 = get(ax2,<span class="string">'Position'</span>);
1018         pos3 = get(ax3,<span class="string">'Position'</span>);
1019         <span class="comment">% delete axes</span>
1020         delete(ax1);delete(ax2);delete(ax3);
1021         <span class="comment">% copy GUI axes</span>
1022         ax1 = copyobj(gui.axes21,expfig);
1023         ax2 = copyobj(gui.axes22,expfig);
1024         ax3 = copyobj(gui.axes2,expfig);
1025         <span class="comment">% adjust positions</span>
1026         set(ax1,<span class="string">'Position'</span>,pos1);
1027         set(ax2,<span class="string">'Position'</span>,pos2);
1028         set(ax3,<span class="string">'Position'</span>,pos3);
1029         <span class="comment">% legend</span>
1030         lgh2 = legend(ax2,<span class="string">'Location'</span>,<span class="string">'best'</span>);
1031         set(lgh2,<span class="string">'EdgeColor'</span>,gui.myui.colors.axisFG,<span class="keyword">...</span>
1032             <span class="string">'TextColor'</span>,gui.myui.colors.axisFG);
1033 <span class="keyword">end</span>
1034 
1035 <span class="keyword">end</span>
1036 
1037 <span class="comment">%% subfunction to update the main NUCLEUSinv GUI</span>
1038 <a name="_sub9" href="#_subfunctions" class="code">function uv_onPushUpdate(src,~)</a>
1039 figh = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
1040 <span class="comment">% local GUI data</span>
1041 uvgui = getappdata(figh,<span class="string">'gui'</span>);
1042 uvdata = getappdata(figh,<span class="string">'data'</span>);
1043 <span class="comment">% NUCLEUSinv data</span>
1044 gui = getappdata(uvgui.figh_nucleus,<span class="string">'gui'</span>);
1045 data = getappdata(uvgui.figh_nucleus,<span class="string">'data'</span>);
1046 INVdata = getappdata(uvgui.figh_nucleus,<span class="string">'INVdata'</span>);
1047 
1048 <span class="keyword">switch</span> get(src,<span class="string">'Tag'</span>)
1049     <span class="keyword">case</span> <span class="string">'update'</span>
1050         <span class="comment">% update single data</span>
1051 
1052         <span class="comment">% get signal id</span>
1053         id = uvdata.uv.id0;
1054         <span class="comment">% get data</span>
1055         INVdata0 = INVdata{id};
1056 
1057         <span class="comment">% --- update data ---</span>
1058         <span class="comment">% -- general settings --</span>
1059         data.uncert.N = uvdata.uv.uncertN;
1060         data.uncert.Method = uvdata.uv.uncertMethod;
1061         data.uncert.Thresh = uvdata.uv.uncertThresh;
1062         data.uncert.Max = uvdata.uv.uncertMax;
1063 
1064         <span class="comment">% -- check if data was excluded --</span>
1065         <span class="keyword">if</span> sum(uvdata.uv.touse == 0) &gt; 0
1066             <span class="comment">% if yes, proceed</span>
1067             in = uvdata.uv.touse == 1;
1068             data.uncert.N = sum(in);
1069             uvdata.results.invstd.uncert.params.uncert.N = sum(in);
1070             uvdata.results.invstd.uncert.chi2_all = uvdata.results.invstd.uncert.chi2_all(in);
1071             uvdata.results.invstd.uncert.mnorm_all = uvdata.results.invstd.uncert.mnorm_all(in);
1072             uvdata.results.invstd.uncert.rnorm_all = uvdata.results.invstd.uncert.rnorm_all(in);
1073             uvdata.results.invstd.uncert.interp_f = uvdata.results.invstd.uncert.interp_f(in,:);
1074             uvdata.results.invstd.uncert.interp_s = uvdata.results.invstd.uncert.interp_s(:,in');
1075             uvdata.results.invstd.uncert.interp_E0 = uvdata.results.invstd.uncert.interp_E0(in);
1076             uvdata.results.invstd.uncert.E0 = [mean(uvdata.results.invstd.uncert.interp_E0) std(uvdata.results.invstd.uncert.interp_E0)];
1077             uvdata.results.invstd.uncert.interp_Tlgm = uvdata.results.invstd.uncert.interp_Tlgm(in);
1078             uvdata.results.invstd.uncert.Tlgm = [mean(uvdata.results.invstd.uncert.interp_Tlgm) std(uvdata.results.invstd.uncert.interp_Tlgm)];
1079         <span class="keyword">end</span>
1080 
1081         <span class="comment">% add statisitics</span>
1082         uvdata.results.invstd.uncert.statistics = uvdata.uv.stats;
1083 
1084         <span class="comment">% update data structs</span>
1085         data.results.invstd.uncert = uvdata.results.invstd.uncert;
1086         INVdata0.uncert = data.uncert;
1087         INVdata0.results.invstd = uvdata.results.invstd;
1088 
1089         <span class="comment">% update INVdata</span>
1090         INVdata{id} = INVdata0;
1091         <span class="comment">% update GUI data</span>
1092         setappdata(uvgui.figh_nucleus,<span class="string">'data'</span>,data);
1093         <span class="comment">% update GUI INVdata</span>
1094         setappdata(uvgui.figh_nucleus,<span class="string">'INVdata'</span>,INVdata);
1095 
1096         <span class="comment">% update relevant GUI elements</span>
1097         set(gui.edit_handles.uncert_N,<span class="string">'String'</span>,num2str(data.results.invstd.uncert.params.uncert.N))
1098 
1099         <span class="comment">% update plots and INFO fields in main NUCLEUS GUI</span>
1100         <a href="../../../../nucleus/functions/interface/updatePlotsSignal.html" class="code" title="function updatePlotsSignal">updatePlotsSignal</a>;
1101         <a href="../../../../nucleus/functions/interface/updatePlotsDistribution.html" class="code" title="function updatePlotsDistribution">updatePlotsDistribution</a>;
1102         <a href="../../../../nucleus/functions/interface/updateInfo.html" class="code" title="function updateInfo(src,~) %#ok<INUSD>">updateInfo</a>(gui.plots.SignalPanel);
1103 
1104     <span class="keyword">case</span> <span class="string">'apply2all'</span>
1105 
1106         <span class="comment">% calculate statistics for all signals in main GUI using the</span>
1107         <span class="comment">% current RTD bounds</span>
1108         infostring = <span class="string">'Apply UncertView RTD bounds 2 all ... '</span>;
1109         <a href="../../../../nucleus/functions/interface/displayStatusText.html" class="code" title="function displayStatusText(gui,string)">displayStatusText</a>(gui,infostring);
1110         <span class="comment">% loop over all signals</span>
1111         <span class="keyword">for</span> id = 1:numel(INVdata)
1112             <span class="comment">% only if there is Inversion data</span>
1113             <span class="keyword">if</span> isstruct(INVdata{id})
1114                 INVdataT = INVdata{id};
1115                 invstdT = INVdataT.results.invstd;
1116                 <span class="comment">% only if there is already uncertainty data</span>
1117                 <span class="keyword">if</span> isfield(invstdT,<span class="string">'uncert'</span>)
1118                     uncertT = invstdT.uncert;
1119                     uvT = uvdata.uv;
1120 
1121                     <span class="comment">% RTD time vector</span>
1122                     T = INVdataT.results.invstd.T1T2me;
1123                     <span class="comment">% kernel matrices for pure (single) E0 estimation</span>
1124                     iparam = invstdT.invparams;
1125                     <span class="keyword">switch</span> iparam.T1T2
1126                         <span class="keyword">case</span> <span class="string">'T1'</span>
1127                             K0 = <a href="../../../../nucleus/functions/inversion/createKernelMatrix.html" class="code" title="function K = createKernelMatrix(t,T,Tbulk,Tdiff,Tflag,T1IRfac)">createKernelMatrix</a>(10*INVdataT.results.nmrproc.t(end),T',<span class="keyword">...</span>
1128                                 iparam.Tb,iparam.Td,<span class="string">'T1'</span>,iparam.T1IRfac);
1129                         <span class="keyword">case</span> <span class="string">'T2'</span>
1130                             K0 = <a href="../../../../nucleus/functions/inversion/createKernelMatrix.html" class="code" title="function K = createKernelMatrix(t,T,Tbulk,Tdiff,Tflag,T1IRfac)">createKernelMatrix</a>(0,T',iparam.Tb,<span class="keyword">...</span>
1131                                 iparam.Td,<span class="string">'T2'</span>,iparam.T1IRfac);
1132                     <span class="keyword">end</span>
1133                     <span class="comment">% get statistics</span>
1134                     stats = <a href="../../../../nucleus/functions/inversion/getUncertaintyStatistics.html" class="code" title="function out = getUncertaintyStatistics(T,RTDs,range,K0)">getUncertaintyStatistics</a>(T,uncertT.interp_f,uvT.rtd_range,K0);
1135 
1136                     <span class="comment">% TLGM</span>
1137                     uvT.Tlgm = [stats.Tlgm(1) stats.Tlgm(2)];
1138                     <span class="comment">% aad - mean</span>
1139                     uvT.Tlgm_aad = stats.Tlgm(3);
1140                     <span class="comment">% aad - median</span>
1141                     uvT.Tlgm_aadmed = [stats.Tlgm_med(1) stats.Tlgm_med(2)];
1142                     <span class="comment">% E0</span>
1143                     uvT.E0 = [stats.E0(1) stats.E0(2)];
1144                     <span class="comment">% aad - mean</span>
1145                     uvT.E0_aad = stats.E0(3);
1146                     <span class="comment">% aad - median</span>
1147                     uvT.E0_aadmed = [stats.E0_med(1) stats.E0_med(2)];
1148 
1149                     uvT.stats = stats;
1150 
1151                     <span class="comment">% add statisitics</span>
1152                     INVdataT.results.invstd.uncert.statistics = stats;
1153                     <span class="comment">% update data structs</span>
1154                     INVdata{id} = INVdataT;
1155                 <span class="keyword">end</span>
1156             <span class="keyword">end</span>
1157         <span class="keyword">end</span>
1158         <span class="comment">% update GUI INVdata</span>
1159         setappdata(uvgui.figh_nucleus,<span class="string">'INVdata'</span>,INVdata);
1160         infostring = <span class="string">'Apply UncertView RTD bounds 2 all ... done'</span>;
1161         <a href="../../../../nucleus/functions/interface/displayStatusText.html" class="code" title="function displayStatusText(gui,string)">displayStatusText</a>(gui,infostring);
1162 <span class="keyword">end</span>
1163 
1164 <span class="keyword">end</span>
1165 
1166 <span class="comment">%% subfunction to reset chi2 and model norm bounds</span>
1167 <a name="_sub10" href="#_subfunctions" class="code">function uv_onPushReset(src,~)</a>
1168 figh = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
1169 gui = getappdata(figh,<span class="string">'gui'</span>);
1170 data = getappdata(figh,<span class="string">'data'</span>);
1171 uv = data.uv;
1172 invstd = data.results.invstd;
1173 uncert = invstd.uncert;
1174 
1175 <span class="keyword">switch</span> get(src,<span class="string">'Tag'</span>)
1176     <span class="keyword">case</span> <span class="string">'process'</span>
1177         <span class="comment">% reset to original values</span>
1178         chi2_range  = [min(uncert.chi2_all) max(uncert.chi2_all)];
1179         mnorm_range = [min(uncert.mnorm_all) max(uncert.mnorm_all)];
1180         <span class="comment">% update edit fields</span>
1181         set(gui.edit_handles.chi2_min,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,chi2_range(1,1)));
1182         set(gui.edit_handles.chi2_max,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,chi2_range(1,2)));
1183         set(gui.edit_handles.mnorm_min,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,mnorm_range(1,1)));
1184         set(gui.edit_handles.mnorm_max,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,mnorm_range(1,2)));
1185         <span class="comment">% update data</span>
1186         uv.chi2_range = chi2_range;
1187         uv.mnorm_range = mnorm_range;
1188         data.uv = uv;
1189         <span class="comment">% update logical mask for plotting</span>
1190         data = <a href="#_sub5" class="code" title="subfunction data = uv_updateMASK(data)">uv_updateMASK</a>(data);
1191     <span class="keyword">case</span> <span class="string">'rtd'</span>
1192         <span class="comment">% reset to original values</span>
1193         rtd_range = data.invstd.time;
1194         <span class="comment">% update edit fields</span>
1195         set(gui.edit_handles.rtd_min,<span class="string">'String'</span>,num2str(rtd_range(1,1)));
1196         set(gui.edit_handles.rtd_max,<span class="string">'String'</span>,num2str(rtd_range(1,2)));
1197         <span class="comment">% update data</span>
1198         uv.rtd_range = rtd_range;
1199         data.uv = uv;
1200 <span class="keyword">end</span>
1201 
1202 setappdata(figh,<span class="string">'data'</span>,data);
1203 <span class="comment">% update information</span>
1204 <a href="#_sub11" class="code" title="subfunction uv_updateInformation(figh)">uv_updateInformation</a>(figh);
1205 <span class="keyword">end</span>
1206 
1207 <span class="comment">%% subfunction to update the information output</span>
1208 <a name="_sub11" href="#_subfunctions" class="code">function uv_updateInformation(figh)</a>
1209 gui = getappdata(figh,<span class="string">'gui'</span>);
1210 data = getappdata(figh,<span class="string">'data'</span>);
1211 invstd = data.results.invstd;
1212 uncert = invstd.uncert;
1213 uv = data.uv;
1214 
1215 <span class="comment">% which models to use</span>
1216 in = data.uv.touse == 1;
1217 <span class="comment">% RTD time vector</span>
1218 T = data.results.invstd.T1T2me;
1219 <span class="comment">% kernel matrices for pure (single) E0 estimation</span>
1220 iparam = invstd.invparams;
1221 <span class="keyword">switch</span> iparam.T1T2
1222     <span class="keyword">case</span> <span class="string">'T1'</span>
1223         K0 = <a href="../../../../nucleus/functions/inversion/createKernelMatrix.html" class="code" title="function K = createKernelMatrix(t,T,Tbulk,Tdiff,Tflag,T1IRfac)">createKernelMatrix</a>(10*data.results.nmrproc.t(end),T',<span class="keyword">...</span>
1224             iparam.Tb,iparam.Td,<span class="string">'T1'</span>,iparam.T1IRfac);
1225     <span class="keyword">case</span> <span class="string">'T2'</span>
1226         K0 = <a href="../../../../nucleus/functions/inversion/createKernelMatrix.html" class="code" title="function K = createKernelMatrix(t,T,Tbulk,Tdiff,Tflag,T1IRfac)">createKernelMatrix</a>(0,T',iparam.Tb,<span class="keyword">...</span>
1227             iparam.Td,<span class="string">'T2'</span>,iparam.T1IRfac);
1228 <span class="keyword">end</span>
1229 <span class="comment">% get statistics</span>
1230 stats = <a href="../../../../nucleus/functions/inversion/getUncertaintyStatistics.html" class="code" title="function out = getUncertaintyStatistics(T,RTDs,range,K0)">getUncertaintyStatistics</a>(T,uncert.interp_f(in,:),uv.rtd_range,K0);
1231 
1232 <span class="comment">% assign to GUI fields</span>
1233 <span class="comment">% TLGM</span>
1234 uv.Tlgm = [stats.Tlgm(1) stats.Tlgm(2)];
1235 set(gui.edit_handles.TLGM_mean,<span class="string">'String'</span>,sprintf(<span class="string">'%5.4f'</span>,uv.Tlgm(1)));
1236 set(gui.edit_handles.TLGM_std,<span class="string">'String'</span>,sprintf(<span class="string">'%5.4f'</span>,2*uv.Tlgm(2)));
1237 <span class="comment">% aad - mean</span>
1238 uv.Tlgm_aad = stats.Tlgm(3);
1239 set(gui.edit_handles.TLGM_aad,<span class="string">'String'</span>,sprintf(<span class="string">'%5.4f'</span>,2*uv.Tlgm_aad));
1240 <span class="comment">% aad - median</span>
1241 uv.Tlgm_aadmed = [stats.Tlgm_med(1) stats.Tlgm_med(2)];
1242 set(gui.edit_handles.TLGM_med,<span class="string">'String'</span>,sprintf(<span class="string">'%5.4f'</span>,uv.Tlgm_aadmed(1)));
1243 set(gui.edit_handles.TLGM_aadmed,<span class="string">'String'</span>,sprintf(<span class="string">'%5.4f'</span>,2*uv.Tlgm_aadmed(2)));
1244 <span class="comment">% E0</span>
1245 uv.E0 = [stats.E0(1) stats.E0(2)];
1246 set(gui.edit_handles.E0_mean,<span class="string">'String'</span>,sprintf(<span class="string">'%5.4f'</span>,uv.E0(1)));
1247 set(gui.edit_handles.E0_std,<span class="string">'String'</span>,sprintf(<span class="string">'%5.4f'</span>,2*uv.E0(2)));
1248 <span class="comment">% aad - mean</span>
1249 uv.E0_aad = stats.E0(3);
1250 set(gui.edit_handles.E0_aad,<span class="string">'String'</span>,sprintf(<span class="string">'%5.4f'</span>,2*uv.E0_aad));
1251 <span class="comment">% aad - median</span>
1252 uv.E0_aadmed = [stats.E0_med(1) stats.E0_med(2)];
1253 set(gui.edit_handles.E0_med,<span class="string">'String'</span>,sprintf(<span class="string">'%5.4f'</span>,uv.E0_aadmed(1)));
1254 set(gui.edit_handles.E0_aadmed,<span class="string">'String'</span>,sprintf(<span class="string">'%5.4f'</span>,2*uv.E0_aadmed(2)));
1255 
1256 <span class="comment">% update GUI data</span>
1257 uv.stats = stats;
1258 data.uv = uv;
1259 setappdata(figh,<span class="string">'data'</span>,data);
1260 <span class="comment">% update plots</span>
1261 <a href="#_sub12" class="code" title="subfunction uv_updatePlots(figh)">uv_updatePlots</a>(figh);
1262 <span class="keyword">end</span>
1263 
1264 <span class="comment">%% subfunction to update all plots</span>
1265 <a name="_sub12" href="#_subfunctions" class="code">function uv_updatePlots(figh)</a>
1266 gui = getappdata(figh,<span class="string">'gui'</span>);
1267 data = getappdata(figh,<span class="string">'data'</span>);
1268 
1269 <span class="comment">% clear axes</span>
1270 <a href="../../../../nucleus/functions/interface/clearAllAxes.html" class="code" title="function clearAllAxes(figh)">clearAllAxes</a>(figh);
1271 hold(gui.axes11,<span class="string">'on'</span>);
1272 hold(gui.axes12,<span class="string">'on'</span>);
1273 hold(gui.axes2,<span class="string">'on'</span>);
1274 hold(gui.axes21,<span class="string">'on'</span>);
1275 hold(gui.axes22,<span class="string">'on'</span>);
1276 
1277 <span class="comment">% get relevant data</span>
1278 uv = data.uv;
1279 invstd = data.results.invstd;
1280 uncert = invstd.uncert;
1281 col = gui.myui.colors;
1282 
1283 <span class="comment">% get indices for models to use and not to use</span>
1284 in = data.uv.touse == 1;
1285 out = data.uv.touse == 0;
1286 
1287 <span class="keyword">switch</span> uv.colorstyle
1288     <span class="keyword">case</span> <span class="string">'none'</span>
1289         <span class="comment">% default gray</span>
1290         lcolors = [0.5 0.5 0.5];
1291         tmpchi2 = uncert.chi2_all(in);
1292         tmpmnorm = uncert.mnorm_all(in);
1293         <span class="comment">% tmpE0 = uncert.interp_E0(in);</span>
1294         <span class="comment">% tmpTlgm = uncert.interp_Tlgm(in);</span>
1295         tmpE0 = uv.stats.E0_all;
1296         tmpTlgm = uv.stats.Tlgm_all;
1297         clims = [0 1];
1298     <span class="keyword">case</span> <span class="string">'chi2'</span>
1299         tmp = uncert.chi2_all(in);
1300         [tmpchi2,idx] = sort(tmp);
1301         lcolors = tmpchi2;
1302         tmpmnorm = uncert.mnorm_all(in);
1303         tmpmnorm = tmpmnorm(idx);
1304         <span class="comment">% tmpE0 = uncert.interp_E0(in);</span>
1305         tmpE0 = uv.stats.E0_all;
1306         tmpE0 = tmpE0(idx);
1307         <span class="comment">% tmpTlgm = uncert.interp_Tlgm(in);</span>
1308         tmpTlgm = uv.stats.Tlgm_all;
1309         tmpTlgm = tmpTlgm(idx);
1310         <span class="comment">% clims = [min(uncert.chi2_all) max(uncert.chi2_all)];</span>
1311         clims = [min(uncert.chi2_all(in)) max(uncert.chi2_all(in))];
1312     <span class="keyword">case</span> <span class="string">'xn'</span>
1313         tmp = uncert.mnorm_all(in);
1314         [tmpmnorm,idx] = sort(tmp);
1315         lcolors = tmpmnorm;
1316         tmpchi2 = uncert.chi2_all(in);
1317         tmpchi2 = tmpchi2(idx);
1318         <span class="comment">% tmpE0 = uncert.interp_E0(in);</span>
1319         tmpE0 = uv.stats.E0_all;
1320         tmpE0 = tmpE0(idx);
1321         <span class="comment">% tmpTlgm = uncert.interp_Tlgm(in);</span>
1322         tmpTlgm = uv.stats.Tlgm_all;
1323         tmpTlgm = tmpTlgm(idx);
1324         <span class="comment">% clims = [min(uncert.mnorm_all) max(uncert.mnorm_all)];</span>
1325         clims = [min(uncert.mnorm_all(in)) max(uncert.mnorm_all(in))];
1326 <span class="keyword">end</span>
1327 
1328 <span class="comment">% --- chi2 vs model norm ---</span>
1329 scatter(uncert.chi2_all(out),uncert.mnorm_all(out),[],<span class="string">'red'</span>,<span class="keyword">...</span>
1330     <span class="string">'LineWidth'</span>,1,<span class="string">'Parent'</span>,gui.axes12);
1331 scatter(gui.axes12,tmpchi2,tmpmnorm,[],lcolors,<span class="keyword">...</span>
1332     <span class="string">'LineWidth'</span>,1);
1333 plot(invstd.chi2,invstd.xn,<span class="string">'+'</span>,<span class="string">'MarkerSize'</span>,10,<span class="string">'Color'</span>,col.FIT,<span class="string">'Parent'</span>,gui.axes12);
1334 <span class="comment">% axis limits</span>
1335 xlims = [min([uncert.chi2_all(in); invstd.chi2]) max([uncert.chi2_all(in); invstd.chi2])];
1336 dx = xlims(2)-xlims(1);
1337 xlims = [xlims(1)-dx/5 xlims(2)+dx/5];
1338 ylims = [min([uncert.mnorm_all(in); invstd.xn]) max([uncert.mnorm_all(in); invstd.xn])];
1339 dy = ylims(2)-ylims(1);
1340 ylims = [ylims(1)-dy/5 ylims(2)+dy/5];
1341 <span class="comment">% -- lines indicating TLGM and E0 bounds --</span>
1342 line([min(uncert.chi2_all(in)) min(uncert.chi2_all(in))],[ylims(1) ylims(2)],<span class="string">'Color'</span>,[0.25 0.25 0.25],<span class="keyword">...</span>
1343     <span class="string">'LineStyle'</span>,<span class="string">':'</span>,<span class="string">'LineWidth'</span>,0.75,<span class="string">'Parent'</span>,gui.axes12,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1344 line([max(uncert.chi2_all(in)) max(uncert.chi2_all(in))],[ylims(1) ylims(2)],<span class="string">'Color'</span>,[0.25 0.25 0.25],<span class="keyword">...</span>
1345     <span class="string">'LineStyle'</span>,<span class="string">':'</span>,<span class="string">'LineWidth'</span>,0.75,<span class="string">'Parent'</span>,gui.axes12,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1346 line([xlims(1) xlims(2)],[min(uncert.mnorm_all(in)) min(uncert.mnorm_all(in))],<span class="string">'Color'</span>,[0.25 0.25 0.25],<span class="keyword">...</span>
1347     <span class="string">'LineStyle'</span>,<span class="string">':'</span>,<span class="string">'LineWidth'</span>,0.75,<span class="string">'Parent'</span>,gui.axes12,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1348 line([xlims(1) xlims(2)],[max(uncert.mnorm_all(in)) max(uncert.mnorm_all(in))],<span class="string">'Color'</span>,[0.25 0.25 0.25],<span class="keyword">...</span>
1349     <span class="string">'LineStyle'</span>,<span class="string">':'</span>,<span class="string">'LineWidth'</span>,0.75,<span class="string">'Parent'</span>,gui.axes12,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1350 <span class="comment">% axis setings</span>
1351 set(gui.axes12,<span class="string">'XScale'</span>,<span class="string">'lin'</span>,<span class="string">'XLim'</span>,xlims);
1352 set(gui.axes12,<span class="string">'YScale'</span>,<span class="string">'log'</span>,<span class="string">'YLim'</span>,ylims);
1353 set(gui.axes12,<span class="string">'CLim'</span>,clims);
1354 set(get(gui.axes12,<span class="string">'XLabel'</span>),<span class="string">'String'</span>,<span class="string">'X (error weighted residuals)'</span>);
1355 set(get(gui.axes12,<span class="string">'YLabel'</span>),<span class="string">'String'</span>,<span class="string">'model norm |Lm|_{2}'</span>);
1356 
1357 <span class="comment">% --- TLGM vs E0 ---</span>
1358 scatter(uncert.interp_Tlgm(out),uncert.interp_E0(out),[],<span class="string">'red'</span>,<span class="keyword">...</span>
1359     <span class="string">'LineWidth'</span>,1,<span class="string">'DisplayName'</span>,<span class="string">'runs (out)'</span>,<span class="string">'Parent'</span>,gui.axes11);
1360 scatter(tmpTlgm,tmpE0,[],lcolors,<span class="keyword">...</span>
1361     <span class="string">'LineWidth'</span>,1,<span class="string">'DisplayName'</span>,<span class="string">'runs (in)'</span>,<span class="string">'Parent'</span>,gui.axes11);
1362 plot(invstd.Tlgm,invstd.E0,<span class="string">'+'</span>,<span class="string">'MarkerSize'</span>,10,<span class="string">'Color'</span>,col.FIT,<span class="keyword">...</span>
1363     <span class="string">'DisplayName'</span>,<span class="string">'init'</span>,<span class="string">'Parent'</span>,gui.axes11);
1364 errorbar(uv.Tlgm(1),uv.E0(1),2*uv.E0(2),2*uv.E0(2),2*uv.Tlgm(2),2*uv.Tlgm(2),<span class="keyword">...</span>
1365     <span class="string">'Color'</span>,col.BoxPRC,<span class="string">'LineWidth'</span>,2,<span class="string">'DisplayName'</span>,<span class="string">'mean (2*std)'</span>,<span class="string">'Parent'</span>,gui.axes11);
1366 errorbar(uv.Tlgm_aadmed(1),uv.E0_aadmed(1),2*uv.E0_aadmed(2),2*uv.E0_aadmed(2),2*uv.Tlgm_aadmed(2),2*uv.Tlgm_aadmed(2),<span class="keyword">...</span>
1367     <span class="string">'Color'</span>,col.BoxCPS,<span class="string">'LineWidth'</span>,2,<span class="string">'DisplayName'</span>,<span class="string">'median (2*aad)'</span>,<span class="string">'Parent'</span>,gui.axes11);
1368 <span class="comment">% axis limits</span>
1369 <span class="comment">% xlims = [min([uncert.interp_Tlgm; invstd.Tlgm; uv.Tlgm(1)])*0.95 ...</span>
1370 <span class="comment">%     max([uncert.interp_Tlgm; invstd.Tlgm; uv.Tlgm(1)])*1.05];</span>
1371 <span class="comment">% ylims = [min([uncert.interp_E0; invstd.E0; uv.E0(1)])*0.95 ...</span>
1372 <span class="comment">%     max([uncert.interp_E0; invstd.E0; uv.E0(1)])*1.05];</span>
1373 <span class="comment">% xlims = [min([uncert.interp_Tlgm(in); invstd.Tlgm; uv.Tlgm(1)])*0.975 ...</span>
1374 <span class="comment">%     max([uncert.interp_Tlgm(in); invstd.Tlgm; uv.Tlgm(1)])*1.025];</span>
1375 <span class="comment">% ylims = [min([uncert.interp_E0(in); invstd.E0; uv.E0(1)])*0.975 ...</span>
1376 <span class="comment">%     max([uncert.interp_E0(in); invstd.E0; uv.E0(1)])*1.025];</span>
1377 xlims = [min([tmpTlgm; invstd.Tlgm; uv.Tlgm(1)])*0.975 <span class="keyword">...</span>
1378     max([tmpTlgm; invstd.Tlgm; uv.Tlgm(1)])*1.025];
1379 ylims = [min([tmpE0; invstd.E0; uv.E0(1)])*0.975 <span class="keyword">...</span>
1380     max([tmpE0; invstd.E0; uv.E0(1)])*1.025];
1381 <span class="comment">% -- lines indicating TLGM and E0 bounds --</span>
1382 line([min(uncert.interp_Tlgm(in)) min(uncert.interp_Tlgm(in))],[ylims(1) ylims(2)],<span class="string">'Color'</span>,[0.25 0.25 0.25],<span class="keyword">...</span>
1383     <span class="string">'LineStyle'</span>,<span class="string">':'</span>,<span class="string">'LineWidth'</span>,0.75,<span class="string">'HandleVisibility'</span>,<span class="string">'off'</span>,<span class="string">'Parent'</span>,gui.axes11,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1384 line([max(uncert.interp_Tlgm(in)) max(uncert.interp_Tlgm(in))],[ylims(1) ylims(2)],<span class="string">'Color'</span>,[0.25 0.25 0.25],<span class="keyword">...</span>
1385     <span class="string">'LineStyle'</span>,<span class="string">':'</span>,<span class="string">'LineWidth'</span>,0.75,<span class="string">'HandleVisibility'</span>,<span class="string">'off'</span>,<span class="string">'Parent'</span>,gui.axes11,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1386 line([xlims(1) xlims(2)],[min(uncert.interp_E0(in)) min(uncert.interp_E0(in))],<span class="string">'Color'</span>,[0.25 0.25 0.25],<span class="keyword">...</span>
1387     <span class="string">'LineStyle'</span>,<span class="string">':'</span>,<span class="string">'LineWidth'</span>,0.75,<span class="string">'HandleVisibility'</span>,<span class="string">'off'</span>,<span class="string">'Parent'</span>,gui.axes11,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1388 line([xlims(1) xlims(2)],[max(uncert.interp_E0(in)) max(uncert.interp_E0(in))],<span class="string">'Color'</span>,[0.25 0.25 0.25],<span class="keyword">...</span>
1389     <span class="string">'LineStyle'</span>,<span class="string">':'</span>,<span class="string">'LineWidth'</span>,0.75,<span class="string">'HandleVisibility'</span>,<span class="string">'off'</span>,<span class="string">'Parent'</span>,gui.axes11,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1390 lgh = legend(gui.axes11,<span class="string">'Location'</span>,<span class="string">'NorthEast'</span>);
1391 set(lgh,<span class="string">'EdgeColor'</span>,gui.myui.colors.axisFG,<span class="string">'TextColor'</span>,gui.myui.colors.axisFG);
1392 <span class="comment">% axis settings</span>
1393 set(gui.axes11,<span class="string">'XScale'</span>,<span class="string">'lin'</span>,<span class="string">'XLim'</span>,xlims);
1394 set(gui.axes11,<span class="string">'YScale'</span>,<span class="string">'lin'</span>,<span class="string">'YLim'</span>,ylims);
1395 set(gui.axes11,<span class="string">'CLim'</span>,clims);
1396 set(get(gui.axes11,<span class="string">'XLabel'</span>),<span class="string">'String'</span>,<span class="string">'TLGM'</span>);
1397 set(get(gui.axes11,<span class="string">'YLabel'</span>),<span class="string">'String'</span>,<span class="string">'initial amplitude E0'</span>);
1398 
1399 <span class="comment">% --- RTDs ---</span>
1400 plotmethod = 1;
1401 <span class="keyword">switch</span> uv.rtd_plotstyle
1402     <span class="keyword">case</span> <span class="string">'patchmean'</span>
1403         plotmethod = 2;
1404     <span class="keyword">case</span> <span class="string">'patchmedian'</span>
1405         plotmethod = 3;
1406     <span class="keyword">otherwise</span>
1407         <span class="comment">% nothing to do because 'lines' is default</span>
1408 <span class="keyword">end</span>
1409 
1410 <span class="comment">% the 'init' RTD</span>
1411 F0 = invstd.T1T2f;
1412 <span class="comment">% normalize all curves to the median of all E0 values</span>
1413 E0norm = uv.E0_aadmed(1);
1414 <span class="keyword">if</span> sum(F0)&gt;0
1415     F = (data.invstd.porosity*100).*F0./E0norm;
1416     ylims = [0 max(F)*1.05];
1417 <span class="keyword">else</span>
1418     ylims = [-1 1];
1419 <span class="keyword">end</span>
1420 <span class="comment">% the uncertainty runs</span>
1421 <span class="comment">% only the selected ones within the chi2 and xn bounds</span>
1422 FDIST = uncert.interp_f(in,:);
1423 <span class="comment">% scaling</span>
1424 FDIST = (data.invstd.porosity*100).*FDIST./E0norm;
1425 
1426 <span class="comment">% if selected plot lines</span>
1427 <span class="keyword">if</span> plotmethod == 1
1428     <span class="comment">% find maximum for axis limts</span>
1429     f_max = max([ylims(2) max(FDIST(:))]);
1430     <span class="keyword">switch</span> uv.colorstyle
1431         <span class="keyword">case</span> {<span class="string">'chi2'</span>,<span class="string">'xn'</span>}
1432             <span class="comment">% get colormap from chi2 vs xn axis</span>
1433             cmap = get(gui.axes12,<span class="string">'Colormap'</span>);
1434             <span class="comment">% make vector of values to sort</span>
1435             idc = linspace(clims(1),clims(2),size(cmap,1));
1436             <span class="keyword">for</span> i1 = 1:sum(in)
1437                 <span class="comment">% find closest value (need for coloring)</span>
1438                 idc1 = find(abs(idc-tmp(idx(i1)))==min(abs(idc-tmp(idx(i1)))));
1439                 <span class="comment">% idc1 = abs(idc-tmp(idx(i1)))==min(abs(idc-tmp(idx(i1))));</span>
1440                 <span class="comment">% plot line with correct color</span>
1441                 plot(invstd.T1T2me,FDIST(idx(i1),:),<span class="string">'-'</span>,<span class="string">'Color'</span>,cmap(idc1(1),:),<span class="keyword">...</span>
1442                     <span class="string">'LineWidth'</span>,1,<span class="string">'Displayname'</span>,num2str(tmp(idx(i1))),<span class="string">'Parent'</span>,gui.axes2);
1443             <span class="keyword">end</span>
1444             <span class="comment">% adjust color limits</span>
1445             set(gui.axes2,<span class="string">'CLim'</span>,clims);
1446         <span class="keyword">otherwise</span>
1447             <span class="comment">% need to plot transpose of FDIST because 'x' is a column vector</span>
1448             <span class="comment">% otherwise plot goes bananas if numel(x) = #models</span>
1449             plot(invstd.T1T2me,FDIST',<span class="string">'-'</span>,<span class="string">'Color'</span>,[0.5 0.5 0.5],<span class="keyword">...</span>
1450                 <span class="string">'LineWidth'</span>,1,<span class="string">'Parent'</span>,gui.axes2);
1451     <span class="keyword">end</span>
1452 <span class="keyword">end</span>
1453 
1454 <span class="comment">% if selected plot patch</span>
1455 <span class="keyword">if</span> plotmethod &gt; 1
1456     <span class="comment">% what kind of patch is created</span>
1457     <span class="keyword">if</span> plotmethod == 2 <span class="comment">% mean +- std</span>
1458         mean_f = mean(FDIST);
1459         std_f = std(FDIST);
1460     <span class="keyword">else</span> <span class="comment">% median +- mad</span>
1461         mean_f = median(FDIST);
1462         std_f = <a href="../../../../nucleus/functions/inversion/getAAD.html" class="code" title="function aad = getAAD(x,flag,dim)">getAAD</a>(FDIST,1);
1463     <span class="keyword">end</span>
1464 
1465     <span class="comment">% patch lower and upper bounds</span>
1466     patch_f_std1 = [mean_f+std_f;mean_f-std_f];
1467     patch_f_std2 = [mean_f+2*std_f;mean_f-2*std_f];
1468     patch_f_std3 = [mean_f+3*std_f;mean_f-3*std_f];
1469     patch_f_std1(patch_f_std1&lt;0) = 0;
1470     patch_f_std2(patch_f_std2&lt;0) = 0;
1471     patch_f_std3(patch_f_std3&lt;0) = 0;
1472     f_max = max([ylims(2) max(patch_f_std1) max(patch_f_std2) max(patch_f_std3)]);
1473 
1474     <span class="comment">% draw all three patches on top of each other</span>
1475     verts = [invstd.T1T2me patch_f_std3(2,:)'; flipud(invstd.T1T2me) flipud(patch_f_std3(1,:)')];
1476     faces = 1:1:size(verts,1);
1477     patch(<span class="string">'Faces'</span>,faces,<span class="string">'Vertices'</span>,verts,<span class="string">'FaceColor'</span>,[0.6 0.6 0.6],<span class="keyword">...</span>
1478         <span class="string">'FaceAlpha'</span>,0.75,<span class="string">'EdgeColor'</span>,<span class="string">'none'</span>,<span class="string">'Parent'</span>,gui.axes2);
1479     verts = [invstd.T1T2me patch_f_std2(2,:)'; flipud(invstd.T1T2me) flipud(patch_f_std2(1,:)')];
1480     faces = 1:1:size(verts,1);
1481     patch(<span class="string">'Faces'</span>,faces,<span class="string">'Vertices'</span>,verts,<span class="string">'FaceColor'</span>,[0.4 0.4 0.4],<span class="keyword">...</span>
1482         <span class="string">'FaceAlpha'</span>,0.75,<span class="string">'EdgeColor'</span>,<span class="string">'none'</span>,<span class="string">'Parent'</span>,gui.axes2);
1483     verts = [invstd.T1T2me patch_f_std1(2,:)'; flipud(invstd.T1T2me) flipud(patch_f_std1(1,:)')];
1484     faces = 1:1:size(verts,1);
1485     patch(<span class="string">'Faces'</span>,faces,<span class="string">'Vertices'</span>,verts,<span class="string">'FaceColor'</span>,[0.2 0.2 0.2],<span class="keyword">...</span>
1486         <span class="string">'FaceAlpha'</span>,0.75,<span class="string">'EdgeColor'</span>,<span class="string">'none'</span>,<span class="string">'Parent'</span>,gui.axes2);
1487 <span class="keyword">end</span>
1488 
1489 <span class="comment">% adjust y-limits</span>
1490 ylims(2) = max([ylims(2) max(f_max)*1.05]);
1491 
1492 <span class="comment">% plot original solution</span>
1493 plot(invstd.T1T2me,F,<span class="string">'-'</span>,<span class="string">'Color'</span>,col.FIT,<span class="string">'Parent'</span>,gui.axes2);
1494 
1495 <span class="comment">% axes properties</span>
1496 ticks = 10.^(round(log10(min(invstd.T1T2me)) :1: log10(max(invstd.T1T2me))));
1497 set(gui.axes2,<span class="string">'XScale'</span>,<span class="string">'log'</span>,<span class="string">'XLim'</span>,[ticks(1) ticks(end)],<span class="string">'XTick'</span>,ticks);
1498 set(gui.axes2,<span class="string">'YScale'</span>,<span class="string">'lin'</span>,<span class="string">'YLim'</span>,ylims);
1499 set(get(gui.axes2,<span class="string">'XLabel'</span>),<span class="string">'String'</span>,<span class="string">'relaxation time'</span>);
1500 set(get(gui.axes2,<span class="string">'YLabel'</span>),<span class="string">'String'</span>,<span class="string">'amplitude'</span>);
1501 grid(gui.axes2,<span class="string">'on'</span>);
1502 
1503 <span class="comment">% -- RTD bounds --</span>
1504 uv = data.uv;
1505 <span class="comment">% line([uv.rtd_range(1) uv.rtd_range(1)],[0 ylims(2)],'Color',[0.25 0.25 0.25],...</span>
1506 <span class="comment">%     'LineStyle','-.','LineWidth',2,'Parent',gui.axes2,'Tag','infolines');</span>
1507 <span class="comment">% line([uv.rtd_range(2) uv.rtd_range(2)],[0 ylims(2)],'Color',[0.25 0.25 0.25],...</span>
1508 <span class="comment">%     'LineStyle','-.','LineWidth',2,'Parent',gui.axes2,'Tag','infolines');</span>
1509 p_alpha = 0.8;
1510 <span class="keyword">if</span> uv.rtd_range(1)&gt;ticks(1)
1511     <span class="comment">% draw a transparent patch</span>
1512     v = [ticks(1) ylims(1); ticks(1) ylims(2);
1513         uv.rtd_range(1) ylims(2); uv.rtd_range(1) ylims(1)];
1514     f = [1 2 3 4 1];
1515     patch(<span class="string">'Vertices'</span>,v,<span class="string">'Faces'</span>,f,<span class="string">'FaceColor'</span>,<span class="string">'w'</span>,<span class="string">'FaceAlpha'</span>,p_alpha,<span class="keyword">...</span>
1516         <span class="string">'HandleVisibility'</span>,<span class="string">'off'</span>,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>,<span class="string">'Parent'</span>, gui.axes2);
1517 <span class="keyword">end</span>
1518 <span class="keyword">if</span> uv.rtd_range(2)&lt;ticks(end)
1519     <span class="comment">% draw a transparent patch</span>
1520     v = [ticks(end) ylims(1); ticks(end) ylims(2);
1521         uv.rtd_range(2) ylims(2); uv.rtd_range(2) ylims(1)];
1522     f = [1 2 3 4 1];
1523     patch(<span class="string">'Vertices'</span>,v,<span class="string">'Faces'</span>,f,<span class="string">'FaceColor'</span>,<span class="string">'w'</span>,<span class="string">'FaceAlpha'</span>,p_alpha,<span class="keyword">...</span>
1524         <span class="string">'HandleVisibility'</span>,<span class="string">'off'</span>,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>,<span class="string">'Parent'</span>, gui.axes2);
1525 <span class="keyword">end</span>
1526 
1527 <span class="comment">% --- Histograms ---</span>
1528 <span class="comment">% [f1,xi1] = getKernelDensityEstimate(uncert.interp_E0(in));</span>
1529 <span class="comment">% [f2,xi2] = getKernelDensityEstimate(uncert.interp_Tlgm(in));</span>
1530 [f1,xi1] = <a href="../../../../nucleus/functions/interface/getKernelDensityEstimate.html" class="code" title="function [f,x] = getKernelDensityEstimate(y)">getKernelDensityEstimate</a>(uv.stats.E0_all);
1531 [f2,xi2] = <a href="../../../../nucleus/functions/interface/getKernelDensityEstimate.html" class="code" title="function [f,x] = getKernelDensityEstimate(y)">getKernelDensityEstimate</a>(uv.stats.Tlgm_all);
1532 
1533 <span class="comment">% plot the KDEs</span>
1534 plot(xi1,f1,<span class="string">'Color'</span>,[0.5 0.5 0.5],<span class="string">'DisplayName'</span>,<span class="string">'KDE'</span>,<span class="string">'Parent'</span>,gui.axes21);
1535 plot(xi2,f2,<span class="string">'Color'</span>,[0.5 0.5 0.5],<span class="string">'DisplayName'</span>,<span class="string">'KDE'</span>,<span class="string">'Parent'</span>,gui.axes22);
1536 
1537 <span class="comment">% &quot;init&quot; E0</span>
1538 line([invstd.E0 invstd.E0],[0 max(f1)],<span class="string">'Color'</span>,col.FIT,<span class="keyword">...</span>
1539     <span class="string">'LineStyle'</span>,<span class="string">':'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'Parent'</span>,gui.axes21,<span class="string">'DisplayName'</span>,<span class="string">'init'</span>,<span class="keyword">...</span>
1540     <span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1541 <span class="comment">% &quot;init&quot; TLGM</span>
1542 line([invstd.Tlgm invstd.Tlgm],[0 max(f2)],<span class="string">'Color'</span>,col.FIT,<span class="keyword">...</span>
1543     <span class="string">'LineStyle'</span>,<span class="string">':'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'Parent'</span>,gui.axes22,<span class="string">'DisplayName'</span>,<span class="string">'init'</span>,<span class="keyword">...</span>
1544     <span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1545 
1546 <span class="comment">% mean E0</span>
1547 line([uv.E0(1) uv.E0(1)],[0 max(f1)],<span class="string">'Color'</span>,col.BoxPRC,<span class="keyword">...</span>
1548     <span class="string">'LineStyle'</span>,<span class="string">'-'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'Parent'</span>,gui.axes21,<span class="string">'DisplayName'</span>,<span class="string">'mean'</span>);
1549 line([uv.E0(1)+2*uv.E0(2) uv.E0(1)+2*uv.E0(2)],[0 max(f1)],<span class="string">'Color'</span>,col.BoxPRC,<span class="keyword">...</span>
1550     <span class="string">'LineStyle'</span>,<span class="string">'--'</span>,<span class="string">'LineWidth'</span>,1,<span class="string">'Parent'</span>,gui.axes21,<span class="string">'DisplayName'</span>,<span class="string">'2*std'</span>);
1551 line([uv.E0(1)-2*uv.E0(2) uv.E0(1)-2*uv.E0(2)],[0 max(f1)],<span class="string">'Color'</span>,col.BoxPRC,<span class="keyword">...</span>
1552     <span class="string">'LineStyle'</span>,<span class="string">'--'</span>,<span class="string">'LineWidth'</span>,1,<span class="string">'Parent'</span>,gui.axes21,<span class="string">'DisplayName'</span>,<span class="string">'2*std'</span>,<span class="keyword">...</span>
1553     <span class="string">'HandleVisibility'</span>,<span class="string">'off'</span>,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1554 
1555 <span class="comment">% mean TLGM</span>
1556 line([uv.Tlgm(1) uv.Tlgm(1)],[0 max(f2)],<span class="string">'Color'</span>,col.BoxPRC,<span class="keyword">...</span>
1557     <span class="string">'LineStyle'</span>,<span class="string">'-'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'Parent'</span>,gui.axes22,<span class="string">'DisplayName'</span>,<span class="string">'mean'</span>);
1558 line([uv.Tlgm(1)+2*uv.Tlgm(2) uv.Tlgm(1)+2*uv.Tlgm(2)],[0 max(f2)],<span class="string">'Color'</span>,col.BoxPRC,<span class="keyword">...</span>
1559     <span class="string">'LineStyle'</span>,<span class="string">'--'</span>,<span class="string">'LineWidth'</span>,1,<span class="string">'Parent'</span>,gui.axes22,<span class="string">'DisplayName'</span>,<span class="string">'2*std'</span>);
1560 line([uv.Tlgm(1)-2*uv.Tlgm(2) uv.Tlgm(1)-2*uv.Tlgm(2)],[0 max(f2)],<span class="string">'Color'</span>,col.BoxPRC,<span class="keyword">...</span>
1561     <span class="string">'LineStyle'</span>,<span class="string">'--'</span>,<span class="string">'LineWidth'</span>,1,<span class="string">'Parent'</span>,gui.axes22,<span class="string">'DisplayName'</span>,<span class="string">'2*std'</span>,<span class="keyword">...</span>
1562     <span class="string">'HandleVisibility'</span>,<span class="string">'off'</span>,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1563 
1564 <span class="comment">% median E0</span>
1565 line([uv.E0_aadmed(1) uv.E0_aadmed(1)],[0 max(f1)],<span class="string">'Color'</span>,col.BoxCPS,<span class="keyword">...</span>
1566     <span class="string">'LineStyle'</span>,<span class="string">'-'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'Parent'</span>,gui.axes21,<span class="string">'DisplayName'</span>,<span class="string">'median'</span>);
1567 line([uv.E0_aadmed(1)+2*uv.E0_aadmed(2) uv.E0_aadmed(1)+2*uv.E0_aadmed(2)],<span class="keyword">...</span>
1568     [0 max(f1)],<span class="string">'Color'</span>,col.BoxCPS,<span class="string">'LineStyle'</span>,<span class="string">'--'</span>,<span class="string">'LineWidth'</span>,1,<span class="keyword">...</span>
1569     <span class="string">'Parent'</span>,gui.axes21,<span class="string">'DisplayName'</span>,<span class="string">'2*aad'</span>);
1570 line([uv.E0_aadmed(1)-2*uv.E0_aadmed(2) uv.E0_aadmed(1)-2*uv.E0_aadmed(2)],<span class="keyword">...</span>
1571     [0 max(f1)],<span class="string">'Color'</span>,col.BoxCPS,<span class="string">'LineStyle'</span>,<span class="string">'--'</span>,<span class="string">'LineWidth'</span>,1,<span class="keyword">...</span>
1572     <span class="string">'Parent'</span>,gui.axes21,<span class="string">'DisplayName'</span>,<span class="string">'2*aad'</span>,<span class="string">'HandleVisibility'</span>,<span class="string">'off'</span>,<span class="keyword">...</span>
1573     <span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1574 
1575 <span class="comment">% median TLGM</span>
1576 line([uv.Tlgm_aadmed(1) uv.Tlgm_aadmed(1)],[0 max(f2)],<span class="string">'Color'</span>,col.BoxCPS,<span class="keyword">...</span>
1577     <span class="string">'LineStyle'</span>,<span class="string">'-'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'Parent'</span>,gui.axes22,<span class="string">'DisplayName'</span>,<span class="string">'median'</span>);
1578 line([uv.Tlgm_aadmed(1)+2*uv.Tlgm_aadmed(2) uv.Tlgm_aadmed(1)+2*uv.Tlgm_aadmed(2)],<span class="keyword">...</span>
1579     [0 max(f2)],<span class="string">'Color'</span>,col.BoxCPS,<span class="string">'LineStyle'</span>,<span class="string">'--'</span>,<span class="string">'LineWidth'</span>,1,<span class="keyword">...</span>
1580     <span class="string">'Parent'</span>,gui.axes22,<span class="string">'DisplayName'</span>,<span class="string">'2*aad'</span>);
1581 line([uv.Tlgm_aadmed(1)-2*uv.Tlgm_aadmed(2) uv.Tlgm_aadmed(1)-2*uv.Tlgm_aadmed(2)],<span class="keyword">...</span>
1582     [0 max(f2)],<span class="string">'Color'</span>,col.BoxCPS,<span class="string">'LineStyle'</span>,<span class="string">'--'</span>,<span class="string">'LineWidth'</span>,1,<span class="keyword">...</span>
1583     <span class="string">'Parent'</span>,gui.axes22,<span class="string">'DisplayName'</span>,<span class="string">'2*aad'</span>,<span class="string">'HandleVisibility'</span>,<span class="string">'off'</span>,<span class="keyword">...</span>
1584     <span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1585 lgh = legend(gui.axes22,<span class="string">'Location'</span>,<span class="string">'NorthWest'</span>);
1586 set(lgh,<span class="string">'EdgeColor'</span>,gui.myui.colors.axisFG,<span class="string">'TextColor'</span>,gui.myui.colors.axisFG);
1587 
1588 <span class="comment">% axes properties</span>
1589 set(get(gui.axes21,<span class="string">'XLabel'</span>),<span class="string">'String'</span>,<span class="string">'E0'</span>);
1590 set(get(gui.axes21,<span class="string">'YLabel'</span>),<span class="string">'String'</span>,<span class="string">'kernel denisty estimate'</span>);
1591 set(get(gui.axes22,<span class="string">'XLabel'</span>),<span class="string">'String'</span>,<span class="string">'TLGM'</span>);
1592 set(get(gui.axes22,<span class="string">'YLabel'</span>),<span class="string">'String'</span>,<span class="string">'kernel density estimate'</span>);
1593 
1594 <span class="comment">% hold off all axes</span>
1595 hold(gui.axes11,<span class="string">'off'</span>);
1596 hold(gui.axes12,<span class="string">'off'</span>);
1597 hold(gui.axes2,<span class="string">'off'</span>);
1598 hold(gui.axes21,<span class="string">'off'</span>);
1599 hold(gui.axes22,<span class="string">'off'</span>);
1600 <span class="keyword">end</span>
1601 
1602 <span class="comment">%% close function</span>
1603 <a name="_sub13" href="#_subfunctions" class="code">function uv_closeme(src,~)</a>
1604 figh = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
1605 <span class="comment">% try to close the sub GUI in a clean manner</span>
1606 <span class="keyword">try</span>
1607     <span class="comment">% NOTE: maybe needed at some later point</span>
1608     <span class="comment">%     gui = getappdata(figh,'gui');</span>
1609     <span class="comment">%     data = getappdata(gui.figh_nucleus,'data');</span>
1610     <span class="comment">%     % update NUCLEUSinv</span>
1611     <span class="comment">%     setappdata(gui.figh_nucleus,'data',data);</span>
1612     delete(figh);
1613 <span class="keyword">catch</span>
1614     <span class="comment">% if this is not working: just close it</span>
1615     delete(figh);
1616 <span class="keyword">end</span>
1617 
1618 <span class="keyword">end</span>
1619 
1620 <span class="comment">%------------- END OF CODE --------------</span>
1621 
1622 <span class="comment">%% License:</span>
1623 <span class="comment">% MIT License</span>
1624 <span class="comment">%</span>
1625 <span class="comment">% Copyright (c) 2024 Thomas Hiller</span>
1626 <span class="comment">%</span>
1627 <span class="comment">% Permission is hereby granted, free of charge, to any person obtaining a copy</span>
1628 <span class="comment">% of this software and associated documentation files (the &quot;Software&quot;), to deal</span>
1629 <span class="comment">% in the Software without restriction, including without limitation the rights</span>
1630 <span class="comment">% to use, copy, modify, merge, publish, distribute, sublicense, and/or sell</span>
1631 <span class="comment">% copies of the Software, and to permit persons to whom the Software is</span>
1632 <span class="comment">% furnished to do so, subject to the following conditions:</span>
1633 <span class="comment">%</span>
1634 <span class="comment">% The above copyright notice and this permission notice shall be included in all</span>
1635 <span class="comment">% copies or substantial portions of the Software.</span>
1636 <span class="comment">%</span>
1637 <span class="comment">% THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
1638 <span class="comment">% IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
1639 <span class="comment">% FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span>
1640 <span class="comment">% AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span>
1641 <span class="comment">% LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span>
1642 <span class="comment">% OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE</span>
1643 <span class="comment">% SOFTWARE.</span></pre></div>
<hr><address>Generated by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>