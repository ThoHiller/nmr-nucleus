<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of UncertView</title>
  <meta name="keywords" content="UncertView">
  <meta name="description" content=" is an extra subGUI to show results of the uncertainty">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- # nucleus --><!-- # functions --><!-- menu.html interface -->
<h1>UncertView
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong> is an extra subGUI to show results of the uncertainty</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function UncertView(src,~) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment">UncertView is an extra subGUI to show results of the uncertainty
calculation

 Syntax:
       UncertView

 Inputs:
       src - handle of the calling object

 Outputs:
       none

 Example:
       UncertView(src,~)

 Other m-files required:
       beautifyAxes
       clearAllAxes
       estimateUncertainty
       createKernelMatrix
       updatePlotsSignal
       updatePlotsDistribution
       updateInfo

 Subfunctions:
       uv_closeme
       uv_onEditValue
       uv_updateMASK
       uv_onPushRun
       uv_onPushUpdate
       uv_onPushReset
       uv_updateInformation
       uv_updatePlots

 MAT-files required:
       none

 See also: NUCLEUSinv
 Author: see AUTHORS.md
 email: see AUTHORS.md
 License: MIT License (at end)</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="beautifyAxes.html" class="code" title="function beautifyAxes(figh)">beautifyAxes</a>	 can be used to globally change the general appearance of axes</li><li><a href="clearAllAxes.html" class="code" title="function clearAllAxes(figh)">clearAllAxes</a>	 clears all axes of a given figure</li><li><a href="getKernelDensityEstimate.html" class="code" title="function [f,x] = getKernelDensityEstimate(y)">getKernelDensityEstimate</a>	 computes the one dimensional kernel density estimate</li><li><a href="minimizePanel.html" class="code" title="function minimizePanel(src,~)">minimizePanel</a>	 handles the minimization/maximization of all box-panels for</li><li><a href="updateInfo.html" class="code" title="function updateInfo(src,~) %#ok<INUSD>">updateInfo</a>	 updates the information shown in all information list boxes</li><li><a href="updatePlotsDistribution.html" class="code" title="function updatePlotsDistribution">updatePlotsDistribution</a>	 plots the RTD and PSD curves into NUCLEUSinv</li><li><a href="updatePlotsSignal.html" class="code" title="function updatePlotsSignal">updatePlotsSignal</a>	 plots the raw and processed NMR signals in NUCLEUSinv</li><li><a href="../../../nucleus/functions/inversion/createKernelMatrix.html" class="code" title="function K = createKernelMatrix(t,T,Tbulk,Tdiff,Tflag,T1IRfac)">createKernelMatrix</a>	 creates a Kernel matrix from signal time vector "t"</li><li><a href="../../../nucleus/functions/inversion/estimateUncertainty.html" class="code" title="function [invstd,uncert] = estimateUncertainty(invtype,invstd,iparam,parameter)">estimateUncertainty</a>	 calculates pseudo uncertainty estimates for multi</li><li><a href="../../../nucleus/functions/inversion/getAAD.html" class="code" title="function aad = getAAD(x,flag,dim)">getAAD</a>	 gets the average absolute deviation from the values in x</li><li><a href="../../../nucleus/functions/inversion/getUncertaintyStatistics.html" class="code" title="function out = getUncertaintyStatistics(T,RTDs,range,K0)">getUncertaintyStatistics</a>	</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="../../../nucleus/callbacks/listboxes/onListboxData.html" class="code" title="function onListboxData(src,~)">onListboxData</a>	 handles the calls from the context menu of the data</li><li><a href="../../../nucleus/callbacks/menus/onMenuSubGUIs.html" class="code" title="function onMenuSubGUIs(src,~)">onMenuSubGUIs</a>	 handles the extra menu entries to open NUCLEUS sub GUIs</li><li><a href="../../../nucleus/functions/inversion/runUncertaintyCalculation.html" class="code" title="function runUncertaintyCalculation">runUncertaintyCalculation</a>	 caluclates inverison statistics in some kind of</li></ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function uv_onEditValue(src,~)</a></li><li><a href="#_sub2" class="code">function uv_onPushSend(src,~)</a></li><li><a href="#_sub3" class="code">function uv_onContextPlotsColor(src,~)</a></li><li><a href="#_sub4" class="code">function uv_onContextPlotsRTD(src,~)</a></li><li><a href="#_sub5" class="code">function data = uv_updateMASK(data)</a></li><li><a href="#_sub6" class="code">function uv_onPopupMethod(src,~)</a></li><li><a href="#_sub7" class="code">function uv_onPushRun(src,~)</a></li><li><a href="#_sub8" class="code">function uv_onPushUpdate(src,~)</a></li><li><a href="#_sub9" class="code">function uv_onPushReset(src,~)</a></li><li><a href="#_sub10" class="code">function uv_updateInformation(figh)</a></li><li><a href="#_sub11" class="code">function uv_updatePlots(figh)</a></li><li><a href="#_sub12" class="code">function uv_closeme(src,~)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function UncertView(src,~)</a>
0002 <span class="comment">%UncertView is an extra subGUI to show results of the uncertainty</span>
0003 <span class="comment">%calculation</span>
0004 <span class="comment">%</span>
0005 <span class="comment">% Syntax:</span>
0006 <span class="comment">%       UncertView</span>
0007 <span class="comment">%</span>
0008 <span class="comment">% Inputs:</span>
0009 <span class="comment">%       src - handle of the calling object</span>
0010 <span class="comment">%</span>
0011 <span class="comment">% Outputs:</span>
0012 <span class="comment">%       none</span>
0013 <span class="comment">%</span>
0014 <span class="comment">% Example:</span>
0015 <span class="comment">%       UncertView(src,~)</span>
0016 <span class="comment">%</span>
0017 <span class="comment">% Other m-files required:</span>
0018 <span class="comment">%       beautifyAxes</span>
0019 <span class="comment">%       clearAllAxes</span>
0020 <span class="comment">%       estimateUncertainty</span>
0021 <span class="comment">%       createKernelMatrix</span>
0022 <span class="comment">%       updatePlotsSignal</span>
0023 <span class="comment">%       updatePlotsDistribution</span>
0024 <span class="comment">%       updateInfo</span>
0025 <span class="comment">%</span>
0026 <span class="comment">% Subfunctions:</span>
0027 <span class="comment">%       uv_closeme</span>
0028 <span class="comment">%       uv_onEditValue</span>
0029 <span class="comment">%       uv_updateMASK</span>
0030 <span class="comment">%       uv_onPushRun</span>
0031 <span class="comment">%       uv_onPushUpdate</span>
0032 <span class="comment">%       uv_onPushReset</span>
0033 <span class="comment">%       uv_updateInformation</span>
0034 <span class="comment">%       uv_updatePlots</span>
0035 <span class="comment">%</span>
0036 <span class="comment">% MAT-files required:</span>
0037 <span class="comment">%       none</span>
0038 <span class="comment">%</span>
0039 <span class="comment">% See also: NUCLEUSinv</span>
0040 <span class="comment">% Author: see AUTHORS.md</span>
0041 <span class="comment">% email: see AUTHORS.md</span>
0042 <span class="comment">% License: MIT License (at end)</span>
0043 
0044 <span class="comment">%------------- BEGIN CODE --------------</span>
0045 
0046 <span class="comment">%% get GUI handle and data</span>
0047 figh_nucleus = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
0048 nucleus.data = getappdata(figh_nucleus,<span class="string">'data'</span>);
0049 nucleus.gui = getappdata(figh_nucleus,<span class="string">'gui'</span>);
0050 myui = nucleus.gui.myui;
0051 colors = myui.colors;
0052 
0053 hasUncert = false;
0054 <span class="keyword">if</span> isfield(nucleus.data.results,<span class="string">'invstd'</span>)
0055     <span class="keyword">if</span> isfield(nucleus.data.results.invstd,<span class="string">'uncert'</span>)
0056         hasUncert = true;
0057     <span class="keyword">end</span>
0058 <span class="keyword">end</span>
0059 
0060 <span class="comment">%% proceed only if there is already uncertainty data</span>
0061 <span class="keyword">if</span> hasUncert
0062     nucleus_data = nucleus.data;
0063 
0064     <span class="comment">% check if the figure is already open</span>
0065     fig_uncert = findobj(<span class="string">'Tag'</span>,<span class="string">'UNCERTVIEW'</span>);
0066     <span class="comment">% if not, create it</span>
0067     <span class="keyword">if</span> isempty(fig_uncert)
0068         <span class="comment">% draw the figure on top of NUCLEUSinv</span>
0069         fig_uncert = figure(<span class="string">'Name'</span>,<span class="string">'NUCLEUSinv - RTD Uncertainty'</span>,<span class="keyword">...</span>
0070             <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>,<span class="string">'Resize'</span>,<span class="string">'on'</span>,<span class="string">'ToolBar'</span>,<span class="string">'none'</span>,<span class="keyword">...</span>
0071             <span class="string">'CloseRequestFcn'</span>,@<a href="#_sub12" class="code" title="subfunction uv_closeme(src,~)">uv_closeme</a>,<span class="keyword">...</span>
0072             <span class="string">'MenuBar'</span>,<span class="string">'figure'</span>,<span class="string">'Tag'</span>,<span class="string">'UNCERTVIEW'</span>);
0073         pos0 = get(figh_nucleus,<span class="string">'Position'</span>);
0074         cent(1) = (pos0(1)+pos0(3)/2);
0075         cent(2) = (pos0(2)+pos0(4)/2);
0076         posf = [cent(1)-pos0(3)/3 pos0(2)+22 pos0(3)/1.5 pos0(4)-22];
0077         <span class="comment">%         posf = [cent(1)-pos0(3)/6 pos0(2)+pos0(4)-140 350 145];</span>
0078         set(fig_uncert,<span class="string">'Position'</span>,posf);
0079 
0080         <span class="comment">% create the main layout</span>
0081         gui.main = uix.HBox(<span class="string">'Parent'</span>,fig_uncert,<span class="string">'BackGroundColor'</span>,colors.panelBG,<span class="keyword">...</span>
0082             <span class="string">'Spacing'</span>,5,<span class="string">'Padding'</span>,5,<span class="string">'Visible'</span>,<span class="string">'off'</span>);
0083         gui.left = uix.VBox(<span class="string">'Parent'</span>,gui.main,<span class="string">'BackGroundColor'</span>,colors.panelBG,<span class="keyword">...</span>
0084             <span class="string">'Spacing'</span>,5,<span class="string">'Padding'</span>,0); <span class="comment">% controls</span>
0085         gui.right = uix.VBox(<span class="string">'Parent'</span>,gui.main,<span class="string">'BackGroundColor'</span>,colors.panelBG,<span class="keyword">...</span>
0086             <span class="string">'Spacing'</span>,5,<span class="string">'Padding'</span>,0); <span class="comment">% plots</span>
0087 
0088         set(gui.main,<span class="string">'Widths'</span>,[300 -1 ]);
0089 
0090         <span class="comment">% waitbar indicating the loading of the GUI</span>
0091         steps = 5;
0092         hwb = waitbar(0,<span class="string">'loading ...'</span>,<span class="string">'Name'</span>,<span class="string">'UncertView initialization'</span>,<span class="string">'Visible'</span>,<span class="string">'off'</span>);
0093         set(hwb,<span class="string">'Units'</span>,<span class="string">'Pixel'</span>)
0094         posw = get(hwb,<span class="string">'Position'</span>);
0095         set(hwb,<span class="string">'Position'</span>,[posf(1)+posf(3)/2-posw(3)/2 posf(2)+posf(4)/2-posw(4)/2 posw(3:4)]);
0096         set(hwb,<span class="string">'Visible'</span>,<span class="string">'on'</span>);
0097 
0098         <span class="comment">% --- control panel ---</span>
0099         waitbar(1/steps,hwb,<span class="string">'loading GUI elements - control'</span>);
0100         gui.panels.control.main = uix.BoxPanel(<span class="string">'Parent'</span>,gui.left,<span class="keyword">...</span>
0101             <span class="string">'Title'</span>,<span class="string">'Recalculate RTD Uncertainty'</span>,<span class="string">'MinimizeFcn'</span>,@<a href="minimizePanel.html" class="code" title="function minimizePanel(src,~)">minimizePanel</a>,<span class="keyword">...</span>
0102             <span class="string">'TitleColor'</span>,colors.BoxINV,<span class="string">'ForegroundColor'</span>,colors.BoxTitle);
0103         gui.panels.control.VBox = uix.VBox(<span class="string">'Parent'</span>,gui.panels.control.main,<span class="keyword">...</span>
0104             <span class="string">'Spacing'</span>,3,<span class="string">'Padding'</span>,3);
0105         <span class="comment">% uncertainty method</span>
0106         gui.panels.control.HBox1 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.control.VBox,<span class="keyword">...</span>
0107             <span class="string">'Spacing'</span>,3);
0108         gui.text_handles.uncertMethod = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox1,<span class="keyword">...</span>
0109             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0110             <span class="string">'String'</span>,<span class="string">'Method'</span>);
0111         tstr = [<span class="string">'&lt;HTML&gt;Choose the uncertainty calculation method.&lt;br&gt;&lt;br&gt;'</span>,<span class="keyword">...</span>
0112             <span class="string">'&lt;u&gt;Available options:&lt;/u&gt;&lt;br&gt;'</span>,<span class="keyword">...</span>
0113             <span class="string">'&lt;font color=&quot;red&quot;&gt;Multi exp. (LSQ) | Multi exp. (LU decomp.):&lt;br&gt;'</span>,<span class="keyword">...</span>
0114             <span class="string">'&lt;font color=&quot;black&quot;&gt;'</span>,<span class="keyword">...</span>
0115             <span class="string">'&lt;b&gt;RMS - unbounded&lt;/b&gt; Keep all uncert models.&lt;br&gt;'</span>,<span class="keyword">...</span>
0116             <span class="string">'&lt;b&gt;RMS - bounded&lt;/b&gt; Only keep models within Lm and chi2 bounds.&lt;br&gt;'</span>,<span class="keyword">...</span>
0117             <span class="string">'&lt;font color=&quot;red&quot;&gt;Multi modal:&lt;br&gt;'</span>,<span class="keyword">...</span>
0118             <span class="string">'&lt;font color=&quot;black&quot;&gt;'</span>,<span class="keyword">...</span>
0119             <span class="string">'&lt;b&gt;RMS - unbounded&lt;/b&gt; Keep all uncert models.&lt;br&gt;'</span>,<span class="keyword">...</span>
0120             <span class="string">'&lt;b&gt;RMS - bounded&lt;/b&gt; Only keep models within Lm and chi2 bounds.&lt;br&gt;'</span>,<span class="keyword">...</span>
0121             <span class="string">'&lt;b&gt;Threshold&lt;/b&gt; Vary fit parameter by threshold.&lt;br&gt;'</span>,<span class="keyword">...</span>
0122             <span class="string">'&lt;b&gt;Conf. Interval&lt;/b&gt; Vary fit parameter randomly within confidence interval.&lt;br&gt;&lt;br&gt;'</span>,<span class="keyword">...</span>
0123             <span class="string">'&lt;u&gt;Default value:&lt;/u&gt;&lt;br&gt;'</span>,<span class="keyword">...</span>
0124             <span class="string">'&lt;b&gt;RMS - bounded&lt;/b&gt;&lt;br&gt;'</span>];
0125         gui.popup_handles.uncertMethod = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox1,<span class="keyword">...</span>
0126             <span class="string">'Style'</span>,<span class="string">'popup'</span>,<span class="string">'String'</span>,{<span class="string">'RMS - unbounded'</span>,<span class="string">'RMS - bounded'</span>},<span class="keyword">...</span>
0127             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0128             <span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'control'</span>,<span class="string">'Callback'</span>,@<a href="#_sub6" class="code" title="subfunction uv_onPopupMethod(src,~)">uv_onPopupMethod</a>);
0129         set(gui.panels.control.HBox1,<span class="string">'Widths'</span>,[150 -1]);
0130         <span class="comment">% number of uncertainty models</span>
0131         gui.panels.control.HBox2 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.control.VBox,<span class="keyword">...</span>
0132             <span class="string">'Spacing'</span>,3);        
0133         gui.text_handles.uncertN = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox2,<span class="keyword">...</span>
0134             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0135             <span class="string">'String'</span>,<span class="string">'#models'</span>);
0136         uix.Empty(<span class="string">'Parent'</span>,gui.panels.control.HBox2);
0137         tstr = <span class="string">'Number of uncertainty models to calculate.'</span>;
0138         gui.edit_handles.uncertN = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox2,<span class="keyword">...</span>
0139             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'uncertN'</span>,<span class="keyword">...</span>
0140             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0141             <span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0142         set(gui.panels.control.HBox2,<span class="string">'Widths'</span>,[150 -1 -1]);
0143         <span class="comment">% bound1: chi2 range</span>
0144         gui.panels.control.HBox3 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.control.VBox,<span class="keyword">...</span>
0145             <span class="string">'Spacing'</span>,3);
0146         gui.text_handles.uncertchi2 = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox3,<span class="keyword">...</span>
0147             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0148             <span class="string">'String'</span>,[char(hex2dec(<span class="string">'03A7'</span>)),char(hex2dec(<span class="string">'00B2'</span>)),<span class="keyword">...</span>
0149             <span class="string">' range          min | max'</span>]);
0150         tstr = <span class="string">'Lower bound of chi2 range.'</span>;
0151         gui.edit_handles.uncertchi2_min = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox3,<span class="keyword">...</span>
0152             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'control'</span>,<span class="keyword">...</span>
0153             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0154             <span class="string">'Enable'</span>,<span class="string">'off'</span>,<span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0155         tstr = <span class="string">'Upper bound of chi2 range.'</span>;
0156         gui.edit_handles.uncertchi2_max = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox3,<span class="keyword">...</span>
0157             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'control'</span>,<span class="keyword">...</span>
0158             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0159             <span class="string">'Enable'</span>,<span class="string">'off'</span>,<span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0160         set(gui.panels.control.HBox3,<span class="string">'Widths'</span>,[150 -1 -1]);
0161         <span class="comment">% bound2: model norm range</span>
0162         gui.panels.control.HBox4 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.control.VBox,<span class="keyword">...</span>
0163             <span class="string">'Spacing'</span>,3);
0164         gui.text_handles.uncertmnorm = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox4,<span class="keyword">...</span>
0165             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0166             <span class="string">'String'</span>,[<span class="string">'|Lm|'</span>,char(hex2dec(<span class="string">'2082'</span>)),<span class="string">' range      min | max'</span>]);
0167         tstr = <span class="string">'Lower bound of model norm range.'</span>;
0168         gui.edit_handles.uncertmnorm_min = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox4,<span class="keyword">...</span>
0169             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'control'</span>,<span class="keyword">...</span>
0170             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0171             <span class="string">'Enable'</span>,<span class="string">'off'</span>,<span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0172         tstr = <span class="string">'Upper bound of model norm range.'</span>;
0173         gui.edit_handles.uncertmnorm_max = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox4,<span class="keyword">...</span>
0174             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'control'</span>,<span class="keyword">...</span>
0175             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0176             <span class="string">'Enable'</span>,<span class="string">'off'</span>,<span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0177         set(gui.panels.control.HBox4,<span class="string">'Widths'</span>,[150 -1 -1]);
0178         <span class="comment">% bound3: threshold</span>
0179         gui.panels.control.HBox5 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.control.VBox,<span class="keyword">...</span>
0180             <span class="string">'Spacing'</span>,3);
0181         gui.text_handles.uncertThresh = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox5,<span class="keyword">...</span>
0182             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0183             <span class="string">'String'</span>,<span class="string">'Threshold'</span>);
0184         uix.Empty(<span class="string">'Parent'</span>,gui.panels.control.HBox5);
0185         tstr = <span class="string">'Threshold value (0.05 = 5%).'</span>;
0186         gui.edit_handles.uncertThresh = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox5,<span class="keyword">...</span>
0187             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'uncertThresh'</span>,<span class="keyword">...</span>
0188             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0189             <span class="string">'Enable'</span>,<span class="string">'off'</span>,<span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0190         set(gui.panels.control.HBox5,<span class="string">'Widths'</span>,[150 -1 -1]);
0191         <span class="comment">% max tries</span>
0192         gui.panels.control.HBox6 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.control.VBox,<span class="keyword">...</span>
0193             <span class="string">'Spacing'</span>,3);
0194         gui.text_handles.uncertMax = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox6,<span class="keyword">...</span>
0195             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0196             <span class="string">'String'</span>,<span class="string">'Max. #tries'</span>);
0197         uix.Empty(<span class="string">'Parent'</span>,gui.panels.control.HBox6);
0198         tstr = <span class="string">'Maximum number of unsuccesful tries.'</span>;
0199         gui.edit_handles.uncertMax = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox6,<span class="keyword">...</span>
0200             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'uncertMax'</span>,<span class="keyword">...</span>
0201             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0202             <span class="string">'Enable'</span>,<span class="string">'off'</span>,<span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0203         set(gui.panels.control.HBox6,<span class="string">'Widths'</span>,[150 -1 -1]);
0204         <span class="comment">% RUN button</span>
0205         gui.panels.control.HBox7 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.control.VBox,<span class="keyword">...</span>
0206             <span class="string">'Spacing'</span>,3);
0207         uix.Empty(<span class="string">'Parent'</span>,gui.panels.control.HBox7);
0208         uix.Empty(<span class="string">'Parent'</span>,gui.panels.control.HBox7);
0209         tstr = [<span class="string">'&lt;HTML&gt;RUN uncertainty calculation.&lt;br&gt;'</span>,<span class="keyword">...</span>
0210             <span class="string">'Regularization is the same as in main NUCLEUSinv GUI.'</span>];
0211         gui.push_handles.reset = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox7,<span class="keyword">...</span>
0212             <span class="string">'String'</span>,<span class="string">'RUN'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'process'</span>,<span class="keyword">...</span>
0213             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0214             <span class="string">'BackGroundColor'</span>,<span class="string">'g'</span>,<span class="string">'Callback'</span>,@<a href="#_sub7" class="code" title="subfunction uv_onPushRun(src,~)">uv_onPushRun</a>);
0215         set(gui.panels.control.HBox7,<span class="string">'Widths'</span>,[150 -1 -1]);
0216 
0217         <span class="comment">% --- process panel ---</span>
0218         waitbar(2/steps,hwb,<span class="string">'loading GUI elements - process'</span>);
0219         gui.panels.process.main = uix.BoxPanel(<span class="string">'Parent'</span>,gui.left,<span class="keyword">...</span>
0220             <span class="string">'Title'</span>,<span class="string">'Process Uncertainty Runs'</span>,<span class="string">'MinimizeFcn'</span>,@<a href="minimizePanel.html" class="code" title="function minimizePanel(src,~)">minimizePanel</a>,<span class="keyword">...</span>
0221             <span class="string">'TitleColor'</span>,colors.BoxINV,<span class="string">'ForegroundColor'</span>,colors.BoxTitle);
0222         gui.panels.process.VBox = uix.VBox(<span class="string">'Parent'</span>,gui.panels.process.main,<span class="keyword">...</span>
0223             <span class="string">'Spacing'</span>,3,<span class="string">'Padding'</span>,3);
0224         <span class="comment">% chi2 range</span>
0225         gui.panels.process.HBox1 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.process.VBox,<span class="keyword">...</span>
0226             <span class="string">'Spacing'</span>,3);
0227         gui.text_handles.chi2 = uicontrol(<span class="string">'Parent'</span>,gui.panels.process.HBox1,<span class="keyword">...</span>
0228             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0229             <span class="string">'String'</span>,[char(hex2dec(<span class="string">'03A7'</span>)),char(hex2dec(<span class="string">'00B2'</span>)),<span class="keyword">...</span>
0230             <span class="string">' range          min | max'</span>]);
0231         tstr = <span class="string">'Lower bound of chi2 range.'</span>;
0232         gui.edit_handles.chi2_min = uicontrol(<span class="string">'Parent'</span>,gui.panels.process.HBox1,<span class="keyword">...</span>
0233             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'process'</span>,<span class="keyword">...</span>
0234             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0235             <span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0236         tstr = <span class="string">'Upper bound of chi2 range.'</span>;
0237         gui.edit_handles.chi2_max = uicontrol(<span class="string">'Parent'</span>,gui.panels.process.HBox1,<span class="keyword">...</span>
0238             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'2'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'process'</span>,<span class="keyword">...</span>
0239             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0240             <span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0241         set(gui.panels.process.HBox1,<span class="string">'Widths'</span>,[150 -1 -1]);
0242         <span class="comment">% model norm range</span>
0243         gui.panels.process.HBox2 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.process.VBox,<span class="keyword">...</span>
0244             <span class="string">'Spacing'</span>,3);
0245         gui.text_handles.mnorm = uicontrol(<span class="string">'Parent'</span>,gui.panels.process.HBox2,<span class="keyword">...</span>
0246             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0247             <span class="string">'String'</span>,[<span class="string">'|Lm|'</span>,char(hex2dec(<span class="string">'2082'</span>)),<span class="string">' range      min | max'</span>]);
0248         tstr = <span class="string">'Lower bound of model norm range.'</span>;
0249         gui.edit_handles.mnorm_min = uicontrol(<span class="string">'Parent'</span>,gui.panels.process.HBox2,<span class="keyword">...</span>
0250             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'process'</span>,<span class="keyword">...</span>
0251             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0252             <span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0253         tstr = <span class="string">'Upper bound of model norm range.'</span>;
0254         gui.edit_handles.mnorm_max = uicontrol(<span class="string">'Parent'</span>,gui.panels.process.HBox2,<span class="keyword">...</span>
0255             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'2'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'process'</span>,<span class="keyword">...</span>
0256             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0257             <span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0258         set(gui.panels.process.HBox2,<span class="string">'Widths'</span>,[150 -1 -1]);
0259         <span class="comment">% RESET button</span>
0260         gui.panels.process.HBox3 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.process.VBox,<span class="keyword">...</span>
0261             <span class="string">'Spacing'</span>,3);
0262         uix.Empty(<span class="string">'Parent'</span>,gui.panels.process.HBox3);
0263         tstr = <span class="string">'SEND bounds to recaluclation panel above.'</span>;
0264         gui.push_handles.send = uicontrol(<span class="string">'Parent'</span>,gui.panels.process.HBox3,<span class="keyword">...</span>
0265             <span class="string">'String'</span>,<span class="string">'SEND'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'process'</span>,<span class="keyword">...</span>
0266             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0267             <span class="string">'Callback'</span>,@<a href="#_sub2" class="code" title="subfunction uv_onPushSend(src,~)">uv_onPushSend</a>);
0268         tstr = <span class="string">'RESET processing bounds and plots.'</span>;
0269         gui.push_handles.reset = uicontrol(<span class="string">'Parent'</span>,gui.panels.process.HBox3,<span class="keyword">...</span>
0270             <span class="string">'String'</span>,<span class="string">'RESET'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'process'</span>,<span class="keyword">...</span>
0271             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0272             <span class="string">'Callback'</span>,@<a href="#_sub9" class="code" title="subfunction uv_onPushReset(src,~)">uv_onPushReset</a>);
0273         set(gui.panels.process.HBox3,<span class="string">'Widths'</span>,[150 -1 -1]);
0274 
0275         <span class="comment">% --- RTD panel ---</span>
0276         waitbar(3/steps,hwb,<span class="string">'loading GUI elements - RTD bounds'</span>);
0277         gui.panels.rtd.main = uix.BoxPanel(<span class="string">'Parent'</span>,gui.left,<span class="keyword">...</span>
0278             <span class="string">'Title'</span>,<span class="string">'RTD Calculation Bounds'</span>,<span class="string">'MinimizeFcn'</span>,@<a href="minimizePanel.html" class="code" title="function minimizePanel(src,~)">minimizePanel</a>,<span class="keyword">...</span>
0279             <span class="string">'TitleColor'</span>,colors.BoxINV,<span class="string">'ForegroundColor'</span>,colors.BoxTitle);
0280         gui.panels.rtd.VBox = uix.VBox(<span class="string">'Parent'</span>,gui.panels.rtd.main,<span class="keyword">...</span>
0281             <span class="string">'Spacing'</span>,3,<span class="string">'Padding'</span>,3);
0282         <span class="comment">% RTD range</span>
0283         gui.panels.rtd.HBox1 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.rtd.VBox,<span class="keyword">...</span>
0284             <span class="string">'Spacing'</span>,3);
0285         gui.text_handles.rtd = uicontrol(<span class="string">'Parent'</span>,gui.panels.rtd.HBox1,<span class="keyword">...</span>
0286             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0287             <span class="string">'String'</span>,<span class="string">'RTD range       min | max'</span>);
0288         tstr = [<span class="string">'&lt;HTML&gt;Minimum relaxation time in RTDs used&lt;br&gt;'</span>,<span class="keyword">...</span>
0289             <span class="string">'for calculating statistics on E0 &amp; TLGM.'</span>];
0290         gui.edit_handles.rtd_min = uicontrol(<span class="string">'Parent'</span>,gui.panels.rtd.HBox1,<span class="keyword">...</span>
0291             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'rtd'</span>,<span class="keyword">...</span>
0292             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0293             <span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0294         tstr = [<span class="string">'&lt;HTML&gt;Maximum relaxation time in RTDs used&lt;br&gt;'</span>,<span class="keyword">...</span>
0295             <span class="string">'for calculating statistics on E0 &amp; TLGM.'</span>];
0296         gui.edit_handles.rtd_max = uicontrol(<span class="string">'Parent'</span>,gui.panels.rtd.HBox1,<span class="keyword">...</span>
0297             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'2'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'rtd'</span>,<span class="keyword">...</span>
0298             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0299             <span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0300         set(gui.panels.rtd.HBox1,<span class="string">'Widths'</span>,[150 -1 -1]);
0301         <span class="comment">% RESET button</span>
0302         gui.panels.rtd.HBox3 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.rtd.VBox,<span class="keyword">...</span>
0303             <span class="string">'Spacing'</span>,3);
0304         uix.Empty(<span class="string">'Parent'</span>,gui.panels.rtd.HBox3);
0305         uix.Empty(<span class="string">'Parent'</span>,gui.panels.rtd.HBox3);
0306         tstr = <span class="string">'RESET RTDs calculation bounds.'</span>;
0307         gui.push_handles.reset_rtd = uicontrol(<span class="string">'Parent'</span>,gui.panels.rtd.HBox3,<span class="keyword">...</span>
0308             <span class="string">'String'</span>,<span class="string">'RESET'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'rtd'</span>,<span class="keyword">...</span>
0309             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0310             <span class="string">'Callback'</span>,@<a href="#_sub9" class="code" title="subfunction uv_onPushReset(src,~)">uv_onPushReset</a>);
0311         set(gui.panels.rtd.HBox3,<span class="string">'Widths'</span>,[150 -1 -1]);
0312 
0313         <span class="comment">% --- Statistics panel ---</span>
0314         waitbar(4/steps,hwb,<span class="string">'loading GUI elements - statistics'</span>);
0315         gui.panels.info.main = uix.BoxPanel(<span class="string">'Parent'</span>,gui.left,<span class="keyword">...</span>
0316             <span class="string">'Title'</span>,<span class="string">'Uncertainty Statistics'</span>,<span class="string">'MinimizeFcn'</span>,@<a href="minimizePanel.html" class="code" title="function minimizePanel(src,~)">minimizePanel</a>,<span class="keyword">...</span>
0317             <span class="string">'TitleColor'</span>,colors.BoxINV,<span class="string">'ForegroundColor'</span>,colors.BoxTitle);
0318         gui.panels.info.VBox = uix.VBox(<span class="string">'Parent'</span>,gui.panels.info.main,<span class="keyword">...</span>
0319             <span class="string">'Spacing'</span>,3,<span class="string">'Padding'</span>,3);
0320         <span class="comment">% mean TLGM</span>
0321         gui.panels.info.HBox1 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.info.VBox,<span class="keyword">...</span>
0322             <span class="string">'Spacing'</span>,3);
0323         gui.text_handles.TLGM = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox1,<span class="keyword">...</span>
0324             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0325             <span class="string">'String'</span>,<span class="string">'TLGM            mean | std'</span>);
0326         tstr = <span class="string">'MEAN of all TLGM values.'</span>;
0327         gui.edit_handles.TLGM_mean = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox1,<span class="keyword">...</span>
0328             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="keyword">...</span>
0329             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0330             <span class="string">'BackgroundColor'</span>,colors.BoxPRC);
0331         tstr = <span class="string">'STD of all TLGM values.'</span>;
0332         gui.edit_handles.TLGM_std = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox1,<span class="keyword">...</span>
0333             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'2'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="keyword">...</span>
0334             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0335             <span class="string">'BackgroundColor'</span>,colors.BoxPRC);
0336         set(gui.panels.info.HBox1,<span class="string">'Widths'</span>,[150 -1 -1]);
0337         <span class="comment">% aad TLGM</span>
0338         gui.panels.info.HBox2 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.info.VBox,<span class="keyword">...</span>
0339             <span class="string">'Spacing'</span>,3);
0340         gui.text_handles.TLGM_aad = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox2,<span class="keyword">...</span>
0341             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0342             <span class="string">'String'</span>,<span class="string">'TLGM            aad(mean)'</span>);
0343         uix.Empty(<span class="string">'Parent'</span>,gui.panels.info.HBox2);
0344         tstr = <span class="string">'AAD (average absolute deviation from mean) of all TLGM values.'</span>;
0345         gui.edit_handles.TLGM_aad = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox2,<span class="keyword">...</span>
0346             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0347             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'2'</span>,<span class="string">'FontSize'</span>,myui.fontsize);
0348         set(gui.panels.info.HBox2,<span class="string">'Widths'</span>,[150 -1 -1]);
0349         <span class="comment">% median TLGM</span>
0350         gui.panels.info.HBox3 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.info.VBox,<span class="keyword">...</span>
0351             <span class="string">'Spacing'</span>,3);
0352         gui.text_handles.TLGM_med = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox3,<span class="keyword">...</span>
0353             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0354             <span class="string">'String'</span>,<span class="string">'TLGM median | aad(med)'</span>);
0355         tstr = <span class="string">'MEDIAN of all TLGM values.'</span>;
0356         gui.edit_handles.TLGM_med = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox3,<span class="keyword">...</span>
0357             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="keyword">...</span>
0358             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0359             <span class="string">'BackgroundColor'</span>,colors.BoxCPS);
0360         tstr = <span class="string">'AAD (average absolute deviation from median) of all TLGM values.'</span>;
0361         gui.edit_handles.TLGM_aadmed = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox3,<span class="keyword">...</span>
0362             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'2'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="keyword">...</span>
0363             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0364             <span class="string">'BackgroundColor'</span>,colors.BoxCPS);
0365         set(gui.panels.info.HBox3,<span class="string">'Widths'</span>,[150 -1 -1]);
0366         <span class="comment">% mean E0</span>
0367         gui.panels.info.HBox4 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.info.VBox,<span class="keyword">...</span>
0368             <span class="string">'Spacing'</span>,3);
0369         gui.text_handles.E0 = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox4,<span class="keyword">...</span>
0370             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0371             <span class="string">'String'</span>,<span class="string">'E0                mean | std'</span>);
0372         tstr = <span class="string">'MEAN of all E0 values.'</span>;
0373         gui.edit_handles.E0_mean = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox4,<span class="keyword">...</span>
0374             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="keyword">...</span>
0375             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0376             <span class="string">'BackgroundColor'</span>,colors.BoxPRC);
0377         tstr = <span class="string">'STD of all E0 values.'</span>;
0378         gui.edit_handles.E0_std = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox4,<span class="keyword">...</span>
0379             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'2'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="keyword">...</span>
0380             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0381             <span class="string">'BackgroundColor'</span>,colors.BoxPRC);
0382         set(gui.panels.info.HBox4,<span class="string">'Widths'</span>,[150 -1 -1]);
0383         <span class="comment">% aad E0</span>
0384         gui.panels.info.HBox5 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.info.VBox,<span class="keyword">...</span>
0385             <span class="string">'Spacing'</span>,3);
0386         gui.text_handles.E0_aad = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox5,<span class="keyword">...</span>
0387             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0388             <span class="string">'String'</span>,<span class="string">'E0                aad(mean)'</span>);
0389         uix.Empty(<span class="string">'Parent'</span>,gui.panels.info.HBox5);
0390         tstr = <span class="string">'AAD (average absolute deviation from mean) of all E0 values.'</span>;
0391         gui.edit_handles.E0_aad = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox5,<span class="keyword">...</span>
0392             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0393             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'2'</span>,<span class="string">'FontSize'</span>,myui.fontsize);
0394         set(gui.panels.info.HBox5,<span class="string">'Widths'</span>,[150 -1 -1]);
0395         <span class="comment">% median E0</span>
0396         gui.panels.info.HBox6 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.info.VBox,<span class="keyword">...</span>
0397             <span class="string">'Spacing'</span>,3);
0398         gui.text_handles.E0_med = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox6,<span class="keyword">...</span>
0399             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0400             <span class="string">'String'</span>,<span class="string">'E0     median | aad(med)'</span>);
0401         tstr = <span class="string">'MEDIAN of all E0 values.'</span>;
0402         gui.edit_handles.E0_med = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox6,<span class="keyword">...</span>
0403             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="keyword">...</span>
0404             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0405             <span class="string">'BackgroundColor'</span>,colors.BoxCPS);
0406         tstr = <span class="string">'AAD (average absolute deviation from median) of all E0 values.'</span>;
0407         gui.edit_handles.E0_aadmed = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox6,<span class="keyword">...</span>
0408             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'2'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="keyword">...</span>
0409             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0410             <span class="string">'BackgroundColor'</span>,colors.BoxCPS);
0411         set(gui.panels.info.HBox6,<span class="string">'Widths'</span>,[150 -1 -1]);
0412 
0413         <span class="comment">% --- update MAIN GUI button ---</span>
0414         tstr = <span class="string">'UPDATE uncertainty data in main NUCLEUSinv GUI.'</span>;
0415         gui.push_handles.update = uicontrol(<span class="string">'Parent'</span>,gui.left,<span class="keyword">...</span>
0416             <span class="string">'String'</span>,<span class="string">'UPDATE MAIN GUI'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'update'</span>,<span class="keyword">...</span>
0417             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0418             <span class="string">'Callback'</span>,@<a href="#_sub8" class="code" title="subfunction uv_onPushUpdate(src,~)">uv_onPushUpdate</a>);
0419 
0420         <span class="comment">% fix text vertical alignment</span>
0421         jh = findjobj(gui.text_handles.uncertMethod);
0422         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0423         jh = findjobj(gui.text_handles.uncertN);
0424         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0425         jh = findjobj(gui.text_handles.uncertchi2);
0426         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0427         jh = findjobj(gui.text_handles.uncertmnorm);
0428         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0429         jh = findjobj(gui.text_handles.uncertThresh);
0430         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0431         jh = findjobj(gui.text_handles.uncertMax);
0432         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0433         jh = findjobj(gui.text_handles.chi2);
0434         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0435         jh = findjobj(gui.text_handles.mnorm);
0436         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0437         jh = findjobj(gui.text_handles.rtd);
0438         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0439         jh = findjobj(gui.text_handles.TLGM);
0440         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0441         jh = findjobj(gui.text_handles.TLGM_aad);
0442         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0443         jh = findjobj(gui.text_handles.TLGM_med);
0444         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0445         jh = findjobj(gui.text_handles.E0);
0446         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0447         jh = findjobj(gui.text_handles.E0_aad);
0448         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0449         jh = findjobj(gui.text_handles.E0_med);
0450         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0451 
0452         <span class="comment">% empty space at bottom of left side</span>
0453         uix.Empty(<span class="string">'Parent'</span>,gui.left);
0454         <span class="comment">% adjust the heights of all left-column-panels</span>
0455         heights = [22 22 22 22 28 -1; 22+7*24+9*3 22+3*24+5*3 22+2*24+4*4 22+6*24+8*3 28 -1];
0456         <span class="comment">% panel header is always 22 high</span>
0457         set(gui.left,<span class="string">'Heights'</span>,heights(2,:),<span class="keyword">...</span>
0458             <span class="string">'MinimumHeights'</span>,[22 22 22 22 28 0]);        
0459 
0460         <span class="comment">% --- plot boxes ---</span>
0461         waitbar(5/steps,hwb,<span class="string">'loading GUI elements - graphics'</span>);
0462         gui.rightPanel = uix.TabPanel(<span class="string">'Parent'</span>,gui.right,<span class="keyword">...</span>
0463             <span class="string">'BackGroundColor'</span>,colors.panelBG);
0464         <span class="comment">% -- tab1</span>
0465         gui.righttop1 = uix.HBox(<span class="string">'Parent'</span>,gui.rightPanel,<span class="keyword">...</span>
0466             <span class="string">'BackGroundColor'</span>,colors.panelBG,<span class="string">'Spacing'</span>,5);
0467         gui.pbox11 = uicontainer(<span class="string">'Parent'</span>,gui.righttop1,<span class="keyword">...</span>
0468             <span class="string">'BackGroundColor'</span>,colors.panelBG);
0469         gui.pbox12 = uicontainer(<span class="string">'Parent'</span>,gui.righttop1,<span class="keyword">...</span>
0470             <span class="string">'BackGroundColor'</span>,colors.panelBG);
0471         set(gui.righttop1,<span class="string">'Widths'</span>,[-1 -1 ]);
0472         gui.rightbot = uix.HBox(<span class="string">'Parent'</span>,gui.right,<span class="keyword">...</span>
0473             <span class="string">'BackGroundColor'</span>,colors.panelBG,<span class="string">'Spacing'</span>,5);
0474         gui.pbox2 = uicontainer(<span class="string">'Parent'</span>,gui.rightbot,<span class="keyword">...</span>
0475             <span class="string">'BackGroundColor'</span>,colors.panelBG);
0476 
0477         <span class="comment">% -- tab2</span>
0478         gui.righttop2 = uix.HBox(<span class="string">'Parent'</span>,gui.rightPanel,<span class="keyword">...</span>
0479             <span class="string">'BackGroundColor'</span>,colors.panelBG,<span class="string">'Spacing'</span>,5);
0480         gui.pbox21 = uicontainer(<span class="string">'Parent'</span>,gui.righttop2,<span class="keyword">...</span>
0481             <span class="string">'BackGroundColor'</span>,colors.panelBG);
0482         gui.pbox22 = uicontainer(<span class="string">'Parent'</span>,gui.righttop2,<span class="keyword">...</span>
0483             <span class="string">'BackGroundColor'</span>,colors.panelBG);
0484         set(gui.righttop2,<span class="string">'Widths'</span>,[-1 -1 ]);
0485 
0486         gui.rightPanel.TabTitles = {<span class="string">'Statistics'</span>,<span class="string">'Histograms'</span>};
0487         gui.rightPanel.TabWidth = 75;
0488         gui.rightPanel.TabEnables = {<span class="string">'on'</span>,<span class="string">'on'</span>};
0489 
0490         <span class="comment">% -- plot axes --</span>
0491         gui.axes11 = axes(<span class="string">'Parent'</span>,gui.pbox12,<span class="string">'Box'</span>,<span class="string">'on'</span>);
0492         gui.axes12 = axes(<span class="string">'Parent'</span>,gui.pbox11,<span class="string">'Box'</span>,<span class="string">'on'</span>);
0493         gui.axes2 = axes(<span class="string">'Parent'</span>,gui.pbox2,<span class="string">'Box'</span>,<span class="string">'on'</span>);
0494         gui.axes21 = axes(<span class="string">'Parent'</span>,gui.pbox21,<span class="string">'Box'</span>,<span class="string">'on'</span>);
0495         gui.axes22 = axes(<span class="string">'Parent'</span>,gui.pbox22,<span class="string">'Box'</span>,<span class="string">'on'</span>);
0496 
0497         <span class="comment">% the chi2 vs. xn plot has a context menu</span>
0498         gui.cm_handles.axes_chi2 = uicontextmenu(fig_uncert);
0499         gui.cm_handles.axes_color = uimenu(gui.cm_handles.axes_chi2,<span class="keyword">...</span>
0500             <span class="string">'Label'</span>,<span class="string">'color by'</span>);
0501         gui.cm_handles.axes_color_none = uimenu(gui.cm_handles.axes_color,<span class="keyword">...</span>
0502             <span class="string">'Label'</span>,<span class="string">'none'</span>,<span class="string">'Tag'</span>,<span class="string">'none'</span>,<span class="string">'Checked'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0503             <span class="string">'Callback'</span>,@<a href="#_sub3" class="code" title="subfunction uv_onContextPlotsColor(src,~)">uv_onContextPlotsColor</a>);
0504         gui.cm_handles.axes_color_chi2 = uimenu(gui.cm_handles.axes_color,<span class="keyword">...</span>
0505             <span class="string">'Label'</span>,<span class="string">'chi2'</span>,<span class="string">'Tag'</span>,<span class="string">'chi2'</span>,<span class="string">'Callback'</span>,@<a href="#_sub3" class="code" title="subfunction uv_onContextPlotsColor(src,~)">uv_onContextPlotsColor</a>);
0506         gui.cm_handles.axes_color_mnorm = uimenu(gui.cm_handles.axes_color,<span class="keyword">...</span>
0507             <span class="string">'Label'</span>,<span class="string">'xn'</span>,<span class="string">'Tag'</span>,<span class="string">'xn'</span>,<span class="string">'Callback'</span>,@<a href="#_sub3" class="code" title="subfunction uv_onContextPlotsColor(src,~)">uv_onContextPlotsColor</a>);
0508         set(gui.axes12,<span class="string">'UIContextMenu'</span>,gui.cm_handles.axes_chi2);
0509 
0510         <span class="comment">% the RTD plot has a context menu</span>
0511         gui.cm_handles.axes_rtd = uicontextmenu(fig_uncert);
0512         gui.cm_handles.axes_rtd_lines = uimenu(gui.cm_handles.axes_rtd,<span class="keyword">...</span>
0513             <span class="string">'Label'</span>,<span class="string">'lines'</span>,<span class="string">'Tag'</span>,<span class="string">'lines'</span>,<span class="string">'Checked'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0514             <span class="string">'Callback'</span>,@<a href="#_sub4" class="code" title="subfunction uv_onContextPlotsRTD(src,~)">uv_onContextPlotsRTD</a>);
0515         gui.cm_handles.axes_rtd_patch = uimenu(gui.cm_handles.axes_rtd,<span class="keyword">...</span>
0516             <span class="string">'Label'</span>,<span class="string">'patch'</span>);
0517         gui.cm_handles.axes_rtd_patch_mean = uimenu(gui.cm_handles.axes_rtd_patch,<span class="keyword">...</span>
0518             <span class="string">'Label'</span>,<span class="string">'mean / std'</span>,<span class="string">'Tag'</span>,<span class="string">'patchmean'</span>,<span class="keyword">...</span>
0519             <span class="string">'Callback'</span>,@<a href="#_sub4" class="code" title="subfunction uv_onContextPlotsRTD(src,~)">uv_onContextPlotsRTD</a>);
0520         gui.cm_handles.axes_rtd_patch_median = uimenu(gui.cm_handles.axes_rtd_patch,<span class="keyword">...</span>
0521             <span class="string">'Label'</span>,<span class="string">'median / aad'</span>,<span class="string">'Tag'</span>,<span class="string">'patchmedian'</span>,<span class="keyword">...</span>
0522             <span class="string">'Callback'</span>,@<a href="#_sub4" class="code" title="subfunction uv_onContextPlotsRTD(src,~)">uv_onContextPlotsRTD</a>);
0523         set(gui.axes2,<span class="string">'UIContextMenu'</span>,gui.cm_handles.axes_rtd);
0524 
0525         <span class="comment">% --- store main GUI settings ---</span>
0526         gui.myui = nucleus.gui.myui;
0527         gui.myui.heights = heights;
0528         gui.figh_nucleus = figh_nucleus;
0529 
0530         <span class="comment">% --- save gui data to GUI ---</span>
0531         setappdata(fig_uncert,<span class="string">'gui'</span>,gui);
0532 
0533         <span class="comment">% make GUI visible</span>
0534         delete(hwb);
0535         set(gui.main,<span class="string">'Visible'</span>,<span class="string">'on'</span>);
0536 
0537         <span class="comment">% initialize color style</span>
0538         uv.colorstyle = <span class="string">'none'</span>;
0539         <span class="comment">% initialize RTD plot style</span>
0540         uv.rtd_plotstyle = <span class="string">'lines'</span>;
0541     <span class="keyword">else</span>
0542         data = getappdata(fig_uncert,<span class="string">'data'</span>);
0543         uv = data.uv;
0544     <span class="keyword">end</span>
0545     <span class="comment">% if the figure is already open load the GUI data</span>
0546     gui = getappdata(fig_uncert,<span class="string">'gui'</span>);
0547     <span class="comment">% update new NUCLEUSinv data</span>
0548     setappdata(fig_uncert,<span class="string">'data'</span>,nucleus_data);
0549     data = getappdata(fig_uncert,<span class="string">'data'</span>);
0550     <span class="comment">% clear axes</span>
0551     <a href="clearAllAxes.html" class="code" title="function clearAllAxes(figh)">clearAllAxes</a>(fig_uncert);
0552 
0553     <span class="comment">% round all chi2 and xn values to 6 digits</span>
0554     chi2_all = data.results.invstd.uncert.chi2_all;
0555     chi2_all = round(1e6.*chi2_all)./1e6;
0556     data.results.invstd.uncert.chi2_all = chi2_all;
0557     mnorm_all = data.results.invstd.uncert.mnorm_all;
0558     mnorm_all = round(1e6.*mnorm_all)./1e6;
0559     data.results.invstd.uncert.mnorm_all = mnorm_all;
0560 
0561     <span class="comment">% create logical mask</span>
0562     uv.touse = ones(nucleus_data.uncert.N,1);
0563     <span class="comment">% --- fill the edit fields ---</span>
0564     invstd = data.results.invstd;
0565     uncert = invstd.uncert;
0566     <span class="comment">% 1.) control</span>
0567     uv.uncertMethod = uncert.params.uncert.Method;
0568     uv.uncertN = uncert.params.uncert.N;
0569     set(gui.edit_handles.uncertN,<span class="string">'String'</span>,num2str(uv.uncertN));
0570     uv.uncertThresh = uncert.params.uncert.Thresh;
0571     set(gui.edit_handles.uncertThresh,<span class="string">'String'</span>,num2str(uv.uncertThresh));
0572     uv.uncertMax = uncert.params.uncert.Max;
0573     set(gui.edit_handles.uncertMax,<span class="string">'String'</span>,num2str(uv.uncertMax));
0574     uv.chi2_range_calc  = [min(uncert.chi2_all) max(uncert.chi2_all)];
0575     uv.mnorm_range_calc = [min(uncert.mnorm_all) max(uncert.mnorm_all)];
0576     <span class="comment">% set popup menu</span>
0577     <span class="keyword">switch</span> invstd.invtype
0578         <span class="keyword">case</span> {<span class="string">'LU'</span>,<span class="string">'NNLS'</span>}
0579             set(gui.popup_handles.uncertMethod,<span class="keyword">...</span>
0580                 <span class="string">'String'</span>,{<span class="string">'RMS - unbounded'</span>,<span class="string">'RMS - bounded'</span>})
0581             <span class="keyword">switch</span> uncert.params.uncert.Method
0582                 <span class="keyword">case</span> <span class="string">'RMS_free'</span>
0583                     set(gui.popup_handles.uncertMethod,<span class="string">'Value'</span>,1);
0584                 <span class="keyword">case</span> <span class="string">'RMS_bound'</span>
0585                     set(gui.popup_handles.uncertMethod,<span class="string">'Value'</span>,2);
0586             <span class="keyword">end</span>
0587         <span class="keyword">case</span> <span class="string">'MUMO'</span>
0588             set(gui.popup_handles.uncertMethod,<span class="keyword">...</span>
0589                 <span class="string">'String'</span>,{<span class="string">'RMS - unbounded'</span>,<span class="string">'RMS - bounded'</span>,<span class="string">'Threshold'</span>,<span class="string">'Conf. Interval'</span>})
0590             <span class="keyword">switch</span> uncert.params.uncert.Method
0591                 <span class="keyword">case</span> <span class="string">'RMS_free'</span>
0592                     set(gui.popup_handles.uncertMethod,<span class="string">'Value'</span>,1);
0593                 <span class="keyword">case</span> <span class="string">'RMS_bound'</span>
0594                     set(gui.popup_handles.uncertMethod,<span class="string">'Value'</span>,2);
0595                 <span class="keyword">case</span> <span class="string">'thresh'</span>
0596                     set(gui.popup_handles.uncertMethod,<span class="string">'Value'</span>,3);
0597                 <span class="keyword">case</span> <span class="string">'ci'</span>
0598                     set(gui.popup_handles.uncertMethod,<span class="string">'Value'</span>,4);
0599             <span class="keyword">end</span>
0600     <span class="keyword">end</span>
0601     set(gui.edit_handles.uncertN,<span class="string">'String'</span>,num2str(uncert.params.uncert.N));
0602     <span class="comment">% 2.) process</span>
0603     chi2_range  = uv.chi2_range_calc;
0604     mnorm_range = uv.mnorm_range_calc;
0605     set(gui.edit_handles.chi2_min,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,chi2_range(1,1)));
0606     set(gui.edit_handles.chi2_max,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,chi2_range(1,2)));
0607     set(gui.edit_handles.mnorm_min,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,mnorm_range(1,1)));
0608     set(gui.edit_handles.mnorm_max,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,mnorm_range(1,2)));
0609     <span class="comment">% 3.) RTD range</span>
0610     rtd_range = uncert.statistics.RTD_bounds;
0611     set(gui.edit_handles.rtd_min,<span class="string">'String'</span>,num2str(rtd_range(1,1)));
0612     set(gui.edit_handles.rtd_max,<span class="string">'String'</span>,num2str(rtd_range(1,2)));
0613     uv.chi2_range = chi2_range;
0614     uv.mnorm_range = mnorm_range;
0615     uv.rtd_range = rtd_range;
0616 
0617     <span class="comment">% update data</span>
0618     data.uv = uv;
0619     setappdata(fig_uncert,<span class="string">'data'</span>,data);
0620     <a href="#_sub6" class="code" title="subfunction uv_onPopupMethod(src,~)">uv_onPopupMethod</a>(gui.popup_handles.uncertMethod);
0621 
0622     <span class="comment">% plot all uncertainty data</span>
0623     <a href="#_sub10" class="code" title="subfunction uv_updateInformation(figh)">uv_updateInformation</a>(fig_uncert);
0624     <a href="beautifyAxes.html" class="code" title="function beautifyAxes(figh)">beautifyAxes</a>(fig_uncert);
0625 <span class="keyword">end</span>
0626 
0627 <span class="keyword">end</span>
0628 
0629 <span class="comment">%% subfunction to update the edit fields</span>
0630 <a name="_sub1" href="#_subfunctions" class="code">function uv_onEditValue(src,~)</a>
0631 figh = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
0632 gui = getappdata(figh,<span class="string">'gui'</span>);
0633 data = getappdata(figh,<span class="string">'data'</span>);
0634 uv = data.uv;
0635 
0636 <span class="comment">% get the edit field value</span>
0637 val = str2double(get(src,<span class="string">'String'</span>));
0638 
0639 <span class="keyword">switch</span> get(src,<span class="string">'Tag'</span>)
0640     <span class="keyword">case</span> <span class="string">'uncertN'</span>
0641         <span class="keyword">if</span> val &lt; 10
0642             uncertN = 10;
0643         <span class="keyword">else</span>
0644             uncertN = round(val);
0645         <span class="keyword">end</span>
0646         set(src,<span class="string">'String'</span>,num2str(uncertN));
0647         uv.uncertN = uncertN;
0648         data.uv = uv;
0649     <span class="keyword">case</span> <span class="string">'uncertThresh'</span>
0650     <span class="keyword">case</span> <span class="string">'uncertMax'</span>
0651     <span class="keyword">case</span> <span class="string">'control'</span>
0652         <span class="comment">% set the value with the desired layout</span>
0653         set(src,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,val));
0654         chi2_range_calc(1,1) = str2double(get(gui.edit_handles.uncertchi2_min,<span class="string">'String'</span>));
0655         chi2_range_calc(1,2) = str2double(get(gui.edit_handles.uncertchi2_max,<span class="string">'String'</span>));
0656         mnorm_range_calc(1,1) = str2double(get(gui.edit_handles.uncertmnorm_min,<span class="string">'String'</span>));
0657         mnorm_range_calc(1,2) = str2double(get(gui.edit_handles.uncertmnorm_max,<span class="string">'String'</span>));
0658         <span class="comment">% update data</span>
0659         uv.chi2_range_calc = chi2_range_calc;
0660         uv.mnorm_range_calc = mnorm_range_calc;
0661         data.uv = uv;
0662     <span class="keyword">case</span> <span class="string">'process'</span>
0663         <span class="comment">% set the value with the desired layout</span>
0664         set(src,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,val));
0665         <span class="comment">% get all range values</span>
0666         chi2_range(1,1) = str2double(get(gui.edit_handles.chi2_min,<span class="string">'String'</span>));
0667         chi2_range(1,2) = str2double(get(gui.edit_handles.chi2_max,<span class="string">'String'</span>));
0668         mnorm_range(1,1) = str2double(get(gui.edit_handles.mnorm_min,<span class="string">'String'</span>));
0669         mnorm_range(1,2) = str2double(get(gui.edit_handles.mnorm_max,<span class="string">'String'</span>));
0670         <span class="comment">% fix wrong user input</span>
0671         <span class="keyword">if</span> chi2_range(2) &lt;= chi2_range(1)
0672             warndlg({<span class="string">'function: UNCERTVIEW'</span>,<span class="keyword">...</span>
0673             <span class="string">'Lower bound is larger than upper bound!'</span>},<span class="keyword">...</span>
0674             <span class="string">'Resetting.'</span>);
0675             chi2_range(1) = min(data.results.invstd.uncert.chi2_all);
0676             chi2_range(2) = max(data.results.invstd.uncert.chi2_all);            
0677             set(gui.edit_handles.chi2_min,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,chi2_range(1)));
0678             set(gui.edit_handles.chi2_max,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,chi2_range(2)));
0679         <span class="keyword">end</span>
0680         <span class="keyword">if</span> mnorm_range(2) &lt;= mnorm_range(1)            
0681             warndlg({<span class="string">'function: UNCERTVIEW'</span>,<span class="keyword">...</span>
0682             <span class="string">'Lower bound is larger than upper bound!'</span>},<span class="keyword">...</span>
0683             <span class="string">'Resetting.'</span>);
0684             mnorm_range(1) = min(data.results.invstd.uncert.mnorm_all);
0685             mnorm_range(2) = max(data.results.invstd.uncert.mnorm_all);
0686             set(gui.edit_handles.mnorm_min,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,mnorm_range(1)));
0687             set(gui.edit_handles.mnorm_max,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,mnorm_range(2)));
0688         <span class="keyword">end</span>
0689         <span class="comment">% update data</span>
0690         uv.chi2_range = chi2_range;
0691         uv.mnorm_range = mnorm_range;
0692         data.uv = uv;
0693         <span class="comment">% update logical mask for plotting</span>
0694         data = <a href="#_sub5" class="code" title="subfunction data = uv_updateMASK(data)">uv_updateMASK</a>(data);
0695     <span class="keyword">case</span> <span class="string">'rtd'</span>
0696         <span class="comment">% set the value with the desired layout</span>
0697         set(src,<span class="string">'String'</span>,num2str(val));
0698         <span class="comment">% get all range values</span>
0699         rtd_range(1,1) = str2double(get(gui.edit_handles.rtd_min,<span class="string">'String'</span>));
0700         rtd_range(1,2) = str2double(get(gui.edit_handles.rtd_max,<span class="string">'String'</span>));
0701         <span class="comment">% update data</span>
0702         uv.rtd_range = rtd_range;
0703         data.uv = uv;
0704 <span class="keyword">end</span>
0705 
0706 <span class="comment">% update GUI data</span>
0707 setappdata(figh,<span class="string">'data'</span>,data);
0708 <span class="comment">% update information</span>
0709 <a href="#_sub10" class="code" title="subfunction uv_updateInformation(figh)">uv_updateInformation</a>(figh);
0710 <span class="keyword">end</span>
0711 
0712 <span class="comment">%% subfunction to copy the chi2 and xn range to the control panel</span>
0713 <a name="_sub2" href="#_subfunctions" class="code">function uv_onPushSend(src,~)</a>
0714 figh = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
0715 gui = getappdata(figh,<span class="string">'gui'</span>);
0716 data = getappdata(figh,<span class="string">'data'</span>);
0717 uv = data.uv;
0718 
0719 <span class="comment">% get all data</span>
0720 chi2_range(1,1) = str2double(get(gui.edit_handles.chi2_min,<span class="string">'String'</span>));
0721 chi2_range(1,2) = str2double(get(gui.edit_handles.chi2_max,<span class="string">'String'</span>));
0722 mnorm_range(1,1) = str2double(get(gui.edit_handles.mnorm_min,<span class="string">'String'</span>));
0723 mnorm_range(1,2) = str2double(get(gui.edit_handles.mnorm_max,<span class="string">'String'</span>));
0724 
0725 <span class="comment">% copy data to calc</span>
0726 uv.chi2_range_calc = chi2_range;
0727 uv.mnorm_range_calc = mnorm_range;
0728 data.uv = uv;
0729 
0730 <span class="comment">% write values to edit field</span>
0731 set(gui.edit_handles.uncertchi2_min,<span class="keyword">...</span>
0732     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range_calc(1)));
0733 set(gui.edit_handles.uncertchi2_max,<span class="keyword">...</span>
0734     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range_calc(2)));
0735 set(gui.edit_handles.uncertmnorm_min,<span class="keyword">...</span>
0736     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range_calc(1)));
0737 set(gui.edit_handles.uncertmnorm_max,<span class="keyword">...</span>
0738     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range_calc(2)));
0739 
0740 <span class="comment">% update GUI data</span>
0741 setappdata(figh,<span class="string">'data'</span>,data);
0742 <span class="keyword">end</span>
0743 
0744 <span class="comment">%% subfunction to control the line color</span>
0745 <a name="_sub3" href="#_subfunctions" class="code">function uv_onContextPlotsColor(src,~)</a>
0746 figh = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
0747 gui = getappdata(figh,<span class="string">'gui'</span>);
0748 data = getappdata(figh,<span class="string">'data'</span>);
0749 uv = data.uv;
0750 
0751 <span class="comment">% switch through different plot options</span>
0752 <span class="keyword">switch</span> get(src,<span class="string">'Tag'</span>)
0753     <span class="keyword">case</span> <span class="string">'none'</span>
0754         set(gui.cm_handles.axes_color_none,<span class="string">'Checked'</span>,<span class="string">'on'</span>);
0755         set(gui.cm_handles.axes_color_chi2,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0756         set(gui.cm_handles.axes_color_mnorm,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0757     <span class="keyword">case</span> <span class="string">'chi2'</span>
0758         set(gui.cm_handles.axes_color_none,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0759         set(gui.cm_handles.axes_color_chi2,<span class="string">'Checked'</span>,<span class="string">'on'</span>);
0760         set(gui.cm_handles.axes_color_mnorm,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0761     <span class="keyword">case</span> <span class="string">'xn'</span>
0762         set(gui.cm_handles.axes_color_none,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0763         set(gui.cm_handles.axes_color_chi2,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0764         set(gui.cm_handles.axes_color_mnorm,<span class="string">'Checked'</span>,<span class="string">'on'</span>);
0765 <span class="keyword">end</span>
0766 uv.colorstyle = get(src,<span class="string">'Tag'</span>);
0767 
0768 <span class="comment">% update GUI data</span>
0769 data.uv = uv;
0770 setappdata(figh,<span class="string">'data'</span>,data);
0771 <span class="comment">% update information and plots</span>
0772 <a href="#_sub10" class="code" title="subfunction uv_updateInformation(figh)">uv_updateInformation</a>(figh);
0773 <span class="keyword">end</span>
0774 
0775 <span class="comment">%% subfunction to control RTD axes context menu</span>
0776 <a name="_sub4" href="#_subfunctions" class="code">function uv_onContextPlotsRTD(src,~)</a>
0777 figh = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
0778 gui = getappdata(figh,<span class="string">'gui'</span>);
0779 data = getappdata(figh,<span class="string">'data'</span>);
0780 uv = data.uv;
0781 
0782 <span class="comment">% switch through different plot options</span>
0783 <span class="keyword">switch</span> get(src,<span class="string">'Tag'</span>)
0784     <span class="keyword">case</span> <span class="string">'lines'</span>
0785         set(gui.cm_handles.axes_rtd_lines,<span class="string">'Checked'</span>,<span class="string">'on'</span>);
0786         set(gui.cm_handles.axes_rtd_patch_mean,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0787         set(gui.cm_handles.axes_rtd_patch_median,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0788     <span class="keyword">case</span> <span class="string">'patchmean'</span>
0789         set(gui.cm_handles.axes_rtd_lines,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0790         set(gui.cm_handles.axes_rtd_patch_mean,<span class="string">'Checked'</span>,<span class="string">'on'</span>);
0791         set(gui.cm_handles.axes_rtd_patch_median,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0792     <span class="keyword">case</span> <span class="string">'patchmedian'</span>
0793         set(gui.cm_handles.axes_rtd_lines,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0794         set(gui.cm_handles.axes_rtd_patch_mean,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0795         set(gui.cm_handles.axes_rtd_patch_median,<span class="string">'Checked'</span>,<span class="string">'on'</span>);
0796 <span class="keyword">end</span>
0797 uv.rtd_plotstyle = get(src,<span class="string">'Tag'</span>);
0798 
0799 <span class="comment">% update GUI data</span>
0800 data.uv = uv;
0801 setappdata(figh,<span class="string">'data'</span>,data);
0802 <span class="comment">% update information and plots</span>
0803 <a href="#_sub10" class="code" title="subfunction uv_updateInformation(figh)">uv_updateInformation</a>(figh);
0804 <span class="keyword">end</span>
0805 
0806 <span class="comment">%% subfunction to update the logical mask</span>
0807 <a name="_sub5" href="#_subfunctions" class="code">function data = uv_updateMASK(data)</a>
0808 uncert = data.results.invstd.uncert;
0809 uv = data.uv;
0810 
0811 mask1 = uncert.chi2_all &gt;= uv.chi2_range(1) &amp; uncert.chi2_all &lt;= uv.chi2_range(2);
0812 mask2 = uncert.mnorm_all &gt;= uv.mnorm_range(1) &amp; uncert.mnorm_all &lt;= uv.mnorm_range(2);
0813 uv.touse = mask1 &amp; mask2;
0814 
0815 data.uv = uv;
0816 <span class="keyword">end</span>
0817 
0818 <span class="comment">%% subfunction to update control panel based on uncertainty method</span>
0819 <a name="_sub6" href="#_subfunctions" class="code">function uv_onPopupMethod(src,~)</a>
0820 figh = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
0821 gui = getappdata(figh,<span class="string">'gui'</span>);
0822 data = getappdata(figh,<span class="string">'data'</span>);
0823 uv = data.uv;
0824 invstd = data.results.invstd;
0825 
0826 val = get(gui.popup_handles.uncertMethod,<span class="string">'Value'</span>);
0827 
0828 <span class="keyword">switch</span> invstd.invtype
0829     <span class="keyword">case</span> {<span class="string">'LU'</span>,<span class="string">'NNLS'</span>}
0830         <span class="keyword">switch</span> val
0831             <span class="keyword">case</span> 1 <span class="comment">% RMS_free</span>
0832                 uv.uncertMethod = <span class="string">'RMS_free'</span>;
0833                 set(gui.edit_handles.uncertchi2_min,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0834                 set(gui.edit_handles.uncertchi2_max,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0835                 set(gui.edit_handles.uncertmnorm_min,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0836                 set(gui.edit_handles.uncertmnorm_max,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0837                 set(gui.edit_handles.uncertThresh,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0838                 set(gui.edit_handles.uncertMax,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0839             <span class="keyword">case</span> 2 <span class="comment">% RMS_bound</span>
0840                 uv.uncertMethod = <span class="string">'RMS_bound'</span>;
0841                 set(gui.edit_handles.uncertchi2_min,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0842                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range_calc(1)));
0843                 set(gui.edit_handles.uncertchi2_max,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0844                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range_calc(2)));
0845                 set(gui.edit_handles.uncertmnorm_min,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0846                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range_calc(1)));
0847                 set(gui.edit_handles.uncertmnorm_max,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0848                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range_calc(2)));
0849                 set(gui.edit_handles.uncertThresh,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0850                 set(gui.edit_handles.uncertMax,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0851                     <span class="string">'String'</span>,num2str(uv.uncertMax));
0852         <span class="keyword">end</span>
0853     <span class="keyword">case</span> <span class="string">'MUMO'</span>
0854         <span class="keyword">switch</span> val
0855             <span class="keyword">case</span> 1 <span class="comment">% RMS_free</span>
0856                 uv.uncertMethod = <span class="string">'RMS_free'</span>;
0857                 set(gui.edit_handles.uncertchi2_min,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0858                 set(gui.edit_handles.uncertchi2_max,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0859                 set(gui.edit_handles.uncertmnorm_min,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0860                 set(gui.edit_handles.uncertmnorm_max,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0861                 set(gui.edit_handles.uncertThresh,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0862                 set(gui.edit_handles.uncertMax,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0863             <span class="keyword">case</span> 2 <span class="comment">% RMS_bound</span>
0864                 uv.uncertMethod = <span class="string">'RMS_bound'</span>;
0865                 set(gui.edit_handles.uncertchi2_min,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0866                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range_calc(1)));
0867                 set(gui.edit_handles.uncertchi2_max,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0868                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range_calc(2)));
0869                 set(gui.edit_handles.uncertmnorm_min,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0870                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range_calc(1)));
0871                 set(gui.edit_handles.uncertmnorm_max,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0872                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range_calc(2)));
0873                 set(gui.edit_handles.uncertThresh,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0874                 set(gui.edit_handles.uncertMax,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0875                     <span class="string">'String'</span>,num2str(uv.uncertMax));
0876             <span class="keyword">case</span> 3 <span class="comment">% threshold</span>
0877                 uv.uncertMethod = <span class="string">'thresh'</span>;
0878                 uv.chi2_range_calc = [0 10];
0879                 uv.mnorm_range_calc = [0 10];
0880                 set(gui.edit_handles.uncertchi2_min,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0881                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range_calc(1)));
0882                 set(gui.edit_handles.uncertchi2_max,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0883                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range_calc(2)));
0884                 set(gui.edit_handles.uncertmnorm_min,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0885                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range_calc(1)));
0886                 set(gui.edit_handles.uncertmnorm_max,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0887                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range_calc(2)));
0888                 set(gui.edit_handles.uncertThresh,<span class="string">'Enable'</span>,<span class="string">'on'</span>);
0889                 set(gui.edit_handles.uncertMax,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0890                     <span class="string">'String'</span>,num2str(uv.uncertMax));
0891             <span class="keyword">case</span> 4 <span class="comment">% ci - confidence intrval</span>
0892                 uv.uncertMethod = <span class="string">'ci'</span>;
0893                 uv.chi2_range_calc = [0 10];
0894                 uv.mnorm_range_calc = [0 10];
0895                 set(gui.edit_handles.uncertchi2_min,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0896                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range_calc(1)));
0897                 set(gui.edit_handles.uncertchi2_max,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0898                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range_calc(2)));
0899                 set(gui.edit_handles.uncertmnorm_min,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0900                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range_calc(1)));
0901                 set(gui.edit_handles.uncertmnorm_max,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0902                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range_calc(2)));
0903                 set(gui.edit_handles.uncertThresh,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0904                 set(gui.edit_handles.uncertMax,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0905                     <span class="string">'String'</span>,num2str(uv.uncertMax));
0906         <span class="keyword">end</span>
0907 <span class="keyword">end</span>
0908 
0909 <span class="comment">% update GUI data</span>
0910 data.uv = uv;
0911 setappdata(figh,<span class="string">'data'</span>,data);
0912 <span class="keyword">end</span>
0913 
0914 <span class="comment">%% subfunction to start a new uncertainty calculation</span>
0915 <a name="_sub7" href="#_subfunctions" class="code">function uv_onPushRun(src,~)</a>
0916 figh = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
0917 gui = getappdata(figh,<span class="string">'gui'</span>);
0918 data = getappdata(figh,<span class="string">'data'</span>);
0919 uv = data.uv;
0920 invstd = data.results.invstd;
0921 uncert = invstd.uncert;
0922 
0923 <span class="comment">% original fit parameter</span>
0924 iparam = invstd.invparams;
0925 <span class="comment">% original uncertainty parameter</span>
0926 uparam = uncert.params;
0927 <span class="comment">% new uncertainty parameter from GUI</span>
0928 uparam.uncert.Method = uv.uncertMethod;
0929 uparam.uncert.Thresh = uv.uncertThresh;
0930 uparam.uncert.chi2_range = uv.chi2_range_calc;
0931 uparam.uncert.mnorm_range = uv.mnorm_range_calc;
0932 uparam.uncert.N = uv.uncertN;
0933 uparam.uncert.Max = uv.uncertMax;
0934 invstd = <a href="../../../nucleus/functions/inversion/estimateUncertainty.html" class="code" title="function [invstd,uncert] = estimateUncertainty(invtype,invstd,iparam,parameter)">estimateUncertainty</a>(invstd.invtype,invstd,iparam,uparam);
0935 
0936 <span class="comment">% save updated inversion results</span>
0937 invstd.uncert.params = uparam;
0938 data.results.invstd = invstd;
0939 
0940 <span class="comment">% update GUI data</span>
0941 <span class="comment">% round all chi2 and xn values to 6 digits</span>
0942 chi2_all = data.results.invstd.uncert.chi2_all;
0943 chi2_all = round(1e6.*chi2_all)./1e6;
0944 data.results.invstd.uncert.chi2_all = chi2_all;
0945 mnorm_all = data.results.invstd.uncert.mnorm_all;
0946 mnorm_all = round(1e6.*mnorm_all)./1e6;
0947 data.results.invstd.uncert.mnorm_all = mnorm_all;
0948 
0949 <span class="comment">% create logical mask</span>
0950 uv.touse = ones(uv.uncertN,1);
0951 
0952 <span class="comment">% 1.) control</span>
0953 uv.chi2_range_calc = [min(chi2_all) max(chi2_all)];
0954 uv.mnorm_range_calc = [min(mnorm_all) max(mnorm_all)];
0955 
0956 <span class="comment">% 2.) process</span>
0957 uv.chi2_range = uv.chi2_range_calc;
0958 uv.mnorm_range = uv.mnorm_range_calc;
0959 set(gui.edit_handles.chi2_min,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range(1,1)));
0960 set(gui.edit_handles.chi2_max,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range(1,2)));
0961 set(gui.edit_handles.mnorm_min,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range(1,1)));
0962 set(gui.edit_handles.mnorm_max,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range(1,2)));
0963 
0964 <span class="comment">% update data</span>
0965 data.uv = uv;
0966 setappdata(figh,<span class="string">'data'</span>,data);
0967 
0968 <span class="comment">% plot all uncertainty data</span>
0969 <a href="#_sub10" class="code" title="subfunction uv_updateInformation(figh)">uv_updateInformation</a>(figh);
0970 <a href="beautifyAxes.html" class="code" title="function beautifyAxes(figh)">beautifyAxes</a>(figh);
0971 <span class="keyword">end</span>
0972 
0973 <span class="comment">%% subfunction to update the main NUCLEUSinv GUI</span>
0974 <a name="_sub8" href="#_subfunctions" class="code">function uv_onPushUpdate(src,~)</a>
0975 figh = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
0976 <span class="comment">% local GUI data</span>
0977 uvgui = getappdata(figh,<span class="string">'gui'</span>);
0978 uvdata = getappdata(figh,<span class="string">'data'</span>);
0979 <span class="comment">% NUCLEUSinv data</span>
0980 gui = getappdata(uvgui.figh_nucleus,<span class="string">'gui'</span>);
0981 data = getappdata(uvgui.figh_nucleus,<span class="string">'data'</span>);
0982 INVdata = getappdata(uvgui.figh_nucleus,<span class="string">'INVdata'</span>);
0983 
0984 <span class="comment">% get signal id</span>
0985 id = data.results.invstd.uncert.params.id;
0986 <span class="comment">% get data</span>
0987 INVdata0 = INVdata{id};
0988 
0989 <span class="comment">% --- update data ---</span>
0990 <span class="comment">% -- general settings --</span>
0991 data.uncert.N = uvdata.uv.uncertN;
0992 data.uncert.Method = uvdata.uv.uncertMethod;
0993 data.uncert.Thresh = uvdata.uv.uncertThresh;
0994 data.uncert.Max = uvdata.uv.uncertMax;
0995 
0996 <span class="comment">% -- check if data was excluded --</span>
0997 <span class="keyword">if</span> sum(uvdata.uv.touse == 0) &gt; 0
0998     <span class="comment">% if yes, proceed</span>
0999     in = uvdata.uv.touse == 1;
1000     data.uncert.N = sum(in);
1001     uvdata.results.invstd.uncert.params.uncert.N = sum(in);
1002     uvdata.results.invstd.uncert.chi2_all = uvdata.results.invstd.uncert.chi2_all(in);
1003     uvdata.results.invstd.uncert.mnorm_all = uvdata.results.invstd.uncert.mnorm_all(in);
1004     uvdata.results.invstd.uncert.rnorm_all = uvdata.results.invstd.uncert.rnorm_all(in);
1005     uvdata.results.invstd.uncert.interp_f = uvdata.results.invstd.uncert.interp_f(in,:);
1006     uvdata.results.invstd.uncert.interp_s = uvdata.results.invstd.uncert.interp_s(:,in');
1007     uvdata.results.invstd.uncert.interp_E0 = uvdata.results.invstd.uncert.interp_E0(in);
1008     uvdata.results.invstd.uncert.E0 = [mean(uvdata.results.invstd.uncert.interp_E0) std(uvdata.results.invstd.uncert.interp_E0)];
1009     uvdata.results.invstd.uncert.interp_Tlgm = uvdata.results.invstd.uncert.interp_Tlgm(in);
1010     uvdata.results.invstd.uncert.Tlgm = [mean(uvdata.results.invstd.uncert.interp_Tlgm) std(uvdata.results.invstd.uncert.interp_Tlgm)];
1011 <span class="keyword">end</span>
1012 
1013 <span class="comment">% add statisitics</span>
1014 uvdata.results.invstd.uncert.statistics = uvdata.uv.stats;
1015 
1016 <span class="comment">% update data structs</span>
1017 data.results.invstd.uncert = uvdata.results.invstd.uncert;
1018 INVdata0.uncert = data.uncert;
1019 INVdata0.results.invstd = uvdata.results.invstd;
1020 
1021 <span class="comment">% update INVdata</span>
1022 INVdata{id} = INVdata0;
1023 <span class="comment">% update GUI data</span>
1024 setappdata(uvgui.figh_nucleus,<span class="string">'data'</span>,data);
1025 <span class="comment">% update GUI INVdata</span>
1026 setappdata(uvgui.figh_nucleus,<span class="string">'INVdata'</span>,INVdata);
1027 
1028 <span class="comment">% update relevant GUI elements</span>
1029 set(gui.edit_handles.uncert_N,<span class="string">'String'</span>,num2str(data.results.invstd.uncert.params.uncert.N))
1030 
1031 <span class="comment">% update plots and INFO fields in main NUCLEUS GUI</span>
1032 <a href="updatePlotsSignal.html" class="code" title="function updatePlotsSignal">updatePlotsSignal</a>;
1033 <a href="updatePlotsDistribution.html" class="code" title="function updatePlotsDistribution">updatePlotsDistribution</a>;
1034 <a href="updateInfo.html" class="code" title="function updateInfo(src,~) %#ok<INUSD>">updateInfo</a>(gui.plots.SignalPanel);
1035 
1036 <span class="keyword">end</span>
1037 
1038 <span class="comment">%% subfunction to reset chi2 and model norm bounds</span>
1039 <a name="_sub9" href="#_subfunctions" class="code">function uv_onPushReset(src,~)</a>
1040 figh = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
1041 gui = getappdata(figh,<span class="string">'gui'</span>);
1042 data = getappdata(figh,<span class="string">'data'</span>);
1043 uv = data.uv;
1044 invstd = data.results.invstd;
1045 uncert = invstd.uncert;
1046 
1047 <span class="keyword">switch</span> get(src,<span class="string">'Tag'</span>)
1048     <span class="keyword">case</span> <span class="string">'process'</span>
1049         <span class="comment">% reset to original values</span>
1050         chi2_range  = [min(uncert.chi2_all) max(uncert.chi2_all)];
1051         mnorm_range = [min(uncert.mnorm_all) max(uncert.mnorm_all)];
1052         <span class="comment">% update edit fields</span>
1053         set(gui.edit_handles.chi2_min,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,chi2_range(1,1)));
1054         set(gui.edit_handles.chi2_max,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,chi2_range(1,2)));
1055         set(gui.edit_handles.mnorm_min,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,mnorm_range(1,1)));
1056         set(gui.edit_handles.mnorm_max,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,mnorm_range(1,2)));
1057         <span class="comment">% update data</span>
1058         uv.chi2_range = chi2_range;
1059         uv.mnorm_range = mnorm_range;
1060         data.uv = uv;
1061         <span class="comment">% update logical mask for plotting</span>
1062         data = <a href="#_sub5" class="code" title="subfunction data = uv_updateMASK(data)">uv_updateMASK</a>(data);
1063     <span class="keyword">case</span> <span class="string">'rtd'</span>
1064         <span class="comment">% reset to original values</span>
1065         rtd_range = data.invstd.time;
1066         <span class="comment">% update edit fields</span>
1067         set(gui.edit_handles.rtd_min,<span class="string">'String'</span>,num2str(rtd_range(1,1)));
1068         set(gui.edit_handles.rtd_max,<span class="string">'String'</span>,num2str(rtd_range(1,2)));
1069         <span class="comment">% update data</span>
1070         uv.rtd_range = rtd_range;
1071         data.uv = uv;
1072 <span class="keyword">end</span>
1073 
1074 setappdata(figh,<span class="string">'data'</span>,data);
1075 <span class="comment">% update information</span>
1076 <a href="#_sub10" class="code" title="subfunction uv_updateInformation(figh)">uv_updateInformation</a>(figh);
1077 <span class="keyword">end</span>
1078 
1079 <span class="comment">%% subfunction to update the information output</span>
1080 <a name="_sub10" href="#_subfunctions" class="code">function uv_updateInformation(figh)</a>
1081 gui = getappdata(figh,<span class="string">'gui'</span>);
1082 data = getappdata(figh,<span class="string">'data'</span>);
1083 invstd = data.results.invstd;
1084 uncert = invstd.uncert;
1085 uv = data.uv;
1086 
1087 <span class="comment">% which models to use</span>
1088 in = data.uv.touse == 1;
1089 <span class="comment">% RTD time vector</span>
1090 T = data.results.invstd.T1T2me;
1091 <span class="comment">% kernel matrices for pure (single) E0 estimation</span>
1092 iparam = invstd.invparams;
1093 <span class="keyword">switch</span> iparam.T1T2
1094     <span class="keyword">case</span> <span class="string">'T1'</span>
1095         K0 = <a href="../../../nucleus/functions/inversion/createKernelMatrix.html" class="code" title="function K = createKernelMatrix(t,T,Tbulk,Tdiff,Tflag,T1IRfac)">createKernelMatrix</a>(10*data.results.nmrproc.t(end),T',<span class="keyword">...</span>
1096             iparam.Tb,iparam.Td,<span class="string">'T1'</span>,iparam.T1IRfac);
1097     <span class="keyword">case</span> <span class="string">'T2'</span>
1098         K0 = <a href="../../../nucleus/functions/inversion/createKernelMatrix.html" class="code" title="function K = createKernelMatrix(t,T,Tbulk,Tdiff,Tflag,T1IRfac)">createKernelMatrix</a>(0,T',iparam.Tb,<span class="keyword">...</span>
1099             iparam.Td,<span class="string">'T2'</span>,iparam.T1IRfac);
1100 <span class="keyword">end</span>
1101 <span class="comment">% get statistics</span>
1102 stats = <a href="../../../nucleus/functions/inversion/getUncertaintyStatistics.html" class="code" title="function out = getUncertaintyStatistics(T,RTDs,range,K0)">getUncertaintyStatistics</a>(T,uncert.interp_f(in,:),uv.rtd_range,K0);
1103 
1104 <span class="comment">% assign to GUI fields</span>
1105 <span class="comment">% TLGM</span>
1106 uv.Tlgm = [stats.Tlgm(1) stats.Tlgm(2)];
1107 set(gui.edit_handles.TLGM_mean,<span class="string">'String'</span>,sprintf(<span class="string">'%5.4f'</span>,uv.Tlgm(1)));
1108 set(gui.edit_handles.TLGM_std,<span class="string">'String'</span>,sprintf(<span class="string">'%5.4f'</span>,2*uv.Tlgm(2)));
1109 <span class="comment">% aad - mean</span>
1110 uv.Tlgm_aad = stats.Tlgm(3);
1111 set(gui.edit_handles.TLGM_aad,<span class="string">'String'</span>,sprintf(<span class="string">'%5.4f'</span>,2*uv.Tlgm_aad));
1112 <span class="comment">% aad - median</span>
1113 uv.Tlgm_aadmed = [stats.Tlgm_med(1) stats.Tlgm_med(2)];
1114 set(gui.edit_handles.TLGM_med,<span class="string">'String'</span>,sprintf(<span class="string">'%5.4f'</span>,uv.Tlgm_aadmed(1)));
1115 set(gui.edit_handles.TLGM_aadmed,<span class="string">'String'</span>,sprintf(<span class="string">'%5.4f'</span>,2*uv.Tlgm_aadmed(2)));
1116 <span class="comment">% E0</span>
1117 uv.E0 = [stats.E0(1) stats.E0(2)];
1118 set(gui.edit_handles.E0_mean,<span class="string">'String'</span>,sprintf(<span class="string">'%5.4f'</span>,uv.E0(1)));
1119 set(gui.edit_handles.E0_std,<span class="string">'String'</span>,sprintf(<span class="string">'%5.4f'</span>,2*uv.E0(2)));
1120 <span class="comment">% aad - mean</span>
1121 uv.E0_aad = stats.E0(3);
1122 set(gui.edit_handles.E0_aad,<span class="string">'String'</span>,sprintf(<span class="string">'%5.4f'</span>,2*uv.E0_aad));
1123 <span class="comment">% aad - median</span>
1124 uv.E0_aadmed = [stats.E0_med(1) stats.E0_med(2)];
1125 set(gui.edit_handles.E0_med,<span class="string">'String'</span>,sprintf(<span class="string">'%5.4f'</span>,uv.E0_aadmed(1)));
1126 set(gui.edit_handles.E0_aadmed,<span class="string">'String'</span>,sprintf(<span class="string">'%5.4f'</span>,2*uv.E0_aadmed(2)));
1127 
1128 <span class="comment">% update GUI data</span>
1129 uv.stats = stats;
1130 data.uv = uv;
1131 setappdata(figh,<span class="string">'data'</span>,data);
1132 <span class="comment">% update plots</span>
1133 <a href="#_sub11" class="code" title="subfunction uv_updatePlots(figh)">uv_updatePlots</a>(figh);
1134 
1135 <span class="keyword">end</span>
1136 
1137 <span class="comment">%% subfunction to update all plots</span>
1138 <a name="_sub11" href="#_subfunctions" class="code">function uv_updatePlots(figh)</a>
1139 gui = getappdata(figh,<span class="string">'gui'</span>);
1140 data = getappdata(figh,<span class="string">'data'</span>);
1141 
1142 <span class="comment">% clear axes</span>
1143 <a href="clearAllAxes.html" class="code" title="function clearAllAxes(figh)">clearAllAxes</a>(figh);
1144 hold(gui.axes11,<span class="string">'on'</span>);
1145 hold(gui.axes12,<span class="string">'on'</span>);
1146 hold(gui.axes2,<span class="string">'on'</span>);
1147 hold(gui.axes21,<span class="string">'on'</span>);
1148 hold(gui.axes22,<span class="string">'on'</span>);
1149 
1150 <span class="comment">% get relevant data</span>
1151 uv = data.uv;
1152 invstd = data.results.invstd;
1153 uncert = invstd.uncert;
1154 col = gui.myui.colors;
1155 
1156 <span class="comment">% get indices for models to use and not to use</span>
1157 in = data.uv.touse == 1;
1158 out = data.uv.touse == 0;
1159 
1160 <span class="keyword">switch</span> uv.colorstyle
1161     <span class="keyword">case</span> <span class="string">'none'</span>
1162         <span class="comment">% default gray</span>
1163         lcolors = [0.5 0.5 0.5];
1164         tmpchi2 = uncert.chi2_all(in);
1165         tmpmnorm = uncert.mnorm_all(in);
1166         tmpE0 = uncert.interp_E0(in);
1167         tmpTlgm = uncert.interp_Tlgm(in);
1168         clims = [0 1];
1169     <span class="keyword">case</span> <span class="string">'chi2'</span>
1170         tmp = uncert.chi2_all(in);
1171         [tmpchi2,idx] = sort(tmp);
1172         lcolors = tmpchi2;
1173         tmpmnorm = uncert.mnorm_all(in);
1174         tmpmnorm = tmpmnorm(idx);
1175         tmpE0 = uncert.interp_E0(in);
1176         tmpE0 = tmpE0(idx);
1177         tmpTlgm = uncert.interp_Tlgm(in);
1178         tmpTlgm = tmpTlgm(idx);
1179         clims = [min(uncert.chi2_all) max(uncert.chi2_all)];
1180     <span class="keyword">case</span> <span class="string">'xn'</span>
1181         tmp = uncert.mnorm_all(in);
1182         [tmpmnorm,idx] = sort(tmp);
1183         lcolors = tmpmnorm;
1184         tmpchi2 = uncert.chi2_all(in);
1185         tmpchi2 = tmpchi2(idx);
1186         tmpE0 = uncert.interp_E0(in);
1187         tmpE0 = tmpE0(idx);
1188         tmpTlgm = uncert.interp_Tlgm(in);
1189         tmpTlgm = tmpTlgm(idx);
1190         clims = [min(uncert.mnorm_all) max(uncert.mnorm_all)];
1191 <span class="keyword">end</span>
1192 
1193 <span class="comment">% --- chi2 vs model norm ---</span>
1194 scatter(uncert.chi2_all(out),uncert.mnorm_all(out),[],<span class="string">'red'</span>,<span class="keyword">...</span>
1195     <span class="string">'LineWidth'</span>,1,<span class="string">'Parent'</span>,gui.axes12);
1196 scatter(gui.axes12,tmpchi2,tmpmnorm,[],lcolors,<span class="keyword">...</span>
1197     <span class="string">'LineWidth'</span>,1);
1198 plot(invstd.chi2,invstd.xn,<span class="string">'+'</span>,<span class="string">'MarkerSize'</span>,10,<span class="string">'Color'</span>,col.FIT,<span class="string">'Parent'</span>,gui.axes12);
1199 <span class="comment">% axis limits</span>
1200 xlims = [min([uncert.chi2_all(in); invstd.chi2]) max([uncert.chi2_all(in); invstd.chi2])];
1201 dx = xlims(2)-xlims(1);
1202 xlims = [xlims(1)-dx/5 xlims(2)+dx/5];
1203 ylims = [min([uncert.mnorm_all(in); invstd.xn]) max([uncert.mnorm_all(in); invstd.xn])];
1204 dy = ylims(2)-ylims(1);
1205 ylims = [ylims(1)-dy/5 ylims(2)+dy/5];
1206 <span class="comment">% -- lines indicating TLGM and E0 bounds --</span>
1207 line([min(uncert.chi2_all(in)) min(uncert.chi2_all(in))],[ylims(1) ylims(2)],<span class="string">'Color'</span>,[0.25 0.25 0.25],<span class="keyword">...</span>
1208     <span class="string">'LineStyle'</span>,<span class="string">':'</span>,<span class="string">'LineWidth'</span>,0.75,<span class="string">'Parent'</span>,gui.axes12,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1209 line([max(uncert.chi2_all(in)) max(uncert.chi2_all(in))],[ylims(1) ylims(2)],<span class="string">'Color'</span>,[0.25 0.25 0.25],<span class="keyword">...</span>
1210     <span class="string">'LineStyle'</span>,<span class="string">':'</span>,<span class="string">'LineWidth'</span>,0.75,<span class="string">'Parent'</span>,gui.axes12,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1211 line([xlims(1) xlims(2)],[min(uncert.mnorm_all(in)) min(uncert.mnorm_all(in))],<span class="string">'Color'</span>,[0.25 0.25 0.25],<span class="keyword">...</span>
1212     <span class="string">'LineStyle'</span>,<span class="string">':'</span>,<span class="string">'LineWidth'</span>,0.75,<span class="string">'Parent'</span>,gui.axes12,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1213 line([xlims(1) xlims(2)],[max(uncert.mnorm_all(in)) max(uncert.mnorm_all(in))],<span class="string">'Color'</span>,[0.25 0.25 0.25],<span class="keyword">...</span>
1214     <span class="string">'LineStyle'</span>,<span class="string">':'</span>,<span class="string">'LineWidth'</span>,0.75,<span class="string">'Parent'</span>,gui.axes12,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1215 <span class="comment">% axis setings</span>
1216 set(gui.axes12,<span class="string">'XScale'</span>,<span class="string">'lin'</span>,<span class="string">'XLim'</span>,xlims);
1217 set(gui.axes12,<span class="string">'YScale'</span>,<span class="string">'log'</span>,<span class="string">'YLim'</span>,ylims);
1218 set(gui.axes12,<span class="string">'CLim'</span>,clims);
1219 set(get(gui.axes12,<span class="string">'XLabel'</span>),<span class="string">'String'</span>,<span class="string">'X² (error weighted residuals)'</span>);
1220 set(get(gui.axes12,<span class="string">'YLabel'</span>),<span class="string">'String'</span>,<span class="string">'model norm |Lm|_{2}'</span>);
1221 
1222 <span class="comment">% --- TLGM vs E0 ---</span>
1223 scatter(uncert.interp_Tlgm(out),uncert.interp_E0(out),[],<span class="string">'red'</span>,<span class="keyword">...</span>
1224     <span class="string">'LineWidth'</span>,1,<span class="string">'DisplayName'</span>,<span class="string">'runs (out)'</span>,<span class="string">'Parent'</span>,gui.axes11);
1225 scatter(tmpTlgm,tmpE0,[],lcolors,<span class="keyword">...</span>
1226     <span class="string">'LineWidth'</span>,1,<span class="string">'DisplayName'</span>,<span class="string">'runs (in)'</span>,<span class="string">'Parent'</span>,gui.axes11);
1227 plot(invstd.Tlgm,invstd.E0,<span class="string">'+'</span>,<span class="string">'MarkerSize'</span>,10,<span class="string">'Color'</span>,col.FIT,<span class="keyword">...</span>
1228     <span class="string">'DisplayName'</span>,<span class="string">'init'</span>,<span class="string">'Parent'</span>,gui.axes11);
1229 errorbar(uv.Tlgm(1),uv.E0(1),2*uv.E0(2),2*uv.E0(2),2*uv.Tlgm(2),2*uv.Tlgm(2),<span class="keyword">...</span>
1230     <span class="string">'Color'</span>,col.BoxPRC,<span class="string">'LineWidth'</span>,2,<span class="string">'DisplayName'</span>,<span class="string">'mean (2*std)'</span>,<span class="string">'Parent'</span>,gui.axes11);
1231 errorbar(uv.Tlgm_aadmed(1),uv.E0_aadmed(1),2*uv.E0_aadmed(2),2*uv.E0_aadmed(2),2*uv.Tlgm_aadmed(2),2*uv.Tlgm_aadmed(2),<span class="keyword">...</span>
1232     <span class="string">'Color'</span>,col.BoxCPS,<span class="string">'LineWidth'</span>,2,<span class="string">'DisplayName'</span>,<span class="string">'median (2*aad)'</span>,<span class="string">'Parent'</span>,gui.axes11);
1233 <span class="comment">% axis limits</span>
1234 <span class="comment">% xlims = [min([uncert.interp_Tlgm; invstd.Tlgm; uv.Tlgm(1)])*0.95 ...</span>
1235 <span class="comment">%     max([uncert.interp_Tlgm; invstd.Tlgm; uv.Tlgm(1)])*1.05];</span>
1236 <span class="comment">% ylims = [min([uncert.interp_E0; invstd.E0; uv.E0(1)])*0.95 ...</span>
1237 <span class="comment">%     max([uncert.interp_E0; invstd.E0; uv.E0(1)])*1.05];</span>
1238 xlims = [min([uncert.interp_Tlgm(in); invstd.Tlgm; uv.Tlgm(1)])*0.975 <span class="keyword">...</span>
1239     max([uncert.interp_Tlgm(in); invstd.Tlgm; uv.Tlgm(1)])*1.025];
1240 ylims = [min([uncert.interp_E0(in); invstd.E0; uv.E0(1)])*0.975 <span class="keyword">...</span>
1241     max([uncert.interp_E0(in); invstd.E0; uv.E0(1)])*1.025];
1242 <span class="comment">% -- lines indicating TLGM and E0 bounds --</span>
1243 line([min(uncert.interp_Tlgm(in)) min(uncert.interp_Tlgm(in))],[ylims(1) ylims(2)],<span class="string">'Color'</span>,[0.25 0.25 0.25],<span class="keyword">...</span>
1244     <span class="string">'LineStyle'</span>,<span class="string">':'</span>,<span class="string">'LineWidth'</span>,0.75,<span class="string">'HandleVisibility'</span>,<span class="string">'off'</span>,<span class="string">'Parent'</span>,gui.axes11,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1245 line([max(uncert.interp_Tlgm(in)) max(uncert.interp_Tlgm(in))],[ylims(1) ylims(2)],<span class="string">'Color'</span>,[0.25 0.25 0.25],<span class="keyword">...</span>
1246     <span class="string">'LineStyle'</span>,<span class="string">':'</span>,<span class="string">'LineWidth'</span>,0.75,<span class="string">'HandleVisibility'</span>,<span class="string">'off'</span>,<span class="string">'Parent'</span>,gui.axes11,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1247 line([xlims(1) xlims(2)],[min(uncert.interp_E0(in)) min(uncert.interp_E0(in))],<span class="string">'Color'</span>,[0.25 0.25 0.25],<span class="keyword">...</span>
1248     <span class="string">'LineStyle'</span>,<span class="string">':'</span>,<span class="string">'LineWidth'</span>,0.75,<span class="string">'HandleVisibility'</span>,<span class="string">'off'</span>,<span class="string">'Parent'</span>,gui.axes11,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1249 line([xlims(1) xlims(2)],[max(uncert.interp_E0(in)) max(uncert.interp_E0(in))],<span class="string">'Color'</span>,[0.25 0.25 0.25],<span class="keyword">...</span>
1250     <span class="string">'LineStyle'</span>,<span class="string">':'</span>,<span class="string">'LineWidth'</span>,0.75,<span class="string">'HandleVisibility'</span>,<span class="string">'off'</span>,<span class="string">'Parent'</span>,gui.axes11,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1251 legend(gui.axes11,<span class="string">'Location'</span>,<span class="string">'NorthEast'</span>);
1252 <span class="comment">% axis settings</span>
1253 set(gui.axes11,<span class="string">'XScale'</span>,<span class="string">'lin'</span>,<span class="string">'XLim'</span>,xlims);
1254 set(gui.axes11,<span class="string">'YScale'</span>,<span class="string">'lin'</span>,<span class="string">'YLim'</span>,ylims);
1255 set(gui.axes11,<span class="string">'CLim'</span>,clims);
1256 set(get(gui.axes11,<span class="string">'XLabel'</span>),<span class="string">'String'</span>,<span class="string">'TLGM'</span>);
1257 set(get(gui.axes11,<span class="string">'YLabel'</span>),<span class="string">'String'</span>,<span class="string">'initial amplitude E0'</span>);
1258 
1259 <span class="comment">% --- RTDs ---</span>
1260 plotmethod = 1;
1261 <span class="keyword">switch</span> uv.rtd_plotstyle
1262     <span class="keyword">case</span> <span class="string">'patchmean'</span>
1263         plotmethod = 2;
1264     <span class="keyword">case</span> <span class="string">'patchmedian'</span>
1265         plotmethod = 3;
1266     <span class="keyword">otherwise</span>
1267         <span class="comment">% nothing to do because 'lines' is default</span>
1268 <span class="keyword">end</span>
1269 
1270 <span class="comment">% the 'init' RTD</span>
1271 F0 = invstd.T1T2f;
1272 <span class="comment">% normalize all curves to the median of all E0 values</span>
1273 E0norm = uv.E0_aadmed(1);
1274 <span class="keyword">if</span> sum(F0)&gt;0
1275     F = (data.invstd.porosity*100).*F0./E0norm;
1276     ylims = [0 max(F)*1.05];
1277 <span class="keyword">else</span>
1278     ylims = [-1 1];
1279 <span class="keyword">end</span>
1280 <span class="comment">% the uncertainty runs</span>
1281 <span class="comment">% only the selected ones within the chi2 and xn bounds</span>
1282 FDIST = uncert.interp_f(in,:);
1283 <span class="comment">% scaling</span>
1284 FDIST = (data.invstd.porosity*100).*FDIST./E0norm;
1285 
1286 <span class="comment">% if selected plot lines</span>
1287 <span class="keyword">if</span> plotmethod == 1
1288     <span class="comment">% find maximum for axis limts</span>
1289     f_max = max([ylims(2) max(FDIST(:))]);
1290     <span class="keyword">switch</span> uv.colorstyle
1291         <span class="keyword">case</span> {<span class="string">'chi2'</span>,<span class="string">'xn'</span>}
1292             <span class="comment">% get colormap from chi2 vs xn axis</span>
1293             cmap = get(gui.axes12,<span class="string">'Colormap'</span>);
1294             <span class="comment">% make vector of values to sort</span>
1295             idc = linspace(clims(1),clims(2),size(cmap,1));
1296             <span class="keyword">for</span> i1 = 1:sum(in)
1297                 <span class="comment">% find closest value (need for coloring)</span>
1298                 idc1 = find(abs(idc-tmp(idx(i1)))==min(abs(idc-tmp(idx(i1)))));
1299                 <span class="comment">% idc1 = abs(idc-tmp(idx(i1)))==min(abs(idc-tmp(idx(i1))));</span>
1300                 <span class="comment">% plot line with correct color</span>
1301                 plot(invstd.T1T2me,FDIST(idx(i1),:),<span class="string">'-'</span>,<span class="string">'Color'</span>,cmap(idc1(1),:),<span class="keyword">...</span>
1302                     <span class="string">'LineWidth'</span>,1,<span class="string">'Displayname'</span>,num2str(tmp(idx(i1))),<span class="string">'Parent'</span>,gui.axes2);
1303             <span class="keyword">end</span>
1304             <span class="comment">% adjust color limits</span>
1305             set(gui.axes2,<span class="string">'CLim'</span>,clims);
1306         <span class="keyword">otherwise</span>
1307             <span class="comment">% need to plot transpose of FDIST because 'x' is a column vector</span>
1308             <span class="comment">% otherwise plot goes bananas if numel(x) = #models</span>
1309             plot(invstd.T1T2me,FDIST',<span class="string">'-'</span>,<span class="string">'Color'</span>,[0.5 0.5 0.5],<span class="keyword">...</span>
1310                 <span class="string">'LineWidth'</span>,1,<span class="string">'Parent'</span>,gui.axes2);
1311     <span class="keyword">end</span>
1312 <span class="keyword">end</span>
1313 
1314 <span class="comment">% if selcted plot patch</span>
1315 <span class="keyword">if</span> plotmethod &gt; 1
1316     <span class="comment">% what kind of patch is created</span>
1317     <span class="keyword">if</span> plotmethod == 2 <span class="comment">% mean +- std</span>
1318         mean_f = mean(FDIST);
1319         std_f = std(FDIST);
1320     <span class="keyword">else</span> <span class="comment">% median +- mad</span>
1321         mean_f = median(FDIST);
1322         std_f = <a href="../../../nucleus/functions/inversion/getAAD.html" class="code" title="function aad = getAAD(x,flag,dim)">getAAD</a>(FDIST,1);
1323     <span class="keyword">end</span>
1324 
1325     <span class="comment">% patch lower and upper bounds</span>
1326     patch_f_std1 = [mean_f+std_f;mean_f-std_f];
1327     patch_f_std2 = [mean_f+2*std_f;mean_f-2*std_f];
1328     patch_f_std3 = [mean_f+3*std_f;mean_f-3*std_f];
1329     patch_f_std1(patch_f_std1&lt;0) = 0;
1330     patch_f_std2(patch_f_std2&lt;0) = 0;
1331     patch_f_std3(patch_f_std3&lt;0) = 0;
1332     f_max = max([ylims(2) max(patch_f_std1) max(patch_f_std2) max(patch_f_std3)]);
1333 
1334     <span class="comment">% draw all three patches on top of each other</span>
1335     verts = [invstd.T1T2me patch_f_std3(2,:)'; flipud(invstd.T1T2me) flipud(patch_f_std3(1,:)')];
1336     faces = 1:1:size(verts,1);
1337     patch(<span class="string">'Faces'</span>,faces,<span class="string">'Vertices'</span>,verts,<span class="string">'FaceColor'</span>,[0.6 0.6 0.6],<span class="keyword">...</span>
1338         <span class="string">'FaceAlpha'</span>,0.75,<span class="string">'EdgeColor'</span>,<span class="string">'none'</span>,<span class="string">'Parent'</span>,gui.axes2);
1339     verts = [invstd.T1T2me patch_f_std2(2,:)'; flipud(invstd.T1T2me) flipud(patch_f_std2(1,:)')];
1340     faces = 1:1:size(verts,1);
1341     patch(<span class="string">'Faces'</span>,faces,<span class="string">'Vertices'</span>,verts,<span class="string">'FaceColor'</span>,[0.4 0.4 0.4],<span class="keyword">...</span>
1342         <span class="string">'FaceAlpha'</span>,0.75,<span class="string">'EdgeColor'</span>,<span class="string">'none'</span>,<span class="string">'Parent'</span>,gui.axes2);
1343     verts = [invstd.T1T2me patch_f_std1(2,:)'; flipud(invstd.T1T2me) flipud(patch_f_std1(1,:)')];
1344     faces = 1:1:size(verts,1);
1345     patch(<span class="string">'Faces'</span>,faces,<span class="string">'Vertices'</span>,verts,<span class="string">'FaceColor'</span>,[0.2 0.2 0.2],<span class="keyword">...</span>
1346         <span class="string">'FaceAlpha'</span>,0.75,<span class="string">'EdgeColor'</span>,<span class="string">'none'</span>,<span class="string">'Parent'</span>,gui.axes2);
1347 <span class="keyword">end</span>
1348 
1349 <span class="comment">% adjust y-limits</span>
1350 ylims(2) = max([ylims(2) max(f_max)*1.05]);
1351 
1352 <span class="comment">% plot original solution</span>
1353 plot(invstd.T1T2me,F,<span class="string">'-'</span>,<span class="string">'Color'</span>,col.FIT,<span class="string">'Parent'</span>,gui.axes2);
1354 
1355 <span class="comment">% -- RTD bounds --</span>
1356 uv = data.uv;
1357 line([uv.rtd_range(1) uv.rtd_range(1)],[0 ylims(2)],<span class="string">'Color'</span>,[0.25 0.25 0.25],<span class="keyword">...</span>
1358     <span class="string">'LineStyle'</span>,<span class="string">'-.'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'Parent'</span>,gui.axes2,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1359 line([uv.rtd_range(2) uv.rtd_range(2)],[0 ylims(2)],<span class="string">'Color'</span>,[0.25 0.25 0.25],<span class="keyword">...</span>
1360     <span class="string">'LineStyle'</span>,<span class="string">'-.'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'Parent'</span>,gui.axes2,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1361 
1362 <span class="comment">% axes properties:</span>
1363 ticks = round(log10(min(invstd.T1T2me)) :1: log10(max(invstd.T1T2me)));
1364 set(gui.axes2,<span class="string">'XScale'</span>,<span class="string">'log'</span>,<span class="string">'XLim'</span>,[10^(ticks(1)) 10^(ticks(end))],<span class="string">'XTick'</span>,10.^ticks);
1365 set(gui.axes2,<span class="string">'YScale'</span>,<span class="string">'lin'</span>,<span class="string">'YLim'</span>,ylims);
1366 set(get(gui.axes2,<span class="string">'XLabel'</span>),<span class="string">'String'</span>,<span class="string">'relaxation time'</span>);
1367 set(get(gui.axes2,<span class="string">'YLabel'</span>),<span class="string">'String'</span>,<span class="string">'amplitude'</span>);
1368 grid(gui.axes2,<span class="string">'on'</span>);
1369 
1370 <span class="comment">% --- Histograms ---</span>
1371 [f1,xi1] = <a href="getKernelDensityEstimate.html" class="code" title="function [f,x] = getKernelDensityEstimate(y)">getKernelDensityEstimate</a>(uncert.interp_E0(in));
1372 [f2,xi2] = <a href="getKernelDensityEstimate.html" class="code" title="function [f,x] = getKernelDensityEstimate(y)">getKernelDensityEstimate</a>(uncert.interp_Tlgm(in));
1373 
1374 <span class="comment">% plot the KDEs</span>
1375 plot(xi1,f1,<span class="string">'Color'</span>,[0.5 0.5 0.5],<span class="string">'DisplayName'</span>,<span class="string">'KDE'</span>,<span class="string">'Parent'</span>,gui.axes21);
1376 plot(xi2,f2,<span class="string">'Color'</span>,[0.5 0.5 0.5],<span class="string">'DisplayName'</span>,<span class="string">'KDE'</span>,<span class="string">'Parent'</span>,gui.axes22);
1377 
1378 <span class="comment">% &quot;init&quot; E0</span>
1379 line([invstd.E0 invstd.E0],[0 max(f1)],<span class="string">'Color'</span>,col.FIT,<span class="keyword">...</span>
1380     <span class="string">'LineStyle'</span>,<span class="string">':'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'Parent'</span>,gui.axes21,<span class="string">'DisplayName'</span>,<span class="string">'init'</span>,<span class="keyword">...</span>
1381     <span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1382 <span class="comment">% &quot;init&quot; TLGM</span>
1383 line([invstd.Tlgm invstd.Tlgm],[0 max(f2)],<span class="string">'Color'</span>,col.FIT,<span class="keyword">...</span>
1384     <span class="string">'LineStyle'</span>,<span class="string">':'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'Parent'</span>,gui.axes22,<span class="string">'DisplayName'</span>,<span class="string">'init'</span>,<span class="keyword">...</span>
1385     <span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1386 
1387 <span class="comment">% mean E0</span>
1388 line([uv.E0(1) uv.E0(1)],[0 max(f1)],<span class="string">'Color'</span>,col.BoxPRC,<span class="keyword">...</span>
1389     <span class="string">'LineStyle'</span>,<span class="string">'-'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'Parent'</span>,gui.axes21,<span class="string">'DisplayName'</span>,<span class="string">'mean'</span>);
1390 line([uv.E0(1)+2*uv.E0(2) uv.E0(1)+2*uv.E0(2)],[0 max(f1)],<span class="string">'Color'</span>,col.BoxPRC,<span class="keyword">...</span>
1391     <span class="string">'LineStyle'</span>,<span class="string">'--'</span>,<span class="string">'LineWidth'</span>,1,<span class="string">'Parent'</span>,gui.axes21,<span class="string">'DisplayName'</span>,<span class="string">'2*std'</span>);
1392 line([uv.E0(1)-2*uv.E0(2) uv.E0(1)-2*uv.E0(2)],[0 max(f1)],<span class="string">'Color'</span>,col.BoxPRC,<span class="keyword">...</span>
1393     <span class="string">'LineStyle'</span>,<span class="string">'--'</span>,<span class="string">'LineWidth'</span>,1,<span class="string">'Parent'</span>,gui.axes21,<span class="string">'DisplayName'</span>,<span class="string">'2*std'</span>,<span class="keyword">...</span>
1394     <span class="string">'HandleVisibility'</span>,<span class="string">'off'</span>,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1395 
1396 <span class="comment">% mean TLGM</span>
1397 line([uv.Tlgm(1) uv.Tlgm(1)],[0 max(f2)],<span class="string">'Color'</span>,col.BoxPRC,<span class="keyword">...</span>
1398     <span class="string">'LineStyle'</span>,<span class="string">'-'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'Parent'</span>,gui.axes22,<span class="string">'DisplayName'</span>,<span class="string">'mean'</span>);
1399 line([uv.Tlgm(1)+2*uv.Tlgm(2) uv.Tlgm(1)+2*uv.Tlgm(2)],[0 max(f2)],<span class="string">'Color'</span>,col.BoxPRC,<span class="keyword">...</span>
1400     <span class="string">'LineStyle'</span>,<span class="string">'--'</span>,<span class="string">'LineWidth'</span>,1,<span class="string">'Parent'</span>,gui.axes22,<span class="string">'DisplayName'</span>,<span class="string">'2*std'</span>);
1401 line([uv.Tlgm(1)-2*uv.Tlgm(2) uv.Tlgm(1)-2*uv.Tlgm(2)],[0 max(f2)],<span class="string">'Color'</span>,col.BoxPRC,<span class="keyword">...</span>
1402     <span class="string">'LineStyle'</span>,<span class="string">'--'</span>,<span class="string">'LineWidth'</span>,1,<span class="string">'Parent'</span>,gui.axes22,<span class="string">'DisplayName'</span>,<span class="string">'2*std'</span>,<span class="keyword">...</span>
1403     <span class="string">'HandleVisibility'</span>,<span class="string">'off'</span>,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1404 
1405 <span class="comment">% median E0</span>
1406 line([uv.E0_aadmed(1) uv.E0_aadmed(1)],[0 max(f1)],<span class="string">'Color'</span>,col.BoxCPS,<span class="keyword">...</span>
1407     <span class="string">'LineStyle'</span>,<span class="string">'-'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'Parent'</span>,gui.axes21,<span class="string">'DisplayName'</span>,<span class="string">'median'</span>);
1408 line([uv.E0_aadmed(1)+2*uv.E0_aadmed(2) uv.E0_aadmed(1)+2*uv.E0_aadmed(2)],<span class="keyword">...</span>
1409     [0 max(f1)],<span class="string">'Color'</span>,col.BoxCPS,<span class="string">'LineStyle'</span>,<span class="string">'--'</span>,<span class="string">'LineWidth'</span>,1,<span class="keyword">...</span>
1410     <span class="string">'Parent'</span>,gui.axes21,<span class="string">'DisplayName'</span>,<span class="string">'2*aad'</span>);
1411 line([uv.E0_aadmed(1)-2*uv.E0_aadmed(2) uv.E0_aadmed(1)-2*uv.E0_aadmed(2)],<span class="keyword">...</span>
1412     [0 max(f1)],<span class="string">'Color'</span>,col.BoxCPS,<span class="string">'LineStyle'</span>,<span class="string">'--'</span>,<span class="string">'LineWidth'</span>,1,<span class="keyword">...</span>
1413     <span class="string">'Parent'</span>,gui.axes21,<span class="string">'DisplayName'</span>,<span class="string">'2*aad'</span>,<span class="string">'HandleVisibility'</span>,<span class="string">'off'</span>,<span class="keyword">...</span>
1414     <span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1415 
1416 <span class="comment">% median TLGM</span>
1417 line([uv.Tlgm_aadmed(1) uv.Tlgm_aadmed(1)],[0 max(f2)],<span class="string">'Color'</span>,col.BoxCPS,<span class="keyword">...</span>
1418     <span class="string">'LineStyle'</span>,<span class="string">'-'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'Parent'</span>,gui.axes22,<span class="string">'DisplayName'</span>,<span class="string">'median'</span>);
1419 line([uv.Tlgm_aadmed(1)+2*uv.Tlgm_aadmed(2) uv.Tlgm_aadmed(1)+2*uv.Tlgm_aadmed(2)],<span class="keyword">...</span>
1420     [0 max(f2)],<span class="string">'Color'</span>,col.BoxCPS,<span class="string">'LineStyle'</span>,<span class="string">'--'</span>,<span class="string">'LineWidth'</span>,1,<span class="keyword">...</span>
1421     <span class="string">'Parent'</span>,gui.axes22,<span class="string">'DisplayName'</span>,<span class="string">'2*aad'</span>);
1422 line([uv.Tlgm_aadmed(1)-2*uv.Tlgm_aadmed(2) uv.Tlgm_aadmed(1)-2*uv.Tlgm_aadmed(2)],<span class="keyword">...</span>
1423     [0 max(f2)],<span class="string">'Color'</span>,col.BoxCPS,<span class="string">'LineStyle'</span>,<span class="string">'--'</span>,<span class="string">'LineWidth'</span>,1,<span class="keyword">...</span>
1424     <span class="string">'Parent'</span>,gui.axes22,<span class="string">'DisplayName'</span>,<span class="string">'2*aad'</span>,<span class="string">'HandleVisibility'</span>,<span class="string">'off'</span>,<span class="keyword">...</span>
1425     <span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1426 
1427 legend(gui.axes22,<span class="string">'Location'</span>,<span class="string">'NorthWest'</span>);
1428 
1429 <span class="comment">% axes properties</span>
1430 set(get(gui.axes21,<span class="string">'XLabel'</span>),<span class="string">'String'</span>,<span class="string">'E0'</span>);
1431 set(get(gui.axes21,<span class="string">'YLabel'</span>),<span class="string">'String'</span>,<span class="string">'kernel denisty estimate'</span>);
1432 set(get(gui.axes22,<span class="string">'XLabel'</span>),<span class="string">'String'</span>,<span class="string">'TLGM'</span>);
1433 set(get(gui.axes22,<span class="string">'YLabel'</span>),<span class="string">'String'</span>,<span class="string">'kernel density estimate'</span>);
1434 
1435 <span class="comment">% hold off all axes</span>
1436 hold(gui.axes11,<span class="string">'off'</span>);
1437 hold(gui.axes12,<span class="string">'off'</span>);
1438 hold(gui.axes2,<span class="string">'off'</span>);
1439 hold(gui.axes21,<span class="string">'off'</span>);
1440 hold(gui.axes22,<span class="string">'off'</span>);
1441 <span class="keyword">end</span>
1442 
1443 <span class="comment">%% close function</span>
1444 <a name="_sub12" href="#_subfunctions" class="code">function uv_closeme(src,~)</a>
1445 figh = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
1446 <span class="comment">% try to close the sub GUI in a clean manner</span>
1447 <span class="keyword">try</span>
1448     <span class="comment">% NOTE: maybe needed at some later point</span>
1449     <span class="comment">%     gui = getappdata(figh,'gui');</span>
1450     <span class="comment">%     data = getappdata(gui.figh_nucleus,'data');</span>
1451     <span class="comment">%     % update NUCLEUSinv</span>
1452     <span class="comment">%     setappdata(gui.figh_nucleus,'data',data);</span>
1453     delete(figh);
1454 <span class="keyword">catch</span>
1455     <span class="comment">% if this is not working: just close it</span>
1456     delete(figh);
1457 <span class="keyword">end</span>
1458 
1459 <span class="keyword">end</span>
1460 
1461 <span class="comment">%------------- END OF CODE --------------</span>
1462 
1463 <span class="comment">%% License:</span>
1464 <span class="comment">% MIT License</span>
1465 <span class="comment">%</span>
1466 <span class="comment">% Copyright (c) 2024 Thomas Hiller</span>
1467 <span class="comment">%</span>
1468 <span class="comment">% Permission is hereby granted, free of charge, to any person obtaining a copy</span>
1469 <span class="comment">% of this software and associated documentation files (the &quot;Software&quot;), to deal</span>
1470 <span class="comment">% in the Software without restriction, including without limitation the rights</span>
1471 <span class="comment">% to use, copy, modify, merge, publish, distribute, sublicense, and/or sell</span>
1472 <span class="comment">% copies of the Software, and to permit persons to whom the Software is</span>
1473 <span class="comment">% furnished to do so, subject to the following conditions:</span>
1474 <span class="comment">%</span>
1475 <span class="comment">% The above copyright notice and this permission notice shall be included in all</span>
1476 <span class="comment">% copies or substantial portions of the Software.</span>
1477 <span class="comment">%</span>
1478 <span class="comment">% THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
1479 <span class="comment">% IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
1480 <span class="comment">% FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span>
1481 <span class="comment">% AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span>
1482 <span class="comment">% LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span>
1483 <span class="comment">% OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE</span>
1484 <span class="comment">% SOFTWARE.</span></pre></div>
<hr><address>Generated by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>