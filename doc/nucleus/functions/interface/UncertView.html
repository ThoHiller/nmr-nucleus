<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of UncertView</title>
  <meta name="keywords" content="UncertView">
  <meta name="description" content=" is an extra subGUI to show results of the uncertainty">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- # nucleus --><!-- # functions --><!-- menu.html interface -->
<h1>UncertView
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong> is an extra subGUI to show results of the uncertainty</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function UncertView(src,~) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment">UncertView is an extra subGUI to show results of the uncertainty
calculation

 Syntax:
       UncertView

 Inputs:
       src - handle of the calling object

 Outputs:
       none

 Example:
       UncertView(src,~)

 Other m-files required:
       beautifyAxes
       clearAllAxes
       estimateUncertainty
       createKernelMatrix
       updatePlotsSignal
       updatePlotsDistribution
       updateInfo

 Subfunctions:
       uv_closeme
       uv_onEditValue
       uv_updateMASK
       uv_onPushRun
       uv_onPushUpdate
       uv_onPushReset
       uv_updateInformation
       uv_updatePlots

 MAT-files required:
       none

 See also: NUCLEUSinv
 Author: see AUTHORS.md
 email: see AUTHORS.md
 License: MIT License (at end)</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="../../../nucleus/callbacks/menus/onMenuView.html" class="code" title="function onMenuView(src,~)">onMenuView</a>	 handles the view menu entries</li><li><a href="beautifyAxes.html" class="code" title="function beautifyAxes(figh)">beautifyAxes</a>	 can be used to globally change the general appearance of axes</li><li><a href="clearAllAxes.html" class="code" title="function clearAllAxes(figh)">clearAllAxes</a>	 clears all axes of a given figure</li><li><a href="getKernelDensityEstimate.html" class="code" title="function [f,x] = getKernelDensityEstimate(y)">getKernelDensityEstimate</a>	 computes the one dimensional kernel density estimate</li><li><a href="minimizePanel.html" class="code" title="function minimizePanel(src,~)">minimizePanel</a>	 handles the minimization/maximization of all box-panels for</li><li><a href="updateInfo.html" class="code" title="function updateInfo(src,~) %#ok<INUSD>">updateInfo</a>	 updates the information shown in all information list boxes</li><li><a href="updatePlotsDistribution.html" class="code" title="function updatePlotsDistribution">updatePlotsDistribution</a>	 plots the RTD and PSD curves into NUCLEUSinv</li><li><a href="updatePlotsSignal.html" class="code" title="function updatePlotsSignal">updatePlotsSignal</a>	 plots the raw and processed NMR signals in NUCLEUSinv</li><li><a href="../../../nucleus/functions/inversion/createKernelMatrix.html" class="code" title="function K = createKernelMatrix(t,T,Tbulk,Tdiff,Tflag,T1IRfac)">createKernelMatrix</a>	 creates a Kernel matrix from signal time vector "t"</li><li><a href="../../../nucleus/functions/inversion/estimateUncertainty.html" class="code" title="function [invstd,uncert] = estimateUncertainty(invtype,invstd,iparam,parameter)">estimateUncertainty</a>	 calculates pseudo uncertainty estimates for multi</li><li><a href="../../../nucleus/functions/inversion/getAAD.html" class="code" title="function aad = getAAD(x,flag,dim)">getAAD</a>	 gets the average absolute deviation from the values in x</li><li><a href="../../../nucleus/functions/inversion/getUncertaintyStatistics.html" class="code" title="function out = getUncertaintyStatistics(T,RTDs,range,K0)">getUncertaintyStatistics</a>	</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="../../../nucleus/callbacks/listboxes/onListboxData.html" class="code" title="function onListboxData(src,~)">onListboxData</a>	 handles the calls from the context menu of the data</li><li><a href="../../../nucleus/callbacks/menus/onMenuSubGUIs.html" class="code" title="function onMenuSubGUIs(src,~)">onMenuSubGUIs</a>	 handles the extra menu entries to open NUCLEUS sub GUIs</li><li><a href="../../../nucleus/functions/inversion/runUncertaintyCalculation.html" class="code" title="function runUncertaintyCalculation">runUncertaintyCalculation</a>	 caluclates inverison statistics in some kind of</li></ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function uv_onEditValue(src,~)</a></li><li><a href="#_sub2" class="code">function uv_onPushSend(src,~)</a></li><li><a href="#_sub3" class="code">function uv_onContextPlotsColor(src,~)</a></li><li><a href="#_sub4" class="code">function uv_onContextPlotsRTD(src,~)</a></li><li><a href="#_sub5" class="code">function data = uv_updateMASK(data)</a></li><li><a href="#_sub6" class="code">function uv_onPopupMethod(src,~)</a></li><li><a href="#_sub7" class="code">function uv_onPushRun(src,~)</a></li><li><a href="#_sub8" class="code">function uv_onPushView(src,~)</a></li><li><a href="#_sub9" class="code">function uv_onPushUpdate(src,~)</a></li><li><a href="#_sub10" class="code">function uv_onPushReset(src,~)</a></li><li><a href="#_sub11" class="code">function uv_updateInformation(figh)</a></li><li><a href="#_sub12" class="code">function uv_updatePlots(figh)</a></li><li><a href="#_sub13" class="code">function uv_closeme(src,~)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function UncertView(src,~)</a>
0002 <span class="comment">%UncertView is an extra subGUI to show results of the uncertainty</span>
0003 <span class="comment">%calculation</span>
0004 <span class="comment">%</span>
0005 <span class="comment">% Syntax:</span>
0006 <span class="comment">%       UncertView</span>
0007 <span class="comment">%</span>
0008 <span class="comment">% Inputs:</span>
0009 <span class="comment">%       src - handle of the calling object</span>
0010 <span class="comment">%</span>
0011 <span class="comment">% Outputs:</span>
0012 <span class="comment">%       none</span>
0013 <span class="comment">%</span>
0014 <span class="comment">% Example:</span>
0015 <span class="comment">%       UncertView(src,~)</span>
0016 <span class="comment">%</span>
0017 <span class="comment">% Other m-files required:</span>
0018 <span class="comment">%       beautifyAxes</span>
0019 <span class="comment">%       clearAllAxes</span>
0020 <span class="comment">%       estimateUncertainty</span>
0021 <span class="comment">%       createKernelMatrix</span>
0022 <span class="comment">%       updatePlotsSignal</span>
0023 <span class="comment">%       updatePlotsDistribution</span>
0024 <span class="comment">%       updateInfo</span>
0025 <span class="comment">%</span>
0026 <span class="comment">% Subfunctions:</span>
0027 <span class="comment">%       uv_closeme</span>
0028 <span class="comment">%       uv_onEditValue</span>
0029 <span class="comment">%       uv_updateMASK</span>
0030 <span class="comment">%       uv_onPushRun</span>
0031 <span class="comment">%       uv_onPushUpdate</span>
0032 <span class="comment">%       uv_onPushReset</span>
0033 <span class="comment">%       uv_updateInformation</span>
0034 <span class="comment">%       uv_updatePlots</span>
0035 <span class="comment">%</span>
0036 <span class="comment">% MAT-files required:</span>
0037 <span class="comment">%       none</span>
0038 <span class="comment">%</span>
0039 <span class="comment">% See also: NUCLEUSinv</span>
0040 <span class="comment">% Author: see AUTHORS.md</span>
0041 <span class="comment">% email: see AUTHORS.md</span>
0042 <span class="comment">% License: MIT License (at end)</span>
0043 
0044 <span class="comment">%------------- BEGIN CODE --------------</span>
0045 
0046 <span class="comment">%% get GUI handle and data</span>
0047 figh_nucleus = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
0048 nucleus.data = getappdata(figh_nucleus,<span class="string">'data'</span>);
0049 nucleus.gui = getappdata(figh_nucleus,<span class="string">'gui'</span>);
0050 myui = nucleus.gui.myui;
0051 colors = myui.colors;
0052 
0053 hasUncert = false;
0054 <span class="keyword">if</span> isfield(nucleus.data.results,<span class="string">'invstd'</span>)
0055     <span class="keyword">if</span> isfield(nucleus.data.results.invstd,<span class="string">'uncert'</span>)
0056         hasUncert = true;
0057     <span class="keyword">end</span>
0058 <span class="keyword">end</span>
0059 
0060 <span class="comment">%% proceed only if there is already uncertainty data</span>
0061 <span class="keyword">if</span> hasUncert
0062     nucleus_data = nucleus.data;
0063 
0064     <span class="comment">% check if the figure is already open</span>
0065     fig_uncert = findobj(<span class="string">'Tag'</span>,<span class="string">'UNCERTVIEW'</span>);
0066     <span class="comment">% if not, create it</span>
0067     <span class="keyword">if</span> isempty(fig_uncert)
0068         <span class="comment">% draw the figure on top of NUCLEUSinv</span>
0069         fig_uncert = figure(<span class="string">'Name'</span>,<span class="string">'NUCLEUSinv - RTD Uncertainty'</span>,<span class="keyword">...</span>
0070             <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>,<span class="string">'Resize'</span>,<span class="string">'on'</span>,<span class="string">'ToolBar'</span>,<span class="string">'none'</span>,<span class="keyword">...</span>
0071             <span class="string">'CloseRequestFcn'</span>,@<a href="#_sub13" class="code" title="subfunction uv_closeme(src,~)">uv_closeme</a>,<span class="keyword">...</span>
0072             <span class="string">'MenuBar'</span>,<span class="string">'none'</span>,<span class="string">'Tag'</span>,<span class="string">'UNCERTVIEW'</span>);
0073         pos0 = get(figh_nucleus,<span class="string">'Position'</span>);
0074         cent(1) = (pos0(1)+pos0(3)/2);
0075         cent(2) = (pos0(2)+pos0(4)/2);
0076         <span class="comment">% posf = [cent(1)-pos0(3)/3 pos0(2)+22 pos0(3)/1.5 pos0(4)-22];</span>
0077         posf = [cent(1)-pos0(3)/2.5 pos0(2)+22 pos0(3)/1.25 pos0(4)-22];
0078         set(fig_uncert,<span class="string">'Position'</span>,posf);
0079 
0080         gui.menu.view = uimenu(fig_uncert,<span class="string">'Label'</span>,<span class="string">'View'</span>);
0081         gui.menu.view_toolbar = uimenu(gui.menu.view,<span class="string">'Label'</span>,<span class="string">'Figure Toolbar'</span>,<span class="keyword">...</span>
0082         <span class="string">'Callback'</span>,@<a href="../../../nucleus/callbacks/menus/onMenuView.html" class="code" title="function onMenuView(src,~)">onMenuView</a>);
0083 
0084         cpanel_w = 175;
0085 
0086         <span class="comment">% create the main layout</span>
0087         gui.main = uix.HBox(<span class="string">'Parent'</span>,fig_uncert,<span class="string">'BackGroundColor'</span>,colors.panelBG,<span class="keyword">...</span>
0088             <span class="string">'Spacing'</span>,5,<span class="string">'Padding'</span>,5,<span class="string">'Visible'</span>,<span class="string">'off'</span>);
0089         gui.left = uix.VBox(<span class="string">'Parent'</span>,gui.main,<span class="string">'BackGroundColor'</span>,colors.panelBG,<span class="keyword">...</span>
0090             <span class="string">'Spacing'</span>,5,<span class="string">'Padding'</span>,0); <span class="comment">% controls</span>
0091         gui.right = uix.VBox(<span class="string">'Parent'</span>,gui.main,<span class="string">'BackGroundColor'</span>,colors.panelBG,<span class="keyword">...</span>
0092             <span class="string">'Spacing'</span>,5,<span class="string">'Padding'</span>,0); <span class="comment">% plots</span>
0093 
0094         set(gui.main,<span class="string">'Widths'</span>,[350 -1 ]);
0095 
0096         <span class="comment">% waitbar indicating the loading of the GUI</span>
0097         steps = 5;
0098         hwb = waitbar(0,<span class="string">'loading ...'</span>,<span class="string">'Name'</span>,<span class="string">'UncertView initialization'</span>,<span class="string">'Visible'</span>,<span class="string">'off'</span>);
0099         set(hwb,<span class="string">'Units'</span>,<span class="string">'Pixel'</span>)
0100         posw = get(hwb,<span class="string">'Position'</span>);
0101         set(hwb,<span class="string">'Position'</span>,[posf(1)+posf(3)/2-posw(3)/2 posf(2)+posf(4)/2-posw(4)/2 posw(3:4)]);
0102         set(hwb,<span class="string">'Visible'</span>,<span class="string">'on'</span>);
0103 
0104         <span class="comment">% --- control panel ---</span>
0105         waitbar(1/steps,hwb,<span class="string">'loading GUI elements - control'</span>);
0106         gui.panels.control.main = uix.BoxPanel(<span class="string">'Parent'</span>,gui.left,<span class="keyword">...</span>
0107             <span class="string">'Title'</span>,<span class="string">'Recalculate RTD Uncertainty'</span>,<span class="string">'MinimizeFcn'</span>,@<a href="minimizePanel.html" class="code" title="function minimizePanel(src,~)">minimizePanel</a>,<span class="keyword">...</span>
0108             <span class="string">'TitleColor'</span>,colors.BoxINV,<span class="string">'ForegroundColor'</span>,colors.BoxTitle);
0109         gui.panels.control.VBox = uix.VBox(<span class="string">'Parent'</span>,gui.panels.control.main,<span class="keyword">...</span>
0110             <span class="string">'Spacing'</span>,3,<span class="string">'Padding'</span>,3);
0111         <span class="comment">% uncertainty method</span>
0112         gui.panels.control.HBox1 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.control.VBox,<span class="keyword">...</span>
0113             <span class="string">'Spacing'</span>,3);
0114         gui.text_handles.uncertMethod = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox1,<span class="keyword">...</span>
0115             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0116             <span class="string">'String'</span>,<span class="string">'Method'</span>);
0117         tstr = [<span class="string">'&lt;HTML&gt;Choose the uncertainty calculation method.&lt;br&gt;&lt;br&gt;'</span>,<span class="keyword">...</span>
0118             <span class="string">'&lt;u&gt;Available options:&lt;/u&gt;&lt;br&gt;'</span>,<span class="keyword">...</span>
0119             <span class="string">'&lt;font color=&quot;red&quot;&gt;Multi exp. (LSQ) | Multi exp. (LU decomp.):&lt;br&gt;'</span>,<span class="keyword">...</span>
0120             <span class="string">'&lt;font color=&quot;black&quot;&gt;'</span>,<span class="keyword">...</span>
0121             <span class="string">'&lt;b&gt;RMS - unbounded&lt;/b&gt; Keep all uncert models.&lt;br&gt;'</span>,<span class="keyword">...</span>
0122             <span class="string">'&lt;b&gt;RMS - bounded&lt;/b&gt; Only keep models within Lm and chi2 bounds.&lt;br&gt;'</span>,<span class="keyword">...</span>
0123             <span class="string">'&lt;font color=&quot;red&quot;&gt;Multi modal:&lt;br&gt;'</span>,<span class="keyword">...</span>
0124             <span class="string">'&lt;font color=&quot;black&quot;&gt;'</span>,<span class="keyword">...</span>
0125             <span class="string">'&lt;b&gt;RMS - unbounded&lt;/b&gt; Keep all uncert models.&lt;br&gt;'</span>,<span class="keyword">...</span>
0126             <span class="string">'&lt;b&gt;RMS - bounded&lt;/b&gt; Only keep models within Lm and chi2 bounds.&lt;br&gt;'</span>,<span class="keyword">...</span>
0127             <span class="string">'&lt;b&gt;Threshold&lt;/b&gt; Vary fit parameter by threshold.&lt;br&gt;'</span>,<span class="keyword">...</span>
0128             <span class="string">'&lt;b&gt;Conf. Interval&lt;/b&gt; Vary fit parameter randomly within confidence interval.&lt;br&gt;&lt;br&gt;'</span>,<span class="keyword">...</span>
0129             <span class="string">'&lt;u&gt;Default value:&lt;/u&gt;&lt;br&gt;'</span>,<span class="keyword">...</span>
0130             <span class="string">'&lt;b&gt;RMS - bounded&lt;/b&gt;&lt;br&gt;'</span>];
0131         gui.popup_handles.uncertMethod = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox1,<span class="keyword">...</span>
0132             <span class="string">'Style'</span>,<span class="string">'popup'</span>,<span class="string">'String'</span>,{<span class="string">'RMS - unbounded'</span>,<span class="string">'RMS - bounded'</span>},<span class="keyword">...</span>
0133             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0134             <span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'control'</span>,<span class="string">'Callback'</span>,@<a href="#_sub6" class="code" title="subfunction uv_onPopupMethod(src,~)">uv_onPopupMethod</a>);
0135         set(gui.panels.control.HBox1,<span class="string">'Widths'</span>,[cpanel_w -1]);
0136         <span class="comment">% number of uncertainty models</span>
0137         gui.panels.control.HBox2 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.control.VBox,<span class="keyword">...</span>
0138             <span class="string">'Spacing'</span>,3);        
0139         gui.text_handles.uncertN = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox2,<span class="keyword">...</span>
0140             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0141             <span class="string">'String'</span>,<span class="string">'#models'</span>);
0142         uix.Empty(<span class="string">'Parent'</span>,gui.panels.control.HBox2);
0143         tstr = <span class="string">'Number of uncertainty models to calculate.'</span>;
0144         gui.edit_handles.uncertN = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox2,<span class="keyword">...</span>
0145             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'uncertN'</span>,<span class="keyword">...</span>
0146             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0147             <span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0148         set(gui.panels.control.HBox2,<span class="string">'Widths'</span>,[cpanel_w -1 -1]);
0149         <span class="comment">% bound1: chi2 range</span>
0150         gui.panels.control.HBox3 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.control.VBox,<span class="keyword">...</span>
0151             <span class="string">'Spacing'</span>,3);
0152         gui.text_handles.uncertchi2 = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox3,<span class="keyword">...</span>
0153             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0154             <span class="string">'String'</span>,[char(hex2dec(<span class="string">'03A7'</span>)),char(hex2dec(<span class="string">'00B2'</span>)),<span class="keyword">...</span>
0155             <span class="string">' range          min | max'</span>]);
0156         tstr = <span class="string">'Lower bound of chi2 range.'</span>;
0157         gui.edit_handles.uncertchi2_min = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox3,<span class="keyword">...</span>
0158             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'control'</span>,<span class="keyword">...</span>
0159             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0160             <span class="string">'Enable'</span>,<span class="string">'off'</span>,<span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0161         tstr = <span class="string">'Upper bound of chi2 range.'</span>;
0162         gui.edit_handles.uncertchi2_max = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox3,<span class="keyword">...</span>
0163             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'control'</span>,<span class="keyword">...</span>
0164             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0165             <span class="string">'Enable'</span>,<span class="string">'off'</span>,<span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0166         set(gui.panels.control.HBox3,<span class="string">'Widths'</span>,[cpanel_w -1 -1]);
0167         <span class="comment">% bound2: model norm range</span>
0168         gui.panels.control.HBox4 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.control.VBox,<span class="keyword">...</span>
0169             <span class="string">'Spacing'</span>,3);
0170         gui.text_handles.uncertmnorm = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox4,<span class="keyword">...</span>
0171             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0172             <span class="string">'String'</span>,[<span class="string">'|Lm|'</span>,char(hex2dec(<span class="string">'2082'</span>)),<span class="string">' range      min | max'</span>]);
0173         tstr = <span class="string">'Lower bound of model norm range.'</span>;
0174         gui.edit_handles.uncertmnorm_min = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox4,<span class="keyword">...</span>
0175             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'control'</span>,<span class="keyword">...</span>
0176             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0177             <span class="string">'Enable'</span>,<span class="string">'off'</span>,<span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0178         tstr = <span class="string">'Upper bound of model norm range.'</span>;
0179         gui.edit_handles.uncertmnorm_max = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox4,<span class="keyword">...</span>
0180             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'control'</span>,<span class="keyword">...</span>
0181             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0182             <span class="string">'Enable'</span>,<span class="string">'off'</span>,<span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0183         set(gui.panels.control.HBox4,<span class="string">'Widths'</span>,[cpanel_w -1 -1]);
0184         <span class="comment">% bound3: threshold</span>
0185         gui.panels.control.HBox5 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.control.VBox,<span class="keyword">...</span>
0186             <span class="string">'Spacing'</span>,3);
0187         gui.text_handles.uncertThresh = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox5,<span class="keyword">...</span>
0188             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0189             <span class="string">'String'</span>,<span class="string">'Threshold   |   Max. #tries'</span>);
0190         <span class="comment">% uix.Empty('Parent',gui.panels.control.HBox5);</span>
0191         tstr = <span class="string">'Threshold value (0.05 = 5%).'</span>;
0192         gui.edit_handles.uncertThresh = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox5,<span class="keyword">...</span>
0193             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'uncertThresh'</span>,<span class="keyword">...</span>
0194             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0195             <span class="string">'Enable'</span>,<span class="string">'off'</span>,<span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0196         <span class="comment">% set(gui.panels.control.HBox5,'Widths',[cpanel_w -1 -1]);</span>
0197         <span class="comment">% max tries</span>
0198         <span class="comment">% gui.panels.control.HBox6 = uix.HBox('Parent',gui.panels.control.VBox,...</span>
0199         <span class="comment">%     'Spacing',3);</span>
0200         <span class="comment">% gui.text_handles.uncertMax = uicontrol('Parent',gui.panels.control.HBox6,...</span>
0201         <span class="comment">%     'Style','text','FontSize',myui.fontsize,'HorizontalAlignment','center',...</span>
0202         <span class="comment">%     'String','Max. #tries');</span>
0203         <span class="comment">% uix.Empty('Parent',gui.panels.control.HBox6);</span>
0204         tstr = <span class="string">'Maximum number of unsuccesful tries.'</span>;
0205         gui.edit_handles.uncertMax = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox5,<span class="keyword">...</span>
0206             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'uncertMax'</span>,<span class="keyword">...</span>
0207             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0208             <span class="string">'Enable'</span>,<span class="string">'off'</span>,<span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0209         set(gui.panels.control.HBox5,<span class="string">'Widths'</span>,[cpanel_w -1 -1]);
0210         <span class="comment">% RUN button</span>
0211         gui.panels.control.HBox7 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.control.VBox,<span class="keyword">...</span>
0212             <span class="string">'Spacing'</span>,3);
0213         <span class="comment">% uix.Empty('Parent',gui.panels.control.HBox7);</span>
0214         uix.Empty(<span class="string">'Parent'</span>,gui.panels.control.HBox7);
0215         tstr = [<span class="string">'&lt;HTML&gt;RUN uncertainty calculation.&lt;br&gt;'</span>,<span class="keyword">...</span>
0216             <span class="string">'Regularization is the same as in main NUCLEUSinv GUI.'</span>];
0217         gui.push_handles.run = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox7,<span class="keyword">...</span>
0218             <span class="string">'String'</span>,<span class="string">'RUN UNCERT. CALC.'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'process'</span>,<span class="keyword">...</span>
0219             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0220             <span class="string">'BackGroundColor'</span>,<span class="string">'g'</span>,<span class="string">'Callback'</span>,@<a href="#_sub7" class="code" title="subfunction uv_onPushRun(src,~)">uv_onPushRun</a>);
0221         set(gui.panels.control.HBox7,<span class="string">'Widths'</span>,[cpanel_w -1]);
0222 
0223         <span class="comment">% --- process panel ---</span>
0224         waitbar(2/steps,hwb,<span class="string">'loading GUI elements - process'</span>);
0225         gui.panels.process.main = uix.BoxPanel(<span class="string">'Parent'</span>,gui.left,<span class="keyword">...</span>
0226             <span class="string">'Title'</span>,<span class="string">'Process Uncertainty Runs'</span>,<span class="string">'MinimizeFcn'</span>,@<a href="minimizePanel.html" class="code" title="function minimizePanel(src,~)">minimizePanel</a>,<span class="keyword">...</span>
0227             <span class="string">'TitleColor'</span>,colors.BoxINV,<span class="string">'ForegroundColor'</span>,colors.BoxTitle);
0228         gui.panels.process.VBox = uix.VBox(<span class="string">'Parent'</span>,gui.panels.process.main,<span class="keyword">...</span>
0229             <span class="string">'Spacing'</span>,3,<span class="string">'Padding'</span>,3);
0230         <span class="comment">% chi2 range</span>
0231         gui.panels.process.HBox1 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.process.VBox,<span class="keyword">...</span>
0232             <span class="string">'Spacing'</span>,3);
0233         gui.text_handles.chi2 = uicontrol(<span class="string">'Parent'</span>,gui.panels.process.HBox1,<span class="keyword">...</span>
0234             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0235             <span class="string">'String'</span>,[char(hex2dec(<span class="string">'03A7'</span>)),char(hex2dec(<span class="string">'00B2'</span>)),<span class="keyword">...</span>
0236             <span class="string">' range          min | max'</span>]);
0237         tstr = <span class="string">'Lower bound of chi2 range.'</span>;
0238         gui.edit_handles.chi2_min = uicontrol(<span class="string">'Parent'</span>,gui.panels.process.HBox1,<span class="keyword">...</span>
0239             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'process'</span>,<span class="keyword">...</span>
0240             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0241             <span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0242         tstr = <span class="string">'Upper bound of chi2 range.'</span>;
0243         gui.edit_handles.chi2_max = uicontrol(<span class="string">'Parent'</span>,gui.panels.process.HBox1,<span class="keyword">...</span>
0244             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'2'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'process'</span>,<span class="keyword">...</span>
0245             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0246             <span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0247         set(gui.panels.process.HBox1,<span class="string">'Widths'</span>,[cpanel_w -1 -1]);
0248         <span class="comment">% model norm range</span>
0249         gui.panels.process.HBox2 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.process.VBox,<span class="keyword">...</span>
0250             <span class="string">'Spacing'</span>,3);
0251         gui.text_handles.mnorm = uicontrol(<span class="string">'Parent'</span>,gui.panels.process.HBox2,<span class="keyword">...</span>
0252             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0253             <span class="string">'String'</span>,[<span class="string">'|Lm|'</span>,char(hex2dec(<span class="string">'2082'</span>)),<span class="string">' range      min | max'</span>]);
0254         tstr = <span class="string">'Lower bound of model norm range.'</span>;
0255         gui.edit_handles.mnorm_min = uicontrol(<span class="string">'Parent'</span>,gui.panels.process.HBox2,<span class="keyword">...</span>
0256             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'process'</span>,<span class="keyword">...</span>
0257             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0258             <span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0259         tstr = <span class="string">'Upper bound of model norm range.'</span>;
0260         gui.edit_handles.mnorm_max = uicontrol(<span class="string">'Parent'</span>,gui.panels.process.HBox2,<span class="keyword">...</span>
0261             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'2'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'process'</span>,<span class="keyword">...</span>
0262             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0263             <span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0264         set(gui.panels.process.HBox2,<span class="string">'Widths'</span>,[cpanel_w -1 -1]);
0265         <span class="comment">% RESET button</span>
0266         gui.panels.process.HBox3 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.process.VBox,<span class="keyword">...</span>
0267             <span class="string">'Spacing'</span>,3);
0268         uix.Empty(<span class="string">'Parent'</span>,gui.panels.process.HBox3);
0269         tstr = <span class="string">'SEND bounds to recaluclation panel above.'</span>;
0270         gui.push_handles.send = uicontrol(<span class="string">'Parent'</span>,gui.panels.process.HBox3,<span class="keyword">...</span>
0271             <span class="string">'String'</span>,<span class="string">'USE'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'process'</span>,<span class="keyword">...</span>
0272             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0273             <span class="string">'Callback'</span>,@<a href="#_sub2" class="code" title="subfunction uv_onPushSend(src,~)">uv_onPushSend</a>);
0274         tstr = <span class="string">'RESET processing bounds and plots.'</span>;
0275         gui.push_handles.reset = uicontrol(<span class="string">'Parent'</span>,gui.panels.process.HBox3,<span class="keyword">...</span>
0276             <span class="string">'String'</span>,<span class="string">'RESET'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'process'</span>,<span class="keyword">...</span>
0277             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0278             <span class="string">'Callback'</span>,@<a href="#_sub10" class="code" title="subfunction uv_onPushReset(src,~)">uv_onPushReset</a>);
0279         set(gui.panels.process.HBox3,<span class="string">'Widths'</span>,[cpanel_w -1 -1]);
0280 
0281         <span class="comment">% --- RTD panel ---</span>
0282         waitbar(3/steps,hwb,<span class="string">'loading GUI elements - RTD bounds'</span>);
0283         gui.panels.rtd.main = uix.BoxPanel(<span class="string">'Parent'</span>,gui.left,<span class="keyword">...</span>
0284             <span class="string">'Title'</span>,<span class="string">'RTD Calculation Bounds'</span>,<span class="string">'MinimizeFcn'</span>,@<a href="minimizePanel.html" class="code" title="function minimizePanel(src,~)">minimizePanel</a>,<span class="keyword">...</span>
0285             <span class="string">'TitleColor'</span>,colors.BoxINV,<span class="string">'ForegroundColor'</span>,colors.BoxTitle);
0286         gui.panels.rtd.VBox = uix.VBox(<span class="string">'Parent'</span>,gui.panels.rtd.main,<span class="keyword">...</span>
0287             <span class="string">'Spacing'</span>,3,<span class="string">'Padding'</span>,3);
0288         <span class="comment">% RTD range</span>
0289         gui.panels.rtd.HBox1 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.rtd.VBox,<span class="keyword">...</span>
0290             <span class="string">'Spacing'</span>,3);
0291         gui.text_handles.rtd = uicontrol(<span class="string">'Parent'</span>,gui.panels.rtd.HBox1,<span class="keyword">...</span>
0292             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0293             <span class="string">'String'</span>,<span class="string">'RTD range       min | max'</span>);
0294         tstr = [<span class="string">'&lt;HTML&gt;Minimum relaxation time in RTDs used&lt;br&gt;'</span>,<span class="keyword">...</span>
0295             <span class="string">'for calculating statistics on E0 &amp; TLGM.'</span>];
0296         gui.edit_handles.rtd_min = uicontrol(<span class="string">'Parent'</span>,gui.panels.rtd.HBox1,<span class="keyword">...</span>
0297             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'rtd'</span>,<span class="keyword">...</span>
0298             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0299             <span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0300         tstr = [<span class="string">'&lt;HTML&gt;Maximum relaxation time in RTDs used&lt;br&gt;'</span>,<span class="keyword">...</span>
0301             <span class="string">'for calculating statistics on E0 &amp; TLGM.'</span>];
0302         gui.edit_handles.rtd_max = uicontrol(<span class="string">'Parent'</span>,gui.panels.rtd.HBox1,<span class="keyword">...</span>
0303             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'2'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'rtd'</span>,<span class="keyword">...</span>
0304             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0305             <span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0306         set(gui.panels.rtd.HBox1,<span class="string">'Widths'</span>,[cpanel_w -1 -1]);
0307         <span class="comment">% RESET button</span>
0308         gui.panels.rtd.HBox3 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.rtd.VBox,<span class="keyword">...</span>
0309             <span class="string">'Spacing'</span>,3);
0310         uix.Empty(<span class="string">'Parent'</span>,gui.panels.rtd.HBox3);
0311         uix.Empty(<span class="string">'Parent'</span>,gui.panels.rtd.HBox3);
0312         tstr = <span class="string">'RESET RTDs calculation bounds.'</span>;
0313         gui.push_handles.reset_rtd = uicontrol(<span class="string">'Parent'</span>,gui.panels.rtd.HBox3,<span class="keyword">...</span>
0314             <span class="string">'String'</span>,<span class="string">'RESET'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'rtd'</span>,<span class="keyword">...</span>
0315             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0316             <span class="string">'Callback'</span>,@<a href="#_sub10" class="code" title="subfunction uv_onPushReset(src,~)">uv_onPushReset</a>);
0317         set(gui.panels.rtd.HBox3,<span class="string">'Widths'</span>,[cpanel_w -1 -1]);
0318 
0319         <span class="comment">% --- Statistics panel ---</span>
0320         waitbar(4/steps,hwb,<span class="string">'loading GUI elements - statistics'</span>);
0321         gui.panels.info.main = uix.BoxPanel(<span class="string">'Parent'</span>,gui.left,<span class="keyword">...</span>
0322             <span class="string">'Title'</span>,<span class="string">'Uncertainty Statistics'</span>,<span class="string">'MinimizeFcn'</span>,@<a href="minimizePanel.html" class="code" title="function minimizePanel(src,~)">minimizePanel</a>,<span class="keyword">...</span>
0323             <span class="string">'TitleColor'</span>,colors.BoxINV,<span class="string">'ForegroundColor'</span>,colors.BoxTitle);
0324         gui.panels.info.VBox = uix.VBox(<span class="string">'Parent'</span>,gui.panels.info.main,<span class="keyword">...</span>
0325             <span class="string">'Spacing'</span>,3,<span class="string">'Padding'</span>,3);
0326         <span class="comment">% mean TLGM</span>
0327         gui.panels.info.HBox1 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.info.VBox,<span class="keyword">...</span>
0328             <span class="string">'Spacing'</span>,3);
0329         gui.text_handles.TLGM = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox1,<span class="keyword">...</span>
0330             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0331             <span class="string">'String'</span>,<span class="string">'TLGM          mean | 2*std'</span>);
0332         tstr = <span class="string">'MEAN of all TLGM values.'</span>;
0333         gui.edit_handles.TLGM_mean = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox1,<span class="keyword">...</span>
0334             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="keyword">...</span>
0335             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0336             <span class="string">'BackgroundColor'</span>,colors.BoxPRC);
0337         tstr = <span class="string">'STD of all TLGM values.'</span>;
0338         gui.edit_handles.TLGM_std = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox1,<span class="keyword">...</span>
0339             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'2'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="keyword">...</span>
0340             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0341             <span class="string">'BackgroundColor'</span>,colors.BoxPRC);
0342         set(gui.panels.info.HBox1,<span class="string">'Widths'</span>,[cpanel_w -1 -1]);
0343         <span class="comment">% aad TLGM</span>
0344         gui.panels.info.HBox2 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.info.VBox,<span class="keyword">...</span>
0345             <span class="string">'Spacing'</span>,3);
0346         gui.text_handles.TLGM_aad = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox2,<span class="keyword">...</span>
0347             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0348             <span class="string">'String'</span>,<span class="string">'TLGM          2*aad(mean)'</span>);
0349         uix.Empty(<span class="string">'Parent'</span>,gui.panels.info.HBox2);
0350         tstr = <span class="string">'AAD (average absolute deviation from mean) of all TLGM values.'</span>;
0351         gui.edit_handles.TLGM_aad = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox2,<span class="keyword">...</span>
0352             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0353             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'2'</span>,<span class="string">'FontSize'</span>,myui.fontsize);
0354         set(gui.panels.info.HBox2,<span class="string">'Widths'</span>,[cpanel_w -1 -1]);
0355         <span class="comment">% median TLGM</span>
0356         gui.panels.info.HBox3 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.info.VBox,<span class="keyword">...</span>
0357             <span class="string">'Spacing'</span>,3);
0358         gui.text_handles.TLGM_med = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox3,<span class="keyword">...</span>
0359             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0360             <span class="string">'String'</span>,<span class="string">'TLGM median | 2*aad(med)'</span>);
0361         tstr = <span class="string">'MEDIAN of all TLGM values.'</span>;
0362         gui.edit_handles.TLGM_med = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox3,<span class="keyword">...</span>
0363             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="keyword">...</span>
0364             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0365             <span class="string">'BackgroundColor'</span>,colors.BoxCPS);
0366         tstr = <span class="string">'AAD (average absolute deviation from median) of all TLGM values.'</span>;
0367         gui.edit_handles.TLGM_aadmed = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox3,<span class="keyword">...</span>
0368             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'2'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="keyword">...</span>
0369             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0370             <span class="string">'BackgroundColor'</span>,colors.BoxCPS);
0371         set(gui.panels.info.HBox3,<span class="string">'Widths'</span>,[cpanel_w -1 -1]);
0372         <span class="comment">% mean E0</span>
0373         gui.panels.info.HBox4 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.info.VBox,<span class="keyword">...</span>
0374             <span class="string">'Spacing'</span>,3);
0375         gui.text_handles.E0 = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox4,<span class="keyword">...</span>
0376             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0377             <span class="string">'String'</span>,<span class="string">'E0              mean | 2*std'</span>);
0378         tstr = <span class="string">'MEAN of all E0 values.'</span>;
0379         gui.edit_handles.E0_mean = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox4,<span class="keyword">...</span>
0380             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="keyword">...</span>
0381             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0382             <span class="string">'BackgroundColor'</span>,colors.BoxPRC);
0383         tstr = <span class="string">'STD of all E0 values.'</span>;
0384         gui.edit_handles.E0_std = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox4,<span class="keyword">...</span>
0385             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'2'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="keyword">...</span>
0386             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0387             <span class="string">'BackgroundColor'</span>,colors.BoxPRC);
0388         set(gui.panels.info.HBox4,<span class="string">'Widths'</span>,[cpanel_w -1 -1]);
0389         <span class="comment">% aad E0</span>
0390         gui.panels.info.HBox5 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.info.VBox,<span class="keyword">...</span>
0391             <span class="string">'Spacing'</span>,3);
0392         gui.text_handles.E0_aad = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox5,<span class="keyword">...</span>
0393             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0394             <span class="string">'String'</span>,<span class="string">'E0              2*aad(mean)'</span>);
0395         uix.Empty(<span class="string">'Parent'</span>,gui.panels.info.HBox5);
0396         tstr = <span class="string">'AAD (average absolute deviation from mean) of all E0 values.'</span>;
0397         gui.edit_handles.E0_aad = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox5,<span class="keyword">...</span>
0398             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0399             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'2'</span>,<span class="string">'FontSize'</span>,myui.fontsize);
0400         set(gui.panels.info.HBox5,<span class="string">'Widths'</span>,[cpanel_w -1 -1]);
0401         <span class="comment">% median E0</span>
0402         gui.panels.info.HBox6 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.info.VBox,<span class="keyword">...</span>
0403             <span class="string">'Spacing'</span>,3);
0404         gui.text_handles.E0_med = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox6,<span class="keyword">...</span>
0405             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0406             <span class="string">'String'</span>,<span class="string">'E0   median | 2*aad(med)'</span>);
0407         tstr = <span class="string">'MEDIAN of all E0 values.'</span>;
0408         gui.edit_handles.E0_med = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox6,<span class="keyword">...</span>
0409             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="keyword">...</span>
0410             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0411             <span class="string">'BackgroundColor'</span>,colors.BoxCPS);
0412         tstr = <span class="string">'AAD (average absolute deviation from median) of all E0 values.'</span>;
0413         gui.edit_handles.E0_aadmed = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox6,<span class="keyword">...</span>
0414             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'2'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="keyword">...</span>
0415             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0416             <span class="string">'BackgroundColor'</span>,colors.BoxCPS);
0417         set(gui.panels.info.HBox6,<span class="string">'Widths'</span>,[cpanel_w -1 -1]);
0418 
0419         <span class="comment">% --- update MAIN GUI button ---</span>
0420         gui.panels.save.VBox1 = uix.VBox(<span class="string">'Parent'</span>,gui.left,<span class="keyword">...</span>
0421         <span class="string">'Spacing'</span>,3);   
0422         tstr = <span class="string">'UPDATE uncertainty data in main NUCLEUSinv GUI.'</span>;
0423         gui.push_handles.update = uicontrol(<span class="string">'Parent'</span>,gui.panels.save.VBox1,<span class="keyword">...</span>
0424             <span class="string">'String'</span>,<span class="string">'UPDATE MAIN GUI'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'update'</span>,<span class="keyword">...</span>
0425             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0426             <span class="string">'Callback'</span>,@<a href="#_sub9" class="code" title="subfunction uv_onPushUpdate(src,~)">uv_onPushUpdate</a>);
0427         tstr = <span class="string">'Export current graphics view to Figure.'</span>;
0428         gui.push_handles.view = uicontrol(<span class="string">'Parent'</span>,gui.panels.save.VBox1,<span class="keyword">...</span>
0429         <span class="string">'String'</span>,<span class="string">'VIEW2FIG'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'view'</span>,<span class="keyword">...</span>
0430         <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0431         <span class="string">'Callback'</span>,@<a href="#_sub8" class="code" title="subfunction uv_onPushView(src,~)">uv_onPushView</a>);
0432 
0433         <span class="comment">% fix text vertical alignment</span>
0434         jh = findjobj(gui.text_handles.uncertMethod);
0435         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0436         jh = findjobj(gui.text_handles.uncertN);
0437         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0438         jh = findjobj(gui.text_handles.uncertchi2);
0439         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0440         jh = findjobj(gui.text_handles.uncertmnorm);
0441         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0442         jh = findjobj(gui.text_handles.uncertThresh);
0443         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0444         <span class="comment">% jh = findjobj(gui.text_handles.uncertMax);</span>
0445         <span class="comment">% jh.setVerticalAlignment(javax.swing.JLabel.CENTER);</span>
0446         jh = findjobj(gui.text_handles.chi2);
0447         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0448         jh = findjobj(gui.text_handles.mnorm);
0449         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0450         jh = findjobj(gui.text_handles.rtd);
0451         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0452         jh = findjobj(gui.text_handles.TLGM);
0453         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0454         jh = findjobj(gui.text_handles.TLGM_aad);
0455         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0456         jh = findjobj(gui.text_handles.TLGM_med);
0457         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0458         jh = findjobj(gui.text_handles.E0);
0459         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0460         jh = findjobj(gui.text_handles.E0_aad);
0461         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0462         jh = findjobj(gui.text_handles.E0_med);
0463         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0464 
0465         <span class="comment">% empty space at bottom of left side</span>
0466         uix.Empty(<span class="string">'Parent'</span>,gui.left);
0467         <span class="comment">% adjust the heights of all left-column-panels</span>
0468         heights = [22 22 22 22 28 -1; 22+6*24+8*3 22+3*24+5*3 22+2*24+4*4 22+6*24+8*3 28*2 -1];
0469         <span class="comment">% panel header is always 22 high</span>
0470         set(gui.left,<span class="string">'Heights'</span>,heights(2,:),<span class="keyword">...</span>
0471             <span class="string">'MinimumHeights'</span>,[22 22 22 22 28 0]);        
0472 
0473         <span class="comment">% --- plot boxes ---</span>
0474         waitbar(5/steps,hwb,<span class="string">'loading GUI elements - graphics'</span>);
0475         gui.rightPanel = uix.TabPanel(<span class="string">'Parent'</span>,gui.right,<span class="keyword">...</span>
0476             <span class="string">'BackGroundColor'</span>,colors.panelBG);
0477         <span class="comment">% -- tab1</span>
0478         gui.righttop1 = uix.HBox(<span class="string">'Parent'</span>,gui.rightPanel,<span class="keyword">...</span>
0479             <span class="string">'BackGroundColor'</span>,colors.panelBG,<span class="string">'Spacing'</span>,5);
0480         gui.pbox11 = uicontainer(<span class="string">'Parent'</span>,gui.righttop1,<span class="keyword">...</span>
0481             <span class="string">'BackGroundColor'</span>,colors.panelBG);
0482         gui.pbox12 = uicontainer(<span class="string">'Parent'</span>,gui.righttop1,<span class="keyword">...</span>
0483             <span class="string">'BackGroundColor'</span>,colors.panelBG);
0484         set(gui.righttop1,<span class="string">'Widths'</span>,[-1 -1 ]);
0485         gui.rightbot = uix.HBox(<span class="string">'Parent'</span>,gui.right,<span class="keyword">...</span>
0486             <span class="string">'BackGroundColor'</span>,colors.panelBG,<span class="string">'Spacing'</span>,5);
0487         gui.pbox2 = uicontainer(<span class="string">'Parent'</span>,gui.rightbot,<span class="keyword">...</span>
0488             <span class="string">'BackGroundColor'</span>,colors.panelBG);
0489 
0490         <span class="comment">% -- tab2</span>
0491         gui.righttop2 = uix.HBox(<span class="string">'Parent'</span>,gui.rightPanel,<span class="keyword">...</span>
0492             <span class="string">'BackGroundColor'</span>,colors.panelBG,<span class="string">'Spacing'</span>,5);
0493         gui.pbox21 = uicontainer(<span class="string">'Parent'</span>,gui.righttop2,<span class="keyword">...</span>
0494             <span class="string">'BackGroundColor'</span>,colors.panelBG);
0495         gui.pbox22 = uicontainer(<span class="string">'Parent'</span>,gui.righttop2,<span class="keyword">...</span>
0496             <span class="string">'BackGroundColor'</span>,colors.panelBG);
0497         set(gui.righttop2,<span class="string">'Widths'</span>,[-1 -1 ]);
0498 
0499         gui.rightPanel.TabTitles = {<span class="string">'STATISTICS'</span>,<span class="string">'HISTOGRAMS'</span>};
0500         gui.rightPanel.TabWidth = 75;
0501         gui.rightPanel.TabEnables = {<span class="string">'on'</span>,<span class="string">'on'</span>};
0502 
0503         <span class="comment">% -- plot axes --</span>
0504         gui.axes11 = axes(<span class="string">'Parent'</span>,gui.pbox12,<span class="string">'Box'</span>,<span class="string">'on'</span>);
0505         gui.axes12 = axes(<span class="string">'Parent'</span>,gui.pbox11,<span class="string">'Box'</span>,<span class="string">'on'</span>);
0506         gui.axes2 = axes(<span class="string">'Parent'</span>,gui.pbox2,<span class="string">'Box'</span>,<span class="string">'on'</span>);
0507         gui.axes21 = axes(<span class="string">'Parent'</span>,gui.pbox21,<span class="string">'Box'</span>,<span class="string">'on'</span>);
0508         gui.axes22 = axes(<span class="string">'Parent'</span>,gui.pbox22,<span class="string">'Box'</span>,<span class="string">'on'</span>);
0509 
0510         <span class="comment">% the chi2 vs. xn plot has a context menu</span>
0511         gui.cm_handles.axes_chi2 = uicontextmenu(fig_uncert);
0512         gui.cm_handles.axes_color = uimenu(gui.cm_handles.axes_chi2,<span class="keyword">...</span>
0513             <span class="string">'Label'</span>,<span class="string">'color by'</span>);
0514         gui.cm_handles.axes_color_none = uimenu(gui.cm_handles.axes_color,<span class="keyword">...</span>
0515             <span class="string">'Label'</span>,<span class="string">'none'</span>,<span class="string">'Tag'</span>,<span class="string">'none'</span>,<span class="string">'Checked'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0516             <span class="string">'Callback'</span>,@<a href="#_sub3" class="code" title="subfunction uv_onContextPlotsColor(src,~)">uv_onContextPlotsColor</a>);
0517         gui.cm_handles.axes_color_chi2 = uimenu(gui.cm_handles.axes_color,<span class="keyword">...</span>
0518             <span class="string">'Label'</span>,<span class="string">'chi2'</span>,<span class="string">'Tag'</span>,<span class="string">'chi2'</span>,<span class="string">'Callback'</span>,@<a href="#_sub3" class="code" title="subfunction uv_onContextPlotsColor(src,~)">uv_onContextPlotsColor</a>);
0519         gui.cm_handles.axes_color_mnorm = uimenu(gui.cm_handles.axes_color,<span class="keyword">...</span>
0520             <span class="string">'Label'</span>,<span class="string">'xn'</span>,<span class="string">'Tag'</span>,<span class="string">'xn'</span>,<span class="string">'Callback'</span>,@<a href="#_sub3" class="code" title="subfunction uv_onContextPlotsColor(src,~)">uv_onContextPlotsColor</a>);
0521         set(gui.axes12,<span class="string">'UIContextMenu'</span>,gui.cm_handles.axes_chi2);
0522 
0523         <span class="comment">% the RTD plot has a context menu</span>
0524         gui.cm_handles.axes_rtd = uicontextmenu(fig_uncert);
0525         gui.cm_handles.axes_rtd_lines = uimenu(gui.cm_handles.axes_rtd,<span class="keyword">...</span>
0526             <span class="string">'Label'</span>,<span class="string">'lines'</span>,<span class="string">'Tag'</span>,<span class="string">'lines'</span>,<span class="string">'Checked'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0527             <span class="string">'Callback'</span>,@<a href="#_sub4" class="code" title="subfunction uv_onContextPlotsRTD(src,~)">uv_onContextPlotsRTD</a>);
0528         gui.cm_handles.axes_rtd_patch = uimenu(gui.cm_handles.axes_rtd,<span class="keyword">...</span>
0529             <span class="string">'Label'</span>,<span class="string">'patch'</span>);
0530         gui.cm_handles.axes_rtd_patch_mean = uimenu(gui.cm_handles.axes_rtd_patch,<span class="keyword">...</span>
0531             <span class="string">'Label'</span>,<span class="string">'mean / std'</span>,<span class="string">'Tag'</span>,<span class="string">'patchmean'</span>,<span class="keyword">...</span>
0532             <span class="string">'Callback'</span>,@<a href="#_sub4" class="code" title="subfunction uv_onContextPlotsRTD(src,~)">uv_onContextPlotsRTD</a>);
0533         gui.cm_handles.axes_rtd_patch_median = uimenu(gui.cm_handles.axes_rtd_patch,<span class="keyword">...</span>
0534             <span class="string">'Label'</span>,<span class="string">'median / aad'</span>,<span class="string">'Tag'</span>,<span class="string">'patchmedian'</span>,<span class="keyword">...</span>
0535             <span class="string">'Callback'</span>,@<a href="#_sub4" class="code" title="subfunction uv_onContextPlotsRTD(src,~)">uv_onContextPlotsRTD</a>);
0536         set(gui.axes2,<span class="string">'UIContextMenu'</span>,gui.cm_handles.axes_rtd);
0537 
0538         <span class="comment">% --- store main GUI settings ---</span>
0539         gui.myui = nucleus.gui.myui;
0540         gui.myui.heights = heights;
0541         gui.figh_nucleus = figh_nucleus;
0542 
0543         <span class="comment">% --- save gui data to GUI ---</span>
0544         setappdata(fig_uncert,<span class="string">'gui'</span>,gui);
0545 
0546         <span class="comment">% make GUI visible</span>
0547         delete(hwb);
0548         set(gui.main,<span class="string">'Visible'</span>,<span class="string">'on'</span>);
0549 
0550         <span class="comment">% initialize color style</span>
0551         uv.colorstyle = <span class="string">'none'</span>;
0552         <span class="comment">% initialize RTD plot style</span>
0553         uv.rtd_plotstyle = <span class="string">'lines'</span>;
0554     <span class="keyword">else</span>
0555         data = getappdata(fig_uncert,<span class="string">'data'</span>);
0556         uv = data.uv;
0557     <span class="keyword">end</span>
0558     <span class="comment">% if the figure is already open load the GUI data</span>
0559     gui = getappdata(fig_uncert,<span class="string">'gui'</span>);
0560     <span class="comment">% update new NUCLEUSinv data</span>
0561     setappdata(fig_uncert,<span class="string">'data'</span>,nucleus_data);
0562     data = getappdata(fig_uncert,<span class="string">'data'</span>);
0563     <span class="comment">% clear axes</span>
0564     <a href="clearAllAxes.html" class="code" title="function clearAllAxes(figh)">clearAllAxes</a>(fig_uncert);
0565 
0566     <span class="comment">% round all chi2 and xn values to 6 digits</span>
0567     chi2_all = data.results.invstd.uncert.chi2_all;
0568     chi2_all = round(1e6.*chi2_all)./1e6;
0569     data.results.invstd.uncert.chi2_all = chi2_all;
0570     mnorm_all = data.results.invstd.uncert.mnorm_all;
0571     mnorm_all = round(1e6.*mnorm_all)./1e6;
0572     data.results.invstd.uncert.mnorm_all = mnorm_all;
0573 
0574     <span class="comment">% create logical mask</span>
0575     uv.touse = ones(nucleus_data.uncert.N,1);
0576     <span class="comment">% --- fill the edit fields ---</span>
0577     invstd = data.results.invstd;
0578     uncert = invstd.uncert;
0579     <span class="comment">% 1.) control</span>
0580     uv.uncertMethod = uncert.params.uncert.Method;
0581     uv.uncertN = uncert.params.uncert.N;
0582     set(gui.edit_handles.uncertN,<span class="string">'String'</span>,num2str(uv.uncertN));
0583     uv.uncertThresh = uncert.params.uncert.Thresh;
0584     set(gui.edit_handles.uncertThresh,<span class="string">'String'</span>,num2str(uv.uncertThresh));
0585     uv.uncertMax = uncert.params.uncert.Max;
0586     set(gui.edit_handles.uncertMax,<span class="string">'String'</span>,num2str(uv.uncertMax));
0587     uv.chi2_range_calc  = [min(uncert.chi2_all) max(uncert.chi2_all)];
0588     uv.mnorm_range_calc = [min(uncert.mnorm_all) max(uncert.mnorm_all)];
0589     <span class="comment">% set popup menu</span>
0590     <span class="keyword">switch</span> invstd.invtype
0591         <span class="keyword">case</span> {<span class="string">'LU'</span>,<span class="string">'NNLS'</span>}
0592             set(gui.popup_handles.uncertMethod,<span class="keyword">...</span>
0593                 <span class="string">'String'</span>,{<span class="string">'RMS - unbounded'</span>,<span class="string">'RMS - bounded'</span>})
0594             <span class="keyword">switch</span> uncert.params.uncert.Method
0595                 <span class="keyword">case</span> <span class="string">'RMS_free'</span>
0596                     set(gui.popup_handles.uncertMethod,<span class="string">'Value'</span>,1);
0597                 <span class="keyword">case</span> <span class="string">'RMS_bound'</span>
0598                     set(gui.popup_handles.uncertMethod,<span class="string">'Value'</span>,2);
0599             <span class="keyword">end</span>
0600         <span class="keyword">case</span> <span class="string">'MUMO'</span>
0601             set(gui.popup_handles.uncertMethod,<span class="keyword">...</span>
0602                 <span class="string">'String'</span>,{<span class="string">'RMS - unbounded'</span>,<span class="string">'RMS - bounded'</span>,<span class="string">'Threshold'</span>,<span class="string">'Conf. Interval'</span>})
0603             <span class="keyword">switch</span> uncert.params.uncert.Method
0604                 <span class="keyword">case</span> <span class="string">'RMS_free'</span>
0605                     set(gui.popup_handles.uncertMethod,<span class="string">'Value'</span>,1);
0606                 <span class="keyword">case</span> <span class="string">'RMS_bound'</span>
0607                     set(gui.popup_handles.uncertMethod,<span class="string">'Value'</span>,2);
0608                 <span class="keyword">case</span> <span class="string">'thresh'</span>
0609                     set(gui.popup_handles.uncertMethod,<span class="string">'Value'</span>,3);
0610                 <span class="keyword">case</span> <span class="string">'ci'</span>
0611                     set(gui.popup_handles.uncertMethod,<span class="string">'Value'</span>,4);
0612             <span class="keyword">end</span>
0613     <span class="keyword">end</span>
0614     set(gui.edit_handles.uncertN,<span class="string">'String'</span>,num2str(uncert.params.uncert.N));
0615     <span class="comment">% 2.) process</span>
0616     chi2_range  = uv.chi2_range_calc;
0617     mnorm_range = uv.mnorm_range_calc;
0618     set(gui.edit_handles.chi2_min,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,chi2_range(1,1)));
0619     set(gui.edit_handles.chi2_max,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,chi2_range(1,2)));
0620     set(gui.edit_handles.mnorm_min,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,mnorm_range(1,1)));
0621     set(gui.edit_handles.mnorm_max,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,mnorm_range(1,2)));
0622     <span class="comment">% 3.) RTD range</span>
0623     rtd_range = uncert.statistics.RTD_bounds;
0624     set(gui.edit_handles.rtd_min,<span class="string">'String'</span>,num2str(rtd_range(1,1)));
0625     set(gui.edit_handles.rtd_max,<span class="string">'String'</span>,num2str(rtd_range(1,2)));
0626     uv.chi2_range = chi2_range;
0627     uv.mnorm_range = mnorm_range;
0628     uv.rtd_range = rtd_range;
0629 
0630     <span class="comment">% update data</span>
0631     data.uv = uv;
0632     setappdata(fig_uncert,<span class="string">'data'</span>,data);
0633     <a href="#_sub6" class="code" title="subfunction uv_onPopupMethod(src,~)">uv_onPopupMethod</a>(gui.popup_handles.uncertMethod);
0634 
0635     <span class="comment">% plot all uncertainty data</span>
0636     <a href="#_sub11" class="code" title="subfunction uv_updateInformation(figh)">uv_updateInformation</a>(fig_uncert);
0637     <a href="beautifyAxes.html" class="code" title="function beautifyAxes(figh)">beautifyAxes</a>(fig_uncert);
0638 <span class="keyword">end</span>
0639 
0640 <span class="keyword">end</span>
0641 
0642 <span class="comment">%% subfunction to update the edit fields</span>
0643 <a name="_sub1" href="#_subfunctions" class="code">function uv_onEditValue(src,~)</a>
0644 figh = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
0645 gui = getappdata(figh,<span class="string">'gui'</span>);
0646 data = getappdata(figh,<span class="string">'data'</span>);
0647 uv = data.uv;
0648 
0649 <span class="comment">% get the edit field value</span>
0650 val = str2double(get(src,<span class="string">'String'</span>));
0651 
0652 <span class="keyword">switch</span> get(src,<span class="string">'Tag'</span>)
0653     <span class="keyword">case</span> <span class="string">'uncertN'</span>
0654         <span class="keyword">if</span> val &lt; 10
0655             uncertN = 10;
0656         <span class="keyword">else</span>
0657             uncertN = round(val);
0658         <span class="keyword">end</span>
0659         set(src,<span class="string">'String'</span>,num2str(uncertN));
0660         uv.uncertN = uncertN;
0661         data.uv = uv;
0662     <span class="keyword">case</span> <span class="string">'uncertThresh'</span>
0663     <span class="keyword">case</span> <span class="string">'uncertMax'</span>
0664     <span class="keyword">case</span> <span class="string">'control'</span>
0665         <span class="comment">% set the value with the desired layout</span>
0666         set(src,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,val));
0667         chi2_range_calc(1,1) = str2double(get(gui.edit_handles.uncertchi2_min,<span class="string">'String'</span>));
0668         chi2_range_calc(1,2) = str2double(get(gui.edit_handles.uncertchi2_max,<span class="string">'String'</span>));
0669         mnorm_range_calc(1,1) = str2double(get(gui.edit_handles.uncertmnorm_min,<span class="string">'String'</span>));
0670         mnorm_range_calc(1,2) = str2double(get(gui.edit_handles.uncertmnorm_max,<span class="string">'String'</span>));
0671         <span class="comment">% update data</span>
0672         uv.chi2_range_calc = chi2_range_calc;
0673         uv.mnorm_range_calc = mnorm_range_calc;
0674         data.uv = uv;
0675     <span class="keyword">case</span> <span class="string">'process'</span>
0676         <span class="comment">% set the value with the desired layout</span>
0677         set(src,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,val));
0678         <span class="comment">% get all range values</span>
0679         chi2_range(1,1) = str2double(get(gui.edit_handles.chi2_min,<span class="string">'String'</span>));
0680         chi2_range(1,2) = str2double(get(gui.edit_handles.chi2_max,<span class="string">'String'</span>));
0681         mnorm_range(1,1) = str2double(get(gui.edit_handles.mnorm_min,<span class="string">'String'</span>));
0682         mnorm_range(1,2) = str2double(get(gui.edit_handles.mnorm_max,<span class="string">'String'</span>));
0683         <span class="comment">% fix wrong user input</span>
0684         <span class="keyword">if</span> chi2_range(2) &lt;= chi2_range(1)
0685             warndlg({<span class="string">'function: UNCERTVIEW'</span>,<span class="keyword">...</span>
0686             <span class="string">'Lower bound is larger than upper bound!'</span>},<span class="keyword">...</span>
0687             <span class="string">'Resetting.'</span>);
0688             chi2_range(1) = min(data.results.invstd.uncert.chi2_all);
0689             chi2_range(2) = max(data.results.invstd.uncert.chi2_all);            
0690             set(gui.edit_handles.chi2_min,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,chi2_range(1)));
0691             set(gui.edit_handles.chi2_max,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,chi2_range(2)));
0692         <span class="keyword">end</span>
0693         <span class="keyword">if</span> mnorm_range(2) &lt;= mnorm_range(1)            
0694             warndlg({<span class="string">'function: UNCERTVIEW'</span>,<span class="keyword">...</span>
0695             <span class="string">'Lower bound is larger than upper bound!'</span>},<span class="keyword">...</span>
0696             <span class="string">'Resetting.'</span>);
0697             mnorm_range(1) = min(data.results.invstd.uncert.mnorm_all);
0698             mnorm_range(2) = max(data.results.invstd.uncert.mnorm_all);
0699             set(gui.edit_handles.mnorm_min,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,mnorm_range(1)));
0700             set(gui.edit_handles.mnorm_max,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,mnorm_range(2)));
0701         <span class="keyword">end</span>
0702         <span class="comment">% update data</span>
0703         uv.chi2_range = chi2_range;
0704         uv.mnorm_range = mnorm_range;
0705         data.uv = uv;
0706         <span class="comment">% update logical mask for plotting</span>
0707         data = <a href="#_sub5" class="code" title="subfunction data = uv_updateMASK(data)">uv_updateMASK</a>(data);
0708     <span class="keyword">case</span> <span class="string">'rtd'</span>
0709         <span class="comment">% set the value with the desired layout</span>
0710         set(src,<span class="string">'String'</span>,num2str(val));
0711         <span class="comment">% get all range values</span>
0712         rtd_range(1,1) = str2double(get(gui.edit_handles.rtd_min,<span class="string">'String'</span>));
0713         rtd_range(1,2) = str2double(get(gui.edit_handles.rtd_max,<span class="string">'String'</span>));
0714         <span class="comment">% update data</span>
0715         uv.rtd_range = rtd_range;
0716         data.uv = uv;
0717 <span class="keyword">end</span>
0718 
0719 <span class="comment">% in case of error reactivate the run button</span>
0720 set(gui.push_handles.run,<span class="string">'String'</span>,<span class="string">'RUN UNCERT. CALC.'</span>,<span class="keyword">...</span>
0721     <span class="string">'BackgroundColor'</span>,<span class="string">'g'</span>,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="string">'Callback'</span>,@<a href="#_sub7" class="code" title="subfunction uv_onPushRun(src,~)">uv_onPushRun</a>);
0722 setappdata(figh,<span class="string">'gui'</span>,gui);
0723 <span class="comment">% update GUI data</span>
0724 setappdata(figh,<span class="string">'data'</span>,data);
0725 <span class="comment">% update information</span>
0726 <a href="#_sub11" class="code" title="subfunction uv_updateInformation(figh)">uv_updateInformation</a>(figh);
0727 <span class="keyword">end</span>
0728 
0729 <span class="comment">%% subfunction to copy the chi2 and xn range to the control panel</span>
0730 <a name="_sub2" href="#_subfunctions" class="code">function uv_onPushSend(src,~)</a>
0731 figh = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
0732 gui = getappdata(figh,<span class="string">'gui'</span>);
0733 data = getappdata(figh,<span class="string">'data'</span>);
0734 uv = data.uv;
0735 
0736 <span class="comment">% get all data</span>
0737 chi2_range(1,1) = str2double(get(gui.edit_handles.chi2_min,<span class="string">'String'</span>));
0738 chi2_range(1,2) = str2double(get(gui.edit_handles.chi2_max,<span class="string">'String'</span>));
0739 mnorm_range(1,1) = str2double(get(gui.edit_handles.mnorm_min,<span class="string">'String'</span>));
0740 mnorm_range(1,2) = str2double(get(gui.edit_handles.mnorm_max,<span class="string">'String'</span>));
0741 
0742 <span class="comment">% copy data to calc</span>
0743 uv.chi2_range_calc = chi2_range;
0744 uv.mnorm_range_calc = mnorm_range;
0745 data.uv = uv;
0746 
0747 <span class="comment">% write values to edit field</span>
0748 set(gui.edit_handles.uncertchi2_min,<span class="keyword">...</span>
0749     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range_calc(1)));
0750 set(gui.edit_handles.uncertchi2_max,<span class="keyword">...</span>
0751     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range_calc(2)));
0752 set(gui.edit_handles.uncertmnorm_min,<span class="keyword">...</span>
0753     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range_calc(1)));
0754 set(gui.edit_handles.uncertmnorm_max,<span class="keyword">...</span>
0755     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range_calc(2)));
0756 
0757 <span class="comment">% update GUI data</span>
0758 setappdata(figh,<span class="string">'data'</span>,data);
0759 <span class="keyword">end</span>
0760 
0761 <span class="comment">%% subfunction to control the line color</span>
0762 <a name="_sub3" href="#_subfunctions" class="code">function uv_onContextPlotsColor(src,~)</a>
0763 figh = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
0764 gui = getappdata(figh,<span class="string">'gui'</span>);
0765 data = getappdata(figh,<span class="string">'data'</span>);
0766 uv = data.uv;
0767 
0768 <span class="comment">% switch through different plot options</span>
0769 <span class="keyword">switch</span> get(src,<span class="string">'Tag'</span>)
0770     <span class="keyword">case</span> <span class="string">'none'</span>
0771         set(gui.cm_handles.axes_color_none,<span class="string">'Checked'</span>,<span class="string">'on'</span>);
0772         set(gui.cm_handles.axes_color_chi2,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0773         set(gui.cm_handles.axes_color_mnorm,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0774     <span class="keyword">case</span> <span class="string">'chi2'</span>
0775         set(gui.cm_handles.axes_color_none,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0776         set(gui.cm_handles.axes_color_chi2,<span class="string">'Checked'</span>,<span class="string">'on'</span>);
0777         set(gui.cm_handles.axes_color_mnorm,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0778     <span class="keyword">case</span> <span class="string">'xn'</span>
0779         set(gui.cm_handles.axes_color_none,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0780         set(gui.cm_handles.axes_color_chi2,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0781         set(gui.cm_handles.axes_color_mnorm,<span class="string">'Checked'</span>,<span class="string">'on'</span>);
0782 <span class="keyword">end</span>
0783 uv.colorstyle = get(src,<span class="string">'Tag'</span>);
0784 
0785 <span class="comment">% update GUI data</span>
0786 data.uv = uv;
0787 setappdata(figh,<span class="string">'data'</span>,data);
0788 <span class="comment">% update information and plots</span>
0789 <a href="#_sub11" class="code" title="subfunction uv_updateInformation(figh)">uv_updateInformation</a>(figh);
0790 <span class="keyword">end</span>
0791 
0792 <span class="comment">%% subfunction to control RTD axes context menu</span>
0793 <a name="_sub4" href="#_subfunctions" class="code">function uv_onContextPlotsRTD(src,~)</a>
0794 figh = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
0795 gui = getappdata(figh,<span class="string">'gui'</span>);
0796 data = getappdata(figh,<span class="string">'data'</span>);
0797 uv = data.uv;
0798 
0799 <span class="comment">% switch through different plot options</span>
0800 <span class="keyword">switch</span> get(src,<span class="string">'Tag'</span>)
0801     <span class="keyword">case</span> <span class="string">'lines'</span>
0802         set(gui.cm_handles.axes_rtd_lines,<span class="string">'Checked'</span>,<span class="string">'on'</span>);
0803         set(gui.cm_handles.axes_rtd_patch_mean,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0804         set(gui.cm_handles.axes_rtd_patch_median,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0805     <span class="keyword">case</span> <span class="string">'patchmean'</span>
0806         set(gui.cm_handles.axes_rtd_lines,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0807         set(gui.cm_handles.axes_rtd_patch_mean,<span class="string">'Checked'</span>,<span class="string">'on'</span>);
0808         set(gui.cm_handles.axes_rtd_patch_median,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0809     <span class="keyword">case</span> <span class="string">'patchmedian'</span>
0810         set(gui.cm_handles.axes_rtd_lines,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0811         set(gui.cm_handles.axes_rtd_patch_mean,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0812         set(gui.cm_handles.axes_rtd_patch_median,<span class="string">'Checked'</span>,<span class="string">'on'</span>);
0813 <span class="keyword">end</span>
0814 uv.rtd_plotstyle = get(src,<span class="string">'Tag'</span>);
0815 
0816 <span class="comment">% update GUI data</span>
0817 data.uv = uv;
0818 setappdata(figh,<span class="string">'data'</span>,data);
0819 <span class="comment">% update information and plots</span>
0820 <a href="#_sub11" class="code" title="subfunction uv_updateInformation(figh)">uv_updateInformation</a>(figh);
0821 <span class="keyword">end</span>
0822 
0823 <span class="comment">%% subfunction to update the logical mask</span>
0824 <a name="_sub5" href="#_subfunctions" class="code">function data = uv_updateMASK(data)</a>
0825 uncert = data.results.invstd.uncert;
0826 uv = data.uv;
0827 
0828 mask1 = uncert.chi2_all &gt;= uv.chi2_range(1) &amp; uncert.chi2_all &lt;= uv.chi2_range(2);
0829 mask2 = uncert.mnorm_all &gt;= uv.mnorm_range(1) &amp; uncert.mnorm_all &lt;= uv.mnorm_range(2);
0830 uv.touse = mask1 &amp; mask2;
0831 
0832 data.uv = uv;
0833 <span class="keyword">end</span>
0834 
0835 <span class="comment">%% subfunction to update control panel based on uncertainty method</span>
0836 <a name="_sub6" href="#_subfunctions" class="code">function uv_onPopupMethod(src,~)</a>
0837 figh = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
0838 gui = getappdata(figh,<span class="string">'gui'</span>);
0839 data = getappdata(figh,<span class="string">'data'</span>);
0840 uv = data.uv;
0841 invstd = data.results.invstd;
0842 
0843 val = get(gui.popup_handles.uncertMethod,<span class="string">'Value'</span>);
0844 
0845 <span class="keyword">switch</span> invstd.invtype
0846     <span class="keyword">case</span> {<span class="string">'LU'</span>,<span class="string">'NNLS'</span>}
0847         <span class="keyword">switch</span> val
0848             <span class="keyword">case</span> 1 <span class="comment">% RMS_free</span>
0849                 uv.uncertMethod = <span class="string">'RMS_free'</span>;
0850                 set(gui.edit_handles.uncertchi2_min,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0851                 set(gui.edit_handles.uncertchi2_max,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0852                 set(gui.edit_handles.uncertmnorm_min,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0853                 set(gui.edit_handles.uncertmnorm_max,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0854                 set(gui.edit_handles.uncertThresh,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0855                 set(gui.edit_handles.uncertMax,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0856             <span class="keyword">case</span> 2 <span class="comment">% RMS_bound</span>
0857                 uv.uncertMethod = <span class="string">'RMS_bound'</span>;
0858                 set(gui.edit_handles.uncertchi2_min,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0859                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range_calc(1)));
0860                 set(gui.edit_handles.uncertchi2_max,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0861                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range_calc(2)));
0862                 set(gui.edit_handles.uncertmnorm_min,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0863                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range_calc(1)));
0864                 set(gui.edit_handles.uncertmnorm_max,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0865                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range_calc(2)));
0866                 set(gui.edit_handles.uncertThresh,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0867                 set(gui.edit_handles.uncertMax,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0868                     <span class="string">'String'</span>,num2str(uv.uncertMax));
0869         <span class="keyword">end</span>
0870     <span class="keyword">case</span> <span class="string">'MUMO'</span>
0871         <span class="keyword">switch</span> val
0872             <span class="keyword">case</span> 1 <span class="comment">% RMS_free</span>
0873                 uv.uncertMethod = <span class="string">'RMS_free'</span>;
0874                 set(gui.edit_handles.uncertchi2_min,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0875                 set(gui.edit_handles.uncertchi2_max,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0876                 set(gui.edit_handles.uncertmnorm_min,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0877                 set(gui.edit_handles.uncertmnorm_max,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0878                 set(gui.edit_handles.uncertThresh,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0879                 set(gui.edit_handles.uncertMax,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0880             <span class="keyword">case</span> 2 <span class="comment">% RMS_bound</span>
0881                 uv.uncertMethod = <span class="string">'RMS_bound'</span>;
0882                 set(gui.edit_handles.uncertchi2_min,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0883                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range_calc(1)));
0884                 set(gui.edit_handles.uncertchi2_max,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0885                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range_calc(2)));
0886                 set(gui.edit_handles.uncertmnorm_min,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0887                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range_calc(1)));
0888                 set(gui.edit_handles.uncertmnorm_max,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0889                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range_calc(2)));
0890                 set(gui.edit_handles.uncertThresh,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0891                 set(gui.edit_handles.uncertMax,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0892                     <span class="string">'String'</span>,num2str(uv.uncertMax));
0893             <span class="keyword">case</span> 3 <span class="comment">% threshold</span>
0894                 uv.uncertMethod = <span class="string">'thresh'</span>;
0895                 uv.chi2_range_calc = [0 10];
0896                 uv.mnorm_range_calc = [0 10];
0897                 set(gui.edit_handles.uncertchi2_min,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0898                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range_calc(1)));
0899                 set(gui.edit_handles.uncertchi2_max,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0900                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range_calc(2)));
0901                 set(gui.edit_handles.uncertmnorm_min,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0902                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range_calc(1)));
0903                 set(gui.edit_handles.uncertmnorm_max,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0904                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range_calc(2)));
0905                 set(gui.edit_handles.uncertThresh,<span class="string">'Enable'</span>,<span class="string">'on'</span>);
0906                 set(gui.edit_handles.uncertMax,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0907                     <span class="string">'String'</span>,num2str(uv.uncertMax));
0908             <span class="keyword">case</span> 4 <span class="comment">% ci - confidence intrval</span>
0909                 uv.uncertMethod = <span class="string">'ci'</span>;
0910                 uv.chi2_range_calc = [0 10];
0911                 uv.mnorm_range_calc = [0 10];
0912                 set(gui.edit_handles.uncertchi2_min,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0913                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range_calc(1)));
0914                 set(gui.edit_handles.uncertchi2_max,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0915                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range_calc(2)));
0916                 set(gui.edit_handles.uncertmnorm_min,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0917                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range_calc(1)));
0918                 set(gui.edit_handles.uncertmnorm_max,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0919                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range_calc(2)));
0920                 set(gui.edit_handles.uncertThresh,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0921                 set(gui.edit_handles.uncertMax,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0922                     <span class="string">'String'</span>,num2str(uv.uncertMax));
0923         <span class="keyword">end</span>
0924 <span class="keyword">end</span>
0925 
0926 <span class="comment">% update GUI data</span>
0927 data.uv = uv;
0928 setappdata(figh,<span class="string">'data'</span>,data);
0929 <span class="keyword">end</span>
0930 
0931 <span class="comment">%% subfunction to start a new uncertainty calculation</span>
0932 <a name="_sub7" href="#_subfunctions" class="code">function uv_onPushRun(src,~)</a>
0933 figh = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
0934 gui = getappdata(figh,<span class="string">'gui'</span>);
0935 data = getappdata(figh,<span class="string">'data'</span>);
0936 uv = data.uv;
0937 invstd = data.results.invstd;
0938 uncert = invstd.uncert;
0939 
0940 <span class="comment">% disable the CALC: button to indicate a running calculation</span>
0941 set(gui.push_handles.run,<span class="string">'String'</span>,<span class="string">'RUNNING ...'</span>,<span class="keyword">...</span>
0942     <span class="string">'BackgroundColor'</span>,get(gui.push_handles.update,<span class="string">'BackgroundColor'</span>),<span class="keyword">...</span>
0943     <span class="string">'Enable'</span>,<span class="string">'off'</span>); pause(0.01);
0944 
0945 <span class="comment">% original fit parameter</span>
0946 iparam = invstd.invparams;
0947 <span class="comment">% original uncertainty parameter</span>
0948 uparam = uncert.params;
0949 <span class="comment">% new uncertainty parameter from GUI</span>
0950 uparam.uncert.Method = uv.uncertMethod;
0951 uparam.uncert.Thresh = uv.uncertThresh;
0952 uparam.uncert.chi2_range = uv.chi2_range_calc;
0953 uparam.uncert.mnorm_range = uv.mnorm_range_calc;
0954 uparam.uncert.N = uv.uncertN;
0955 uparam.uncert.Max = uv.uncertMax;
0956 invstd = <a href="../../../nucleus/functions/inversion/estimateUncertainty.html" class="code" title="function [invstd,uncert] = estimateUncertainty(invtype,invstd,iparam,parameter)">estimateUncertainty</a>(invstd.invtype,invstd,iparam,uparam);
0957 
0958 <span class="comment">% enable the CALC. button</span>
0959 set(gui.push_handles.run,<span class="string">'String'</span>,<span class="string">'RUN UNCERT. CALC.'</span>,<span class="keyword">...</span>
0960     <span class="string">'BackgroundColor'</span>,<span class="string">'g'</span>,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="string">'Callback'</span>,@<a href="#_sub7" class="code" title="subfunction uv_onPushRun(src,~)">uv_onPushRun</a>);
0961 setappdata(figh,<span class="string">'gui'</span>,gui);
0962 
0963 <span class="comment">% save updated inversion results</span>
0964 invstd.uncert.params = uparam;
0965 data.results.invstd = invstd;
0966 
0967 <span class="comment">% update GUI data</span>
0968 <span class="comment">% round all chi2 and xn values to 6 digits</span>
0969 chi2_all = data.results.invstd.uncert.chi2_all;
0970 chi2_all = round(1e6.*chi2_all)./1e6;
0971 data.results.invstd.uncert.chi2_all = chi2_all;
0972 mnorm_all = data.results.invstd.uncert.mnorm_all;
0973 mnorm_all = round(1e6.*mnorm_all)./1e6;
0974 data.results.invstd.uncert.mnorm_all = mnorm_all;
0975 
0976 <span class="comment">% create logical mask</span>
0977 uv.touse = ones(uv.uncertN,1);
0978 
0979 <span class="comment">% 1.) control</span>
0980 uv.chi2_range_calc = [min(chi2_all) max(chi2_all)];
0981 uv.mnorm_range_calc = [min(mnorm_all) max(mnorm_all)];
0982 
0983 <span class="comment">% 2.) process</span>
0984 uv.chi2_range = uv.chi2_range_calc;
0985 uv.mnorm_range = uv.mnorm_range_calc;
0986 set(gui.edit_handles.chi2_min,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range(1,1)));
0987 set(gui.edit_handles.chi2_max,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range(1,2)));
0988 set(gui.edit_handles.mnorm_min,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range(1,1)));
0989 set(gui.edit_handles.mnorm_max,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range(1,2)));
0990 
0991 <span class="comment">% update data</span>
0992 data.uv = uv;
0993 setappdata(figh,<span class="string">'data'</span>,data);
0994 
0995 <span class="comment">% plot all uncertainty data</span>
0996 <a href="#_sub11" class="code" title="subfunction uv_updateInformation(figh)">uv_updateInformation</a>(figh);
0997 <a href="beautifyAxes.html" class="code" title="function beautifyAxes(figh)">beautifyAxes</a>(figh);
0998 <span class="keyword">end</span>
0999 
1000 <span class="comment">%% subfunction to export the current view to a figure</span>
1001 <a name="_sub8" href="#_subfunctions" class="code">function uv_onPushView(src,~)</a>
1002 figh = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
1003 <span class="comment">% local GUI data</span>
1004 gui = getappdata(figh,<span class="string">'gui'</span>);
1005 
1006 <span class="comment">% opening the export figure</span>
1007 expfig = figure(<span class="string">'Color'</span>,gui.myui.colors.panelBG);
1008 
1009 <span class="comment">% create axes layout depending on view</span>
1010 <span class="keyword">switch</span> get(gui.rightPanel,<span class="string">'Selection'</span>)
1011     <span class="keyword">case</span> 1
1012         <span class="comment">% create layout</span>
1013         ax1 = subplot(2,2,1,<span class="string">'Parent'</span>,expfig);
1014         ax2 = subplot(2,2,2,<span class="string">'Parent'</span>,expfig);
1015         ax3 = subplot(2,2,[3 4],<span class="string">'Parent'</span>,expfig);
1016         <span class="comment">% get positions</span>
1017         pos1 = get(ax1,<span class="string">'Position'</span>);
1018         pos2 = get(ax2,<span class="string">'Position'</span>);
1019         pos3 = get(ax3,<span class="string">'Position'</span>);
1020         <span class="comment">% delete axes</span>
1021         delete(ax1);delete(ax2);delete(ax3);
1022         <span class="comment">% copy GUI axes</span>
1023         ax1 = copyobj(gui.axes12,expfig);
1024         ax2 = copyobj(gui.axes11,expfig);
1025         ax3 = copyobj(gui.axes2,expfig);
1026         <span class="comment">% adjust positions</span>
1027         set(ax1,<span class="string">'Position'</span>,pos1);
1028         set(ax2,<span class="string">'Position'</span>,pos2);
1029         set(ax3,<span class="string">'Position'</span>,pos3);
1030         <span class="comment">% legend</span>
1031         legend(ax2,<span class="string">'Location'</span>,<span class="string">'best'</span>);
1032     <span class="keyword">case</span> 2
1033         <span class="comment">% create layout</span>
1034         ax1 = subplot(2,2,1,<span class="string">'Parent'</span>,expfig);
1035         ax2 = subplot(2,2,2,<span class="string">'Parent'</span>,expfig);
1036         ax3 = subplot(2,2,[3 4],<span class="string">'Parent'</span>,expfig);
1037         <span class="comment">% get positions</span>
1038         pos1 = get(ax1,<span class="string">'Position'</span>);
1039         pos2 = get(ax2,<span class="string">'Position'</span>);
1040         pos3 = get(ax3,<span class="string">'Position'</span>);
1041         <span class="comment">% delete axes</span>
1042         delete(ax1);delete(ax2);delete(ax3);
1043         <span class="comment">% copy GUI axes</span>
1044         ax1 = copyobj(gui.axes21,expfig);
1045         ax2 = copyobj(gui.axes22,expfig);
1046         ax3 = copyobj(gui.axes2,expfig);
1047         <span class="comment">% adjust positions</span>
1048         set(ax1,<span class="string">'Position'</span>,pos1);
1049         set(ax2,<span class="string">'Position'</span>,pos2);
1050         set(ax3,<span class="string">'Position'</span>,pos3);
1051         <span class="comment">% legend</span>
1052         legend(ax2,<span class="string">'Location'</span>,<span class="string">'best'</span>);
1053 <span class="keyword">end</span>
1054 
1055 <span class="keyword">end</span>
1056 
1057 <span class="comment">%% subfunction to update the main NUCLEUSinv GUI</span>
1058 <a name="_sub9" href="#_subfunctions" class="code">function uv_onPushUpdate(src,~)</a>
1059 figh = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
1060 <span class="comment">% local GUI data</span>
1061 uvgui = getappdata(figh,<span class="string">'gui'</span>);
1062 uvdata = getappdata(figh,<span class="string">'data'</span>);
1063 <span class="comment">% NUCLEUSinv data</span>
1064 gui = getappdata(uvgui.figh_nucleus,<span class="string">'gui'</span>);
1065 data = getappdata(uvgui.figh_nucleus,<span class="string">'data'</span>);
1066 INVdata = getappdata(uvgui.figh_nucleus,<span class="string">'INVdata'</span>);
1067 
1068 <span class="comment">% get signal id</span>
1069 id = data.results.invstd.uncert.params.id;
1070 <span class="comment">% get data</span>
1071 INVdata0 = INVdata{id};
1072 
1073 <span class="comment">% --- update data ---</span>
1074 <span class="comment">% -- general settings --</span>
1075 data.uncert.N = uvdata.uv.uncertN;
1076 data.uncert.Method = uvdata.uv.uncertMethod;
1077 data.uncert.Thresh = uvdata.uv.uncertThresh;
1078 data.uncert.Max = uvdata.uv.uncertMax;
1079 
1080 <span class="comment">% -- check if data was excluded --</span>
1081 <span class="keyword">if</span> sum(uvdata.uv.touse == 0) &gt; 0
1082     <span class="comment">% if yes, proceed</span>
1083     in = uvdata.uv.touse == 1;
1084     data.uncert.N = sum(in);
1085     uvdata.results.invstd.uncert.params.uncert.N = sum(in);
1086     uvdata.results.invstd.uncert.chi2_all = uvdata.results.invstd.uncert.chi2_all(in);
1087     uvdata.results.invstd.uncert.mnorm_all = uvdata.results.invstd.uncert.mnorm_all(in);
1088     uvdata.results.invstd.uncert.rnorm_all = uvdata.results.invstd.uncert.rnorm_all(in);
1089     uvdata.results.invstd.uncert.interp_f = uvdata.results.invstd.uncert.interp_f(in,:);
1090     uvdata.results.invstd.uncert.interp_s = uvdata.results.invstd.uncert.interp_s(:,in');
1091     uvdata.results.invstd.uncert.interp_E0 = uvdata.results.invstd.uncert.interp_E0(in);
1092     uvdata.results.invstd.uncert.E0 = [mean(uvdata.results.invstd.uncert.interp_E0) std(uvdata.results.invstd.uncert.interp_E0)];
1093     uvdata.results.invstd.uncert.interp_Tlgm = uvdata.results.invstd.uncert.interp_Tlgm(in);
1094     uvdata.results.invstd.uncert.Tlgm = [mean(uvdata.results.invstd.uncert.interp_Tlgm) std(uvdata.results.invstd.uncert.interp_Tlgm)];
1095 <span class="keyword">end</span>
1096 
1097 <span class="comment">% add statisitics</span>
1098 uvdata.results.invstd.uncert.statistics = uvdata.uv.stats;
1099 
1100 <span class="comment">% update data structs</span>
1101 data.results.invstd.uncert = uvdata.results.invstd.uncert;
1102 INVdata0.uncert = data.uncert;
1103 INVdata0.results.invstd = uvdata.results.invstd;
1104 
1105 <span class="comment">% update INVdata</span>
1106 INVdata{id} = INVdata0;
1107 <span class="comment">% update GUI data</span>
1108 setappdata(uvgui.figh_nucleus,<span class="string">'data'</span>,data);
1109 <span class="comment">% update GUI INVdata</span>
1110 setappdata(uvgui.figh_nucleus,<span class="string">'INVdata'</span>,INVdata);
1111 
1112 <span class="comment">% update relevant GUI elements</span>
1113 set(gui.edit_handles.uncert_N,<span class="string">'String'</span>,num2str(data.results.invstd.uncert.params.uncert.N))
1114 
1115 <span class="comment">% update plots and INFO fields in main NUCLEUS GUI</span>
1116 <a href="updatePlotsSignal.html" class="code" title="function updatePlotsSignal">updatePlotsSignal</a>;
1117 <a href="updatePlotsDistribution.html" class="code" title="function updatePlotsDistribution">updatePlotsDistribution</a>;
1118 <a href="updateInfo.html" class="code" title="function updateInfo(src,~) %#ok<INUSD>">updateInfo</a>(gui.plots.SignalPanel);
1119 
1120 <span class="keyword">end</span>
1121 
1122 <span class="comment">%% subfunction to reset chi2 and model norm bounds</span>
1123 <a name="_sub10" href="#_subfunctions" class="code">function uv_onPushReset(src,~)</a>
1124 figh = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
1125 gui = getappdata(figh,<span class="string">'gui'</span>);
1126 data = getappdata(figh,<span class="string">'data'</span>);
1127 uv = data.uv;
1128 invstd = data.results.invstd;
1129 uncert = invstd.uncert;
1130 
1131 <span class="keyword">switch</span> get(src,<span class="string">'Tag'</span>)
1132     <span class="keyword">case</span> <span class="string">'process'</span>
1133         <span class="comment">% reset to original values</span>
1134         chi2_range  = [min(uncert.chi2_all) max(uncert.chi2_all)];
1135         mnorm_range = [min(uncert.mnorm_all) max(uncert.mnorm_all)];
1136         <span class="comment">% update edit fields</span>
1137         set(gui.edit_handles.chi2_min,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,chi2_range(1,1)));
1138         set(gui.edit_handles.chi2_max,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,chi2_range(1,2)));
1139         set(gui.edit_handles.mnorm_min,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,mnorm_range(1,1)));
1140         set(gui.edit_handles.mnorm_max,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,mnorm_range(1,2)));
1141         <span class="comment">% update data</span>
1142         uv.chi2_range = chi2_range;
1143         uv.mnorm_range = mnorm_range;
1144         data.uv = uv;
1145         <span class="comment">% update logical mask for plotting</span>
1146         data = <a href="#_sub5" class="code" title="subfunction data = uv_updateMASK(data)">uv_updateMASK</a>(data);
1147     <span class="keyword">case</span> <span class="string">'rtd'</span>
1148         <span class="comment">% reset to original values</span>
1149         rtd_range = data.invstd.time;
1150         <span class="comment">% update edit fields</span>
1151         set(gui.edit_handles.rtd_min,<span class="string">'String'</span>,num2str(rtd_range(1,1)));
1152         set(gui.edit_handles.rtd_max,<span class="string">'String'</span>,num2str(rtd_range(1,2)));
1153         <span class="comment">% update data</span>
1154         uv.rtd_range = rtd_range;
1155         data.uv = uv;
1156 <span class="keyword">end</span>
1157 
1158 setappdata(figh,<span class="string">'data'</span>,data);
1159 <span class="comment">% update information</span>
1160 <a href="#_sub11" class="code" title="subfunction uv_updateInformation(figh)">uv_updateInformation</a>(figh);
1161 <span class="keyword">end</span>
1162 
1163 <span class="comment">%% subfunction to update the information output</span>
1164 <a name="_sub11" href="#_subfunctions" class="code">function uv_updateInformation(figh)</a>
1165 gui = getappdata(figh,<span class="string">'gui'</span>);
1166 data = getappdata(figh,<span class="string">'data'</span>);
1167 invstd = data.results.invstd;
1168 uncert = invstd.uncert;
1169 uv = data.uv;
1170 
1171 <span class="comment">% which models to use</span>
1172 in = data.uv.touse == 1;
1173 <span class="comment">% RTD time vector</span>
1174 T = data.results.invstd.T1T2me;
1175 <span class="comment">% kernel matrices for pure (single) E0 estimation</span>
1176 iparam = invstd.invparams;
1177 <span class="keyword">switch</span> iparam.T1T2
1178     <span class="keyword">case</span> <span class="string">'T1'</span>
1179         K0 = <a href="../../../nucleus/functions/inversion/createKernelMatrix.html" class="code" title="function K = createKernelMatrix(t,T,Tbulk,Tdiff,Tflag,T1IRfac)">createKernelMatrix</a>(10*data.results.nmrproc.t(end),T',<span class="keyword">...</span>
1180             iparam.Tb,iparam.Td,<span class="string">'T1'</span>,iparam.T1IRfac);
1181     <span class="keyword">case</span> <span class="string">'T2'</span>
1182         K0 = <a href="../../../nucleus/functions/inversion/createKernelMatrix.html" class="code" title="function K = createKernelMatrix(t,T,Tbulk,Tdiff,Tflag,T1IRfac)">createKernelMatrix</a>(0,T',iparam.Tb,<span class="keyword">...</span>
1183             iparam.Td,<span class="string">'T2'</span>,iparam.T1IRfac);
1184 <span class="keyword">end</span>
1185 <span class="comment">% get statistics</span>
1186 stats = <a href="../../../nucleus/functions/inversion/getUncertaintyStatistics.html" class="code" title="function out = getUncertaintyStatistics(T,RTDs,range,K0)">getUncertaintyStatistics</a>(T,uncert.interp_f(in,:),uv.rtd_range,K0);
1187 
1188 <span class="comment">% assign to GUI fields</span>
1189 <span class="comment">% TLGM</span>
1190 uv.Tlgm = [stats.Tlgm(1) stats.Tlgm(2)];
1191 set(gui.edit_handles.TLGM_mean,<span class="string">'String'</span>,sprintf(<span class="string">'%5.4f'</span>,uv.Tlgm(1)));
1192 set(gui.edit_handles.TLGM_std,<span class="string">'String'</span>,sprintf(<span class="string">'%5.4f'</span>,2*uv.Tlgm(2)));
1193 <span class="comment">% aad - mean</span>
1194 uv.Tlgm_aad = stats.Tlgm(3);
1195 set(gui.edit_handles.TLGM_aad,<span class="string">'String'</span>,sprintf(<span class="string">'%5.4f'</span>,2*uv.Tlgm_aad));
1196 <span class="comment">% aad - median</span>
1197 uv.Tlgm_aadmed = [stats.Tlgm_med(1) stats.Tlgm_med(2)];
1198 set(gui.edit_handles.TLGM_med,<span class="string">'String'</span>,sprintf(<span class="string">'%5.4f'</span>,uv.Tlgm_aadmed(1)));
1199 set(gui.edit_handles.TLGM_aadmed,<span class="string">'String'</span>,sprintf(<span class="string">'%5.4f'</span>,2*uv.Tlgm_aadmed(2)));
1200 <span class="comment">% E0</span>
1201 uv.E0 = [stats.E0(1) stats.E0(2)];
1202 set(gui.edit_handles.E0_mean,<span class="string">'String'</span>,sprintf(<span class="string">'%5.4f'</span>,uv.E0(1)));
1203 set(gui.edit_handles.E0_std,<span class="string">'String'</span>,sprintf(<span class="string">'%5.4f'</span>,2*uv.E0(2)));
1204 <span class="comment">% aad - mean</span>
1205 uv.E0_aad = stats.E0(3);
1206 set(gui.edit_handles.E0_aad,<span class="string">'String'</span>,sprintf(<span class="string">'%5.4f'</span>,2*uv.E0_aad));
1207 <span class="comment">% aad - median</span>
1208 uv.E0_aadmed = [stats.E0_med(1) stats.E0_med(2)];
1209 set(gui.edit_handles.E0_med,<span class="string">'String'</span>,sprintf(<span class="string">'%5.4f'</span>,uv.E0_aadmed(1)));
1210 set(gui.edit_handles.E0_aadmed,<span class="string">'String'</span>,sprintf(<span class="string">'%5.4f'</span>,2*uv.E0_aadmed(2)));
1211 
1212 <span class="comment">% update GUI data</span>
1213 uv.stats = stats;
1214 data.uv = uv;
1215 setappdata(figh,<span class="string">'data'</span>,data);
1216 <span class="comment">% update plots</span>
1217 <a href="#_sub12" class="code" title="subfunction uv_updatePlots(figh)">uv_updatePlots</a>(figh);
1218 
1219 <span class="keyword">end</span>
1220 
1221 <span class="comment">%% subfunction to update all plots</span>
1222 <a name="_sub12" href="#_subfunctions" class="code">function uv_updatePlots(figh)</a>
1223 gui = getappdata(figh,<span class="string">'gui'</span>);
1224 data = getappdata(figh,<span class="string">'data'</span>);
1225 
1226 <span class="comment">% clear axes</span>
1227 <a href="clearAllAxes.html" class="code" title="function clearAllAxes(figh)">clearAllAxes</a>(figh);
1228 hold(gui.axes11,<span class="string">'on'</span>);
1229 hold(gui.axes12,<span class="string">'on'</span>);
1230 hold(gui.axes2,<span class="string">'on'</span>);
1231 hold(gui.axes21,<span class="string">'on'</span>);
1232 hold(gui.axes22,<span class="string">'on'</span>);
1233 
1234 <span class="comment">% get relevant data</span>
1235 uv = data.uv;
1236 invstd = data.results.invstd;
1237 uncert = invstd.uncert;
1238 col = gui.myui.colors;
1239 
1240 <span class="comment">% get indices for models to use and not to use</span>
1241 in = data.uv.touse == 1;
1242 out = data.uv.touse == 0;
1243 
1244 <span class="keyword">switch</span> uv.colorstyle
1245     <span class="keyword">case</span> <span class="string">'none'</span>
1246         <span class="comment">% default gray</span>
1247         lcolors = [0.5 0.5 0.5];
1248         tmpchi2 = uncert.chi2_all(in);
1249         tmpmnorm = uncert.mnorm_all(in);
1250         <span class="comment">% tmpE0 = uncert.interp_E0(in);</span>
1251         <span class="comment">% tmpTlgm = uncert.interp_Tlgm(in);</span>
1252         tmpE0 = uv.stats.E0_all;
1253         tmpTlgm = uv.stats.Tlgm_all;
1254         clims = [0 1];
1255     <span class="keyword">case</span> <span class="string">'chi2'</span>
1256         tmp = uncert.chi2_all(in);
1257         [tmpchi2,idx] = sort(tmp);
1258         lcolors = tmpchi2;
1259         tmpmnorm = uncert.mnorm_all(in);
1260         tmpmnorm = tmpmnorm(idx);
1261         <span class="comment">% tmpE0 = uncert.interp_E0(in);</span>
1262         tmpE0 = uv.stats.E0_all;
1263         tmpE0 = tmpE0(idx);
1264         <span class="comment">% tmpTlgm = uncert.interp_Tlgm(in);</span>
1265         tmpTlgm = uv.stats.Tlgm_all;
1266         tmpTlgm = tmpTlgm(idx);
1267         clims = [min(uncert.chi2_all) max(uncert.chi2_all)];
1268     <span class="keyword">case</span> <span class="string">'xn'</span>
1269         tmp = uncert.mnorm_all(in);
1270         [tmpmnorm,idx] = sort(tmp);
1271         lcolors = tmpmnorm;
1272         tmpchi2 = uncert.chi2_all(in);
1273         tmpchi2 = tmpchi2(idx);
1274         <span class="comment">% tmpE0 = uncert.interp_E0(in);</span>
1275         tmpE0 = uv.stats.E0_all;
1276         tmpE0 = tmpE0(idx);
1277         <span class="comment">% tmpTlgm = uncert.interp_Tlgm(in);</span>
1278         tmpTlgm = uv.stats.Tlgm_all;
1279         tmpTlgm = tmpTlgm(idx);
1280         clims = [min(uncert.mnorm_all) max(uncert.mnorm_all)];
1281 <span class="keyword">end</span>
1282 
1283 <span class="comment">% --- chi2 vs model norm ---</span>
1284 scatter(uncert.chi2_all(out),uncert.mnorm_all(out),[],<span class="string">'red'</span>,<span class="keyword">...</span>
1285     <span class="string">'LineWidth'</span>,1,<span class="string">'Parent'</span>,gui.axes12);
1286 scatter(gui.axes12,tmpchi2,tmpmnorm,[],lcolors,<span class="keyword">...</span>
1287     <span class="string">'LineWidth'</span>,1);
1288 plot(invstd.chi2,invstd.xn,<span class="string">'+'</span>,<span class="string">'MarkerSize'</span>,10,<span class="string">'Color'</span>,col.FIT,<span class="string">'Parent'</span>,gui.axes12);
1289 <span class="comment">% axis limits</span>
1290 xlims = [min([uncert.chi2_all(in); invstd.chi2]) max([uncert.chi2_all(in); invstd.chi2])];
1291 dx = xlims(2)-xlims(1);
1292 xlims = [xlims(1)-dx/5 xlims(2)+dx/5];
1293 ylims = [min([uncert.mnorm_all(in); invstd.xn]) max([uncert.mnorm_all(in); invstd.xn])];
1294 dy = ylims(2)-ylims(1);
1295 ylims = [ylims(1)-dy/5 ylims(2)+dy/5];
1296 <span class="comment">% -- lines indicating TLGM and E0 bounds --</span>
1297 line([min(uncert.chi2_all(in)) min(uncert.chi2_all(in))],[ylims(1) ylims(2)],<span class="string">'Color'</span>,[0.25 0.25 0.25],<span class="keyword">...</span>
1298     <span class="string">'LineStyle'</span>,<span class="string">':'</span>,<span class="string">'LineWidth'</span>,0.75,<span class="string">'Parent'</span>,gui.axes12,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1299 line([max(uncert.chi2_all(in)) max(uncert.chi2_all(in))],[ylims(1) ylims(2)],<span class="string">'Color'</span>,[0.25 0.25 0.25],<span class="keyword">...</span>
1300     <span class="string">'LineStyle'</span>,<span class="string">':'</span>,<span class="string">'LineWidth'</span>,0.75,<span class="string">'Parent'</span>,gui.axes12,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1301 line([xlims(1) xlims(2)],[min(uncert.mnorm_all(in)) min(uncert.mnorm_all(in))],<span class="string">'Color'</span>,[0.25 0.25 0.25],<span class="keyword">...</span>
1302     <span class="string">'LineStyle'</span>,<span class="string">':'</span>,<span class="string">'LineWidth'</span>,0.75,<span class="string">'Parent'</span>,gui.axes12,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1303 line([xlims(1) xlims(2)],[max(uncert.mnorm_all(in)) max(uncert.mnorm_all(in))],<span class="string">'Color'</span>,[0.25 0.25 0.25],<span class="keyword">...</span>
1304     <span class="string">'LineStyle'</span>,<span class="string">':'</span>,<span class="string">'LineWidth'</span>,0.75,<span class="string">'Parent'</span>,gui.axes12,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1305 <span class="comment">% axis setings</span>
1306 set(gui.axes12,<span class="string">'XScale'</span>,<span class="string">'lin'</span>,<span class="string">'XLim'</span>,xlims);
1307 set(gui.axes12,<span class="string">'YScale'</span>,<span class="string">'log'</span>,<span class="string">'YLim'</span>,ylims);
1308 set(gui.axes12,<span class="string">'CLim'</span>,clims);
1309 set(get(gui.axes12,<span class="string">'XLabel'</span>),<span class="string">'String'</span>,<span class="string">'X² (error weighted residuals)'</span>);
1310 set(get(gui.axes12,<span class="string">'YLabel'</span>),<span class="string">'String'</span>,<span class="string">'model norm |Lm|_{2}'</span>);
1311 
1312 <span class="comment">% --- TLGM vs E0 ---</span>
1313 scatter(uncert.interp_Tlgm(out),uncert.interp_E0(out),[],<span class="string">'red'</span>,<span class="keyword">...</span>
1314     <span class="string">'LineWidth'</span>,1,<span class="string">'DisplayName'</span>,<span class="string">'runs (out)'</span>,<span class="string">'Parent'</span>,gui.axes11);
1315 scatter(tmpTlgm,tmpE0,[],lcolors,<span class="keyword">...</span>
1316     <span class="string">'LineWidth'</span>,1,<span class="string">'DisplayName'</span>,<span class="string">'runs (in)'</span>,<span class="string">'Parent'</span>,gui.axes11);
1317 plot(invstd.Tlgm,invstd.E0,<span class="string">'+'</span>,<span class="string">'MarkerSize'</span>,10,<span class="string">'Color'</span>,col.FIT,<span class="keyword">...</span>
1318     <span class="string">'DisplayName'</span>,<span class="string">'init'</span>,<span class="string">'Parent'</span>,gui.axes11);
1319 errorbar(uv.Tlgm(1),uv.E0(1),2*uv.E0(2),2*uv.E0(2),2*uv.Tlgm(2),2*uv.Tlgm(2),<span class="keyword">...</span>
1320     <span class="string">'Color'</span>,col.BoxPRC,<span class="string">'LineWidth'</span>,2,<span class="string">'DisplayName'</span>,<span class="string">'mean (2*std)'</span>,<span class="string">'Parent'</span>,gui.axes11);
1321 errorbar(uv.Tlgm_aadmed(1),uv.E0_aadmed(1),2*uv.E0_aadmed(2),2*uv.E0_aadmed(2),2*uv.Tlgm_aadmed(2),2*uv.Tlgm_aadmed(2),<span class="keyword">...</span>
1322     <span class="string">'Color'</span>,col.BoxCPS,<span class="string">'LineWidth'</span>,2,<span class="string">'DisplayName'</span>,<span class="string">'median (2*aad)'</span>,<span class="string">'Parent'</span>,gui.axes11);
1323 <span class="comment">% axis limits</span>
1324 <span class="comment">% xlims = [min([uncert.interp_Tlgm; invstd.Tlgm; uv.Tlgm(1)])*0.95 ...</span>
1325 <span class="comment">%     max([uncert.interp_Tlgm; invstd.Tlgm; uv.Tlgm(1)])*1.05];</span>
1326 <span class="comment">% ylims = [min([uncert.interp_E0; invstd.E0; uv.E0(1)])*0.95 ...</span>
1327 <span class="comment">%     max([uncert.interp_E0; invstd.E0; uv.E0(1)])*1.05];</span>
1328 xlims = [min([uncert.interp_Tlgm(in); invstd.Tlgm; uv.Tlgm(1)])*0.975 <span class="keyword">...</span>
1329     max([uncert.interp_Tlgm(in); invstd.Tlgm; uv.Tlgm(1)])*1.025];
1330 ylims = [min([uncert.interp_E0(in); invstd.E0; uv.E0(1)])*0.975 <span class="keyword">...</span>
1331     max([uncert.interp_E0(in); invstd.E0; uv.E0(1)])*1.025];
1332 <span class="comment">% -- lines indicating TLGM and E0 bounds --</span>
1333 line([min(uncert.interp_Tlgm(in)) min(uncert.interp_Tlgm(in))],[ylims(1) ylims(2)],<span class="string">'Color'</span>,[0.25 0.25 0.25],<span class="keyword">...</span>
1334     <span class="string">'LineStyle'</span>,<span class="string">':'</span>,<span class="string">'LineWidth'</span>,0.75,<span class="string">'HandleVisibility'</span>,<span class="string">'off'</span>,<span class="string">'Parent'</span>,gui.axes11,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1335 line([max(uncert.interp_Tlgm(in)) max(uncert.interp_Tlgm(in))],[ylims(1) ylims(2)],<span class="string">'Color'</span>,[0.25 0.25 0.25],<span class="keyword">...</span>
1336     <span class="string">'LineStyle'</span>,<span class="string">':'</span>,<span class="string">'LineWidth'</span>,0.75,<span class="string">'HandleVisibility'</span>,<span class="string">'off'</span>,<span class="string">'Parent'</span>,gui.axes11,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1337 line([xlims(1) xlims(2)],[min(uncert.interp_E0(in)) min(uncert.interp_E0(in))],<span class="string">'Color'</span>,[0.25 0.25 0.25],<span class="keyword">...</span>
1338     <span class="string">'LineStyle'</span>,<span class="string">':'</span>,<span class="string">'LineWidth'</span>,0.75,<span class="string">'HandleVisibility'</span>,<span class="string">'off'</span>,<span class="string">'Parent'</span>,gui.axes11,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1339 line([xlims(1) xlims(2)],[max(uncert.interp_E0(in)) max(uncert.interp_E0(in))],<span class="string">'Color'</span>,[0.25 0.25 0.25],<span class="keyword">...</span>
1340     <span class="string">'LineStyle'</span>,<span class="string">':'</span>,<span class="string">'LineWidth'</span>,0.75,<span class="string">'HandleVisibility'</span>,<span class="string">'off'</span>,<span class="string">'Parent'</span>,gui.axes11,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1341 legend(gui.axes11,<span class="string">'Location'</span>,<span class="string">'NorthEast'</span>);
1342 <span class="comment">% axis settings</span>
1343 set(gui.axes11,<span class="string">'XScale'</span>,<span class="string">'lin'</span>,<span class="string">'XLim'</span>,xlims);
1344 set(gui.axes11,<span class="string">'YScale'</span>,<span class="string">'lin'</span>,<span class="string">'YLim'</span>,ylims);
1345 set(gui.axes11,<span class="string">'CLim'</span>,clims);
1346 set(get(gui.axes11,<span class="string">'XLabel'</span>),<span class="string">'String'</span>,<span class="string">'TLGM'</span>);
1347 set(get(gui.axes11,<span class="string">'YLabel'</span>),<span class="string">'String'</span>,<span class="string">'initial amplitude E0'</span>);
1348 
1349 <span class="comment">% --- RTDs ---</span>
1350 plotmethod = 1;
1351 <span class="keyword">switch</span> uv.rtd_plotstyle
1352     <span class="keyword">case</span> <span class="string">'patchmean'</span>
1353         plotmethod = 2;
1354     <span class="keyword">case</span> <span class="string">'patchmedian'</span>
1355         plotmethod = 3;
1356     <span class="keyword">otherwise</span>
1357         <span class="comment">% nothing to do because 'lines' is default</span>
1358 <span class="keyword">end</span>
1359 
1360 <span class="comment">% the 'init' RTD</span>
1361 F0 = invstd.T1T2f;
1362 <span class="comment">% normalize all curves to the median of all E0 values</span>
1363 E0norm = uv.E0_aadmed(1);
1364 <span class="keyword">if</span> sum(F0)&gt;0
1365     F = (data.invstd.porosity*100).*F0./E0norm;
1366     ylims = [0 max(F)*1.05];
1367 <span class="keyword">else</span>
1368     ylims = [-1 1];
1369 <span class="keyword">end</span>
1370 <span class="comment">% the uncertainty runs</span>
1371 <span class="comment">% only the selected ones within the chi2 and xn bounds</span>
1372 FDIST = uncert.interp_f(in,:);
1373 <span class="comment">% scaling</span>
1374 FDIST = (data.invstd.porosity*100).*FDIST./E0norm;
1375 
1376 <span class="comment">% if selected plot lines</span>
1377 <span class="keyword">if</span> plotmethod == 1
1378     <span class="comment">% find maximum for axis limts</span>
1379     f_max = max([ylims(2) max(FDIST(:))]);
1380     <span class="keyword">switch</span> uv.colorstyle
1381         <span class="keyword">case</span> {<span class="string">'chi2'</span>,<span class="string">'xn'</span>}
1382             <span class="comment">% get colormap from chi2 vs xn axis</span>
1383             cmap = get(gui.axes12,<span class="string">'Colormap'</span>);
1384             <span class="comment">% make vector of values to sort</span>
1385             idc = linspace(clims(1),clims(2),size(cmap,1));
1386             <span class="keyword">for</span> i1 = 1:sum(in)
1387                 <span class="comment">% find closest value (need for coloring)</span>
1388                 idc1 = find(abs(idc-tmp(idx(i1)))==min(abs(idc-tmp(idx(i1)))));
1389                 <span class="comment">% idc1 = abs(idc-tmp(idx(i1)))==min(abs(idc-tmp(idx(i1))));</span>
1390                 <span class="comment">% plot line with correct color</span>
1391                 plot(invstd.T1T2me,FDIST(idx(i1),:),<span class="string">'-'</span>,<span class="string">'Color'</span>,cmap(idc1(1),:),<span class="keyword">...</span>
1392                     <span class="string">'LineWidth'</span>,1,<span class="string">'Displayname'</span>,num2str(tmp(idx(i1))),<span class="string">'Parent'</span>,gui.axes2);
1393             <span class="keyword">end</span>
1394             <span class="comment">% adjust color limits</span>
1395             set(gui.axes2,<span class="string">'CLim'</span>,clims);
1396         <span class="keyword">otherwise</span>
1397             <span class="comment">% need to plot transpose of FDIST because 'x' is a column vector</span>
1398             <span class="comment">% otherwise plot goes bananas if numel(x) = #models</span>
1399             plot(invstd.T1T2me,FDIST',<span class="string">'-'</span>,<span class="string">'Color'</span>,[0.5 0.5 0.5],<span class="keyword">...</span>
1400                 <span class="string">'LineWidth'</span>,1,<span class="string">'Parent'</span>,gui.axes2);
1401     <span class="keyword">end</span>
1402 <span class="keyword">end</span>
1403 
1404 <span class="comment">% if selected plot patch</span>
1405 <span class="keyword">if</span> plotmethod &gt; 1
1406     <span class="comment">% what kind of patch is created</span>
1407     <span class="keyword">if</span> plotmethod == 2 <span class="comment">% mean +- std</span>
1408         mean_f = mean(FDIST);
1409         std_f = std(FDIST);
1410     <span class="keyword">else</span> <span class="comment">% median +- mad</span>
1411         mean_f = median(FDIST);
1412         std_f = <a href="../../../nucleus/functions/inversion/getAAD.html" class="code" title="function aad = getAAD(x,flag,dim)">getAAD</a>(FDIST,1);
1413     <span class="keyword">end</span>
1414 
1415     <span class="comment">% patch lower and upper bounds</span>
1416     patch_f_std1 = [mean_f+std_f;mean_f-std_f];
1417     patch_f_std2 = [mean_f+2*std_f;mean_f-2*std_f];
1418     patch_f_std3 = [mean_f+3*std_f;mean_f-3*std_f];
1419     patch_f_std1(patch_f_std1&lt;0) = 0;
1420     patch_f_std2(patch_f_std2&lt;0) = 0;
1421     patch_f_std3(patch_f_std3&lt;0) = 0;
1422     f_max = max([ylims(2) max(patch_f_std1) max(patch_f_std2) max(patch_f_std3)]);
1423 
1424     <span class="comment">% draw all three patches on top of each other</span>
1425     verts = [invstd.T1T2me patch_f_std3(2,:)'; flipud(invstd.T1T2me) flipud(patch_f_std3(1,:)')];
1426     faces = 1:1:size(verts,1);
1427     patch(<span class="string">'Faces'</span>,faces,<span class="string">'Vertices'</span>,verts,<span class="string">'FaceColor'</span>,[0.6 0.6 0.6],<span class="keyword">...</span>
1428         <span class="string">'FaceAlpha'</span>,0.75,<span class="string">'EdgeColor'</span>,<span class="string">'none'</span>,<span class="string">'Parent'</span>,gui.axes2);
1429     verts = [invstd.T1T2me patch_f_std2(2,:)'; flipud(invstd.T1T2me) flipud(patch_f_std2(1,:)')];
1430     faces = 1:1:size(verts,1);
1431     patch(<span class="string">'Faces'</span>,faces,<span class="string">'Vertices'</span>,verts,<span class="string">'FaceColor'</span>,[0.4 0.4 0.4],<span class="keyword">...</span>
1432         <span class="string">'FaceAlpha'</span>,0.75,<span class="string">'EdgeColor'</span>,<span class="string">'none'</span>,<span class="string">'Parent'</span>,gui.axes2);
1433     verts = [invstd.T1T2me patch_f_std1(2,:)'; flipud(invstd.T1T2me) flipud(patch_f_std1(1,:)')];
1434     faces = 1:1:size(verts,1);
1435     patch(<span class="string">'Faces'</span>,faces,<span class="string">'Vertices'</span>,verts,<span class="string">'FaceColor'</span>,[0.2 0.2 0.2],<span class="keyword">...</span>
1436         <span class="string">'FaceAlpha'</span>,0.75,<span class="string">'EdgeColor'</span>,<span class="string">'none'</span>,<span class="string">'Parent'</span>,gui.axes2);
1437 <span class="keyword">end</span>
1438 
1439 <span class="comment">% adjust y-limits</span>
1440 ylims(2) = max([ylims(2) max(f_max)*1.05]);
1441 
1442 <span class="comment">% plot original solution</span>
1443 plot(invstd.T1T2me,F,<span class="string">'-'</span>,<span class="string">'Color'</span>,col.FIT,<span class="string">'Parent'</span>,gui.axes2);
1444 
1445 <span class="comment">% axes properties</span>
1446 ticks = 10.^(round(log10(min(invstd.T1T2me)) :1: log10(max(invstd.T1T2me))));
1447 set(gui.axes2,<span class="string">'XScale'</span>,<span class="string">'log'</span>,<span class="string">'XLim'</span>,[ticks(1) ticks(end)],<span class="string">'XTick'</span>,ticks);
1448 set(gui.axes2,<span class="string">'YScale'</span>,<span class="string">'lin'</span>,<span class="string">'YLim'</span>,ylims);
1449 set(get(gui.axes2,<span class="string">'XLabel'</span>),<span class="string">'String'</span>,<span class="string">'relaxation time'</span>);
1450 set(get(gui.axes2,<span class="string">'YLabel'</span>),<span class="string">'String'</span>,<span class="string">'amplitude'</span>);
1451 grid(gui.axes2,<span class="string">'on'</span>);
1452 
1453 <span class="comment">% -- RTD bounds --</span>
1454 uv = data.uv;
1455 <span class="comment">% line([uv.rtd_range(1) uv.rtd_range(1)],[0 ylims(2)],'Color',[0.25 0.25 0.25],...</span>
1456 <span class="comment">%     'LineStyle','-.','LineWidth',2,'Parent',gui.axes2,'Tag','infolines');</span>
1457 <span class="comment">% line([uv.rtd_range(2) uv.rtd_range(2)],[0 ylims(2)],'Color',[0.25 0.25 0.25],...</span>
1458 <span class="comment">%     'LineStyle','-.','LineWidth',2,'Parent',gui.axes2,'Tag','infolines');</span>
1459 p_alpha = 0.8;
1460 <span class="keyword">if</span> uv.rtd_range(1)&gt;ticks(1)
1461     <span class="comment">% draw a transparent patch</span>
1462     v = [ticks(1) ylims(1); ticks(1) ylims(2);
1463         uv.rtd_range(1) ylims(2); uv.rtd_range(1) ylims(1)];
1464     f = [1 2 3 4 1];
1465     patch(<span class="string">'Vertices'</span>,v,<span class="string">'Faces'</span>,f,<span class="string">'FaceColor'</span>,<span class="string">'w'</span>,<span class="string">'FaceAlpha'</span>,p_alpha,<span class="keyword">...</span>
1466         <span class="string">'HandleVisibility'</span>,<span class="string">'off'</span>,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>,<span class="string">'Parent'</span>, gui.axes2);
1467 <span class="keyword">end</span>
1468 <span class="keyword">if</span> uv.rtd_range(2)&lt;ticks(end)
1469     <span class="comment">% draw a transparent patch</span>
1470     v = [ticks(end) ylims(1); ticks(end) ylims(2);
1471         uv.rtd_range(2) ylims(2); uv.rtd_range(2) ylims(1)];
1472     f = [1 2 3 4 1];
1473     patch(<span class="string">'Vertices'</span>,v,<span class="string">'Faces'</span>,f,<span class="string">'FaceColor'</span>,<span class="string">'w'</span>,<span class="string">'FaceAlpha'</span>,p_alpha,<span class="keyword">...</span>
1474         <span class="string">'HandleVisibility'</span>,<span class="string">'off'</span>,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>,<span class="string">'Parent'</span>, gui.axes2);
1475 <span class="keyword">end</span>
1476 
1477 <span class="comment">% --- Histograms ---</span>
1478 <span class="comment">% [f1,xi1] = getKernelDensityEstimate(uncert.interp_E0(in));</span>
1479 <span class="comment">% [f2,xi2] = getKernelDensityEstimate(uncert.interp_Tlgm(in));</span>
1480 [f1,xi1] = <a href="getKernelDensityEstimate.html" class="code" title="function [f,x] = getKernelDensityEstimate(y)">getKernelDensityEstimate</a>(uv.stats.E0_all);
1481 [f2,xi2] = <a href="getKernelDensityEstimate.html" class="code" title="function [f,x] = getKernelDensityEstimate(y)">getKernelDensityEstimate</a>(uv.stats.Tlgm_all);
1482 
1483 <span class="comment">% plot the KDEs</span>
1484 plot(xi1,f1,<span class="string">'Color'</span>,[0.5 0.5 0.5],<span class="string">'DisplayName'</span>,<span class="string">'KDE'</span>,<span class="string">'Parent'</span>,gui.axes21);
1485 plot(xi2,f2,<span class="string">'Color'</span>,[0.5 0.5 0.5],<span class="string">'DisplayName'</span>,<span class="string">'KDE'</span>,<span class="string">'Parent'</span>,gui.axes22);
1486 
1487 <span class="comment">% &quot;init&quot; E0</span>
1488 line([invstd.E0 invstd.E0],[0 max(f1)],<span class="string">'Color'</span>,col.FIT,<span class="keyword">...</span>
1489     <span class="string">'LineStyle'</span>,<span class="string">':'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'Parent'</span>,gui.axes21,<span class="string">'DisplayName'</span>,<span class="string">'init'</span>,<span class="keyword">...</span>
1490     <span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1491 <span class="comment">% &quot;init&quot; TLGM</span>
1492 line([invstd.Tlgm invstd.Tlgm],[0 max(f2)],<span class="string">'Color'</span>,col.FIT,<span class="keyword">...</span>
1493     <span class="string">'LineStyle'</span>,<span class="string">':'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'Parent'</span>,gui.axes22,<span class="string">'DisplayName'</span>,<span class="string">'init'</span>,<span class="keyword">...</span>
1494     <span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1495 
1496 <span class="comment">% mean E0</span>
1497 line([uv.E0(1) uv.E0(1)],[0 max(f1)],<span class="string">'Color'</span>,col.BoxPRC,<span class="keyword">...</span>
1498     <span class="string">'LineStyle'</span>,<span class="string">'-'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'Parent'</span>,gui.axes21,<span class="string">'DisplayName'</span>,<span class="string">'mean'</span>);
1499 line([uv.E0(1)+2*uv.E0(2) uv.E0(1)+2*uv.E0(2)],[0 max(f1)],<span class="string">'Color'</span>,col.BoxPRC,<span class="keyword">...</span>
1500     <span class="string">'LineStyle'</span>,<span class="string">'--'</span>,<span class="string">'LineWidth'</span>,1,<span class="string">'Parent'</span>,gui.axes21,<span class="string">'DisplayName'</span>,<span class="string">'2*std'</span>);
1501 line([uv.E0(1)-2*uv.E0(2) uv.E0(1)-2*uv.E0(2)],[0 max(f1)],<span class="string">'Color'</span>,col.BoxPRC,<span class="keyword">...</span>
1502     <span class="string">'LineStyle'</span>,<span class="string">'--'</span>,<span class="string">'LineWidth'</span>,1,<span class="string">'Parent'</span>,gui.axes21,<span class="string">'DisplayName'</span>,<span class="string">'2*std'</span>,<span class="keyword">...</span>
1503     <span class="string">'HandleVisibility'</span>,<span class="string">'off'</span>,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1504 
1505 <span class="comment">% mean TLGM</span>
1506 line([uv.Tlgm(1) uv.Tlgm(1)],[0 max(f2)],<span class="string">'Color'</span>,col.BoxPRC,<span class="keyword">...</span>
1507     <span class="string">'LineStyle'</span>,<span class="string">'-'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'Parent'</span>,gui.axes22,<span class="string">'DisplayName'</span>,<span class="string">'mean'</span>);
1508 line([uv.Tlgm(1)+2*uv.Tlgm(2) uv.Tlgm(1)+2*uv.Tlgm(2)],[0 max(f2)],<span class="string">'Color'</span>,col.BoxPRC,<span class="keyword">...</span>
1509     <span class="string">'LineStyle'</span>,<span class="string">'--'</span>,<span class="string">'LineWidth'</span>,1,<span class="string">'Parent'</span>,gui.axes22,<span class="string">'DisplayName'</span>,<span class="string">'2*std'</span>);
1510 line([uv.Tlgm(1)-2*uv.Tlgm(2) uv.Tlgm(1)-2*uv.Tlgm(2)],[0 max(f2)],<span class="string">'Color'</span>,col.BoxPRC,<span class="keyword">...</span>
1511     <span class="string">'LineStyle'</span>,<span class="string">'--'</span>,<span class="string">'LineWidth'</span>,1,<span class="string">'Parent'</span>,gui.axes22,<span class="string">'DisplayName'</span>,<span class="string">'2*std'</span>,<span class="keyword">...</span>
1512     <span class="string">'HandleVisibility'</span>,<span class="string">'off'</span>,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1513 
1514 <span class="comment">% median E0</span>
1515 line([uv.E0_aadmed(1) uv.E0_aadmed(1)],[0 max(f1)],<span class="string">'Color'</span>,col.BoxCPS,<span class="keyword">...</span>
1516     <span class="string">'LineStyle'</span>,<span class="string">'-'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'Parent'</span>,gui.axes21,<span class="string">'DisplayName'</span>,<span class="string">'median'</span>);
1517 line([uv.E0_aadmed(1)+2*uv.E0_aadmed(2) uv.E0_aadmed(1)+2*uv.E0_aadmed(2)],<span class="keyword">...</span>
1518     [0 max(f1)],<span class="string">'Color'</span>,col.BoxCPS,<span class="string">'LineStyle'</span>,<span class="string">'--'</span>,<span class="string">'LineWidth'</span>,1,<span class="keyword">...</span>
1519     <span class="string">'Parent'</span>,gui.axes21,<span class="string">'DisplayName'</span>,<span class="string">'2*aad'</span>);
1520 line([uv.E0_aadmed(1)-2*uv.E0_aadmed(2) uv.E0_aadmed(1)-2*uv.E0_aadmed(2)],<span class="keyword">...</span>
1521     [0 max(f1)],<span class="string">'Color'</span>,col.BoxCPS,<span class="string">'LineStyle'</span>,<span class="string">'--'</span>,<span class="string">'LineWidth'</span>,1,<span class="keyword">...</span>
1522     <span class="string">'Parent'</span>,gui.axes21,<span class="string">'DisplayName'</span>,<span class="string">'2*aad'</span>,<span class="string">'HandleVisibility'</span>,<span class="string">'off'</span>,<span class="keyword">...</span>
1523     <span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1524 
1525 <span class="comment">% median TLGM</span>
1526 line([uv.Tlgm_aadmed(1) uv.Tlgm_aadmed(1)],[0 max(f2)],<span class="string">'Color'</span>,col.BoxCPS,<span class="keyword">...</span>
1527     <span class="string">'LineStyle'</span>,<span class="string">'-'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'Parent'</span>,gui.axes22,<span class="string">'DisplayName'</span>,<span class="string">'median'</span>);
1528 line([uv.Tlgm_aadmed(1)+2*uv.Tlgm_aadmed(2) uv.Tlgm_aadmed(1)+2*uv.Tlgm_aadmed(2)],<span class="keyword">...</span>
1529     [0 max(f2)],<span class="string">'Color'</span>,col.BoxCPS,<span class="string">'LineStyle'</span>,<span class="string">'--'</span>,<span class="string">'LineWidth'</span>,1,<span class="keyword">...</span>
1530     <span class="string">'Parent'</span>,gui.axes22,<span class="string">'DisplayName'</span>,<span class="string">'2*aad'</span>);
1531 line([uv.Tlgm_aadmed(1)-2*uv.Tlgm_aadmed(2) uv.Tlgm_aadmed(1)-2*uv.Tlgm_aadmed(2)],<span class="keyword">...</span>
1532     [0 max(f2)],<span class="string">'Color'</span>,col.BoxCPS,<span class="string">'LineStyle'</span>,<span class="string">'--'</span>,<span class="string">'LineWidth'</span>,1,<span class="keyword">...</span>
1533     <span class="string">'Parent'</span>,gui.axes22,<span class="string">'DisplayName'</span>,<span class="string">'2*aad'</span>,<span class="string">'HandleVisibility'</span>,<span class="string">'off'</span>,<span class="keyword">...</span>
1534     <span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1535 
1536 legend(gui.axes22,<span class="string">'Location'</span>,<span class="string">'NorthWest'</span>);
1537 
1538 <span class="comment">% axes properties</span>
1539 set(get(gui.axes21,<span class="string">'XLabel'</span>),<span class="string">'String'</span>,<span class="string">'E0'</span>);
1540 set(get(gui.axes21,<span class="string">'YLabel'</span>),<span class="string">'String'</span>,<span class="string">'kernel denisty estimate'</span>);
1541 set(get(gui.axes22,<span class="string">'XLabel'</span>),<span class="string">'String'</span>,<span class="string">'TLGM'</span>);
1542 set(get(gui.axes22,<span class="string">'YLabel'</span>),<span class="string">'String'</span>,<span class="string">'kernel density estimate'</span>);
1543 
1544 <span class="comment">% hold off all axes</span>
1545 hold(gui.axes11,<span class="string">'off'</span>);
1546 hold(gui.axes12,<span class="string">'off'</span>);
1547 hold(gui.axes2,<span class="string">'off'</span>);
1548 hold(gui.axes21,<span class="string">'off'</span>);
1549 hold(gui.axes22,<span class="string">'off'</span>);
1550 <span class="keyword">end</span>
1551 
1552 <span class="comment">%% close function</span>
1553 <a name="_sub13" href="#_subfunctions" class="code">function uv_closeme(src,~)</a>
1554 figh = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
1555 <span class="comment">% try to close the sub GUI in a clean manner</span>
1556 <span class="keyword">try</span>
1557     <span class="comment">% NOTE: maybe needed at some later point</span>
1558     <span class="comment">%     gui = getappdata(figh,'gui');</span>
1559     <span class="comment">%     data = getappdata(gui.figh_nucleus,'data');</span>
1560     <span class="comment">%     % update NUCLEUSinv</span>
1561     <span class="comment">%     setappdata(gui.figh_nucleus,'data',data);</span>
1562     delete(figh);
1563 <span class="keyword">catch</span>
1564     <span class="comment">% if this is not working: just close it</span>
1565     delete(figh);
1566 <span class="keyword">end</span>
1567 
1568 <span class="keyword">end</span>
1569 
1570 <span class="comment">%------------- END OF CODE --------------</span>
1571 
1572 <span class="comment">%% License:</span>
1573 <span class="comment">% MIT License</span>
1574 <span class="comment">%</span>
1575 <span class="comment">% Copyright (c) 2024 Thomas Hiller</span>
1576 <span class="comment">%</span>
1577 <span class="comment">% Permission is hereby granted, free of charge, to any person obtaining a copy</span>
1578 <span class="comment">% of this software and associated documentation files (the &quot;Software&quot;), to deal</span>
1579 <span class="comment">% in the Software without restriction, including without limitation the rights</span>
1580 <span class="comment">% to use, copy, modify, merge, publish, distribute, sublicense, and/or sell</span>
1581 <span class="comment">% copies of the Software, and to permit persons to whom the Software is</span>
1582 <span class="comment">% furnished to do so, subject to the following conditions:</span>
1583 <span class="comment">%</span>
1584 <span class="comment">% The above copyright notice and this permission notice shall be included in all</span>
1585 <span class="comment">% copies or substantial portions of the Software.</span>
1586 <span class="comment">%</span>
1587 <span class="comment">% THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
1588 <span class="comment">% IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
1589 <span class="comment">% FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span>
1590 <span class="comment">% AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span>
1591 <span class="comment">% LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span>
1592 <span class="comment">% OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE</span>
1593 <span class="comment">% SOFTWARE.</span></pre></div>
<hr><address>Generated by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>