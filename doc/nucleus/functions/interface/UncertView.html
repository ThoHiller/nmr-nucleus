<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of UncertView</title>
  <meta name="keywords" content="UncertView">
  <meta name="description" content=" is an extra subGUI to show results of the uncertainty">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- # nucleus --><!-- # functions --><!-- menu.html interface -->
<h1>UncertView
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong> is an extra subGUI to show results of the uncertainty</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function UncertView(src,~) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment">UncertView is an extra subGUI to show results of the uncertainty
calculation

 Syntax:
       UncertView

 Inputs:
       src - handle of the calling object

 Outputs:
       none

 Example:
       UncertView(src,~)

 Other m-files required:
       beautifyAxes
       clearAllAxes
       estimateUncertainty
       createKernelMatrix
       updatePlotsSignal
       updatePlotsDistribution
       updateInfo

 Subfunctions:
       uv_closeme
       uv_onEditValue
       uv_updateMASK
       uv_onPushRun
       uv_onPushUpdate
       uv_onPushReset
       uv_updateInformation
       uv_updatePlots

 MAT-files required:
       none

 See also: NUCLEUSinv
 Author: see AUTHORS.md
 email: see AUTHORS.md
 License: MIT License (at end)</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="beautifyAxes.html" class="code" title="function beautifyAxes(figh)">beautifyAxes</a>	 can be used to globally change the general appearance of axes</li><li><a href="clearAllAxes.html" class="code" title="function clearAllAxes(figh)">clearAllAxes</a>	 clears all axes of a given figure</li><li><a href="minimizePanel.html" class="code" title="function minimizePanel(src,~)">minimizePanel</a>	 handles the minimization/maximization of all box-panels for</li><li><a href="updateInfo.html" class="code" title="function updateInfo(src,~) %#ok<INUSD>">updateInfo</a>	 updates the information shown in all information list boxes</li><li><a href="updatePlotsDistribution.html" class="code" title="function updatePlotsDistribution">updatePlotsDistribution</a>	 plots the RTD and PSD curves into NUCLEUSinv</li><li><a href="updatePlotsSignal.html" class="code" title="function updatePlotsSignal">updatePlotsSignal</a>	 plots the raw and processed NMR signals in NUCLEUSinv</li><li><a href="../../../nucleus/functions/inversion/createKernelMatrix.html" class="code" title="function K = createKernelMatrix(t,T,Tbulk,Tdiff,Tflag,T1IRfac)">createKernelMatrix</a>	 creates a Kernel matrix from signal time vector "t"</li><li><a href="../../../nucleus/functions/inversion/estimateUncertainty.html" class="code" title="function [invstd,uncert] = estimateUncertainty(invtype,invstd,iparam,parameter)">estimateUncertainty</a>	 calculates pseudo uncertainty estimates for multi</li><li><a href="../../../nucleus/functions/inversion/getAAD.html" class="code" title="function aad = getAAD(x,flag,dim)">getAAD</a>	 gets the average absolute deviation from the values in x</li><li><a href="../../../nucleus/functions/inversion/getTLogMean.html" class="code" title="function [TLGM,index] = getTLogMean(T,f,varargin)">getTLogMean</a>	 calculates the T logmean value out of a relaxation time</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="../../../nucleus/NUCLEUSinv/NUCLEUSinv_createMenus.html" class="code" title="function gui = NUCLEUSinv_createMenus(data,gui)">NUCLEUSinv_createMenus</a>	 creates all GUI menus</li></ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function uv_onEditValue(src,~)</a></li><li><a href="#_sub2" class="code">function uv_onPushSend(src,~)</a></li><li><a href="#_sub3" class="code">function uv_onContextPlotsColor(src,~)</a></li><li><a href="#_sub4" class="code">function uv_onContextPlotsRTD(src,~)</a></li><li><a href="#_sub5" class="code">function data = uv_updateMASK(data)</a></li><li><a href="#_sub6" class="code">function uv_onPopupMethod(src,~)</a></li><li><a href="#_sub7" class="code">function uv_onPushRun(src,~)</a></li><li><a href="#_sub8" class="code">function uv_onPushUpdate(src,~)</a></li><li><a href="#_sub9" class="code">function uv_onPushReset(src,~)</a></li><li><a href="#_sub10" class="code">function uv_updateInformation(figh)</a></li><li><a href="#_sub11" class="code">function uv_updatePlots(figh)</a></li><li><a href="#_sub12" class="code">function uv_closeme(src,~)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function UncertView(src,~)</a>
0002 <span class="comment">%UncertView is an extra subGUI to show results of the uncertainty</span>
0003 <span class="comment">%calculation</span>
0004 <span class="comment">%</span>
0005 <span class="comment">% Syntax:</span>
0006 <span class="comment">%       UncertView</span>
0007 <span class="comment">%</span>
0008 <span class="comment">% Inputs:</span>
0009 <span class="comment">%       src - handle of the calling object</span>
0010 <span class="comment">%</span>
0011 <span class="comment">% Outputs:</span>
0012 <span class="comment">%       none</span>
0013 <span class="comment">%</span>
0014 <span class="comment">% Example:</span>
0015 <span class="comment">%       UncertView(src,~)</span>
0016 <span class="comment">%</span>
0017 <span class="comment">% Other m-files required:</span>
0018 <span class="comment">%       beautifyAxes</span>
0019 <span class="comment">%       clearAllAxes</span>
0020 <span class="comment">%       estimateUncertainty</span>
0021 <span class="comment">%       createKernelMatrix</span>
0022 <span class="comment">%       updatePlotsSignal</span>
0023 <span class="comment">%       updatePlotsDistribution</span>
0024 <span class="comment">%       updateInfo</span>
0025 <span class="comment">%</span>
0026 <span class="comment">% Subfunctions:</span>
0027 <span class="comment">%       uv_closeme</span>
0028 <span class="comment">%       uv_onEditValue</span>
0029 <span class="comment">%       uv_updateMASK</span>
0030 <span class="comment">%       uv_onPushRun</span>
0031 <span class="comment">%       uv_onPushUpdate</span>
0032 <span class="comment">%       uv_onPushReset</span>
0033 <span class="comment">%       uv_updateInformation</span>
0034 <span class="comment">%       uv_updatePlots</span>
0035 <span class="comment">%</span>
0036 <span class="comment">% MAT-files required:</span>
0037 <span class="comment">%       none</span>
0038 <span class="comment">%</span>
0039 <span class="comment">% See also: NUCLEUSinv</span>
0040 <span class="comment">% Author: see AUTHORS.md</span>
0041 <span class="comment">% email: see AUTHORS.md</span>
0042 <span class="comment">% License: MIT License (at end)</span>
0043 
0044 <span class="comment">%------------- BEGIN CODE --------------</span>
0045 
0046 <span class="comment">%% get GUI handle and data</span>
0047 figh_nucleus = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
0048 nucleus.data = getappdata(figh_nucleus,<span class="string">'data'</span>);
0049 nucleus.gui = getappdata(figh_nucleus,<span class="string">'gui'</span>);
0050 myui = nucleus.gui.myui;
0051 colors = myui.colors;
0052 
0053 <span class="comment">%% proceed only if there is already uncertainty data</span>
0054 <span class="keyword">if</span> isfield(nucleus.data.results.invstd,<span class="string">'uncert'</span>)
0055     nucleus_data = nucleus.data;
0056 
0057     <span class="comment">% check if the figure is already open</span>
0058     fig_uncert = findobj(<span class="string">'Tag'</span>,<span class="string">'UNCERTVIEW'</span>);
0059     <span class="comment">% if not, create it</span>
0060     <span class="keyword">if</span> isempty(fig_uncert)
0061         <span class="comment">% draw the figure on top of NUCLEUSinv</span>
0062         fig_uncert = figure(<span class="string">'Name'</span>,<span class="string">'NUCLEUSinv - RTD Uncertainty'</span>,<span class="keyword">...</span>
0063             <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>,<span class="string">'Resize'</span>,<span class="string">'on'</span>,<span class="string">'ToolBar'</span>,<span class="string">'none'</span>,<span class="keyword">...</span>
0064             <span class="string">'CloseRequestFcn'</span>,@<a href="#_sub12" class="code" title="subfunction uv_closeme(src,~)">uv_closeme</a>,<span class="keyword">...</span>
0065             <span class="string">'MenuBar'</span>,<span class="string">'figure'</span>,<span class="string">'Tag'</span>,<span class="string">'UNCERTVIEW'</span>);
0066         pos0 = get(figh_nucleus,<span class="string">'Position'</span>);
0067         cent(1) = (pos0(1)+pos0(3)/2);
0068         cent(2) = (pos0(2)+pos0(4)/2);
0069         posf = [cent(1)-pos0(3)/3 pos0(2)+22 pos0(3)/1.5 pos0(4)-22];
0070         <span class="comment">%         posf = [cent(1)-pos0(3)/6 pos0(2)+pos0(4)-140 350 145];</span>
0071         set(fig_uncert,<span class="string">'Position'</span>,posf);
0072 
0073         <span class="comment">% create the main layout</span>
0074         gui.main = uix.HBox(<span class="string">'Parent'</span>,fig_uncert,<span class="string">'BackGroundColor'</span>,colors.panelBG,<span class="keyword">...</span>
0075             <span class="string">'Spacing'</span>,5,<span class="string">'Padding'</span>,5,<span class="string">'Visible'</span>,<span class="string">'off'</span>);
0076         gui.left = uix.VBox(<span class="string">'Parent'</span>,gui.main,<span class="string">'BackGroundColor'</span>,colors.panelBG,<span class="keyword">...</span>
0077             <span class="string">'Spacing'</span>,5,<span class="string">'Padding'</span>,0); <span class="comment">% controls</span>
0078         gui.right = uix.VBox(<span class="string">'Parent'</span>,gui.main,<span class="string">'BackGroundColor'</span>,colors.panelBG,<span class="keyword">...</span>
0079             <span class="string">'Spacing'</span>,5,<span class="string">'Padding'</span>,0); <span class="comment">% plots</span>
0080 
0081         set(gui.main,<span class="string">'Widths'</span>,[300 -1 ]);
0082 
0083         <span class="comment">% waitbar indicating the loading of the GUI</span>
0084         steps = 5;
0085         hwb = waitbar(0,<span class="string">'loading ...'</span>,<span class="string">'Name'</span>,<span class="string">'UncertView initialization'</span>,<span class="string">'Visible'</span>,<span class="string">'off'</span>);
0086         set(hwb,<span class="string">'Units'</span>,<span class="string">'Pixel'</span>)
0087         posw = get(hwb,<span class="string">'Position'</span>);
0088         set(hwb,<span class="string">'Position'</span>,[posf(1)+posf(3)/2-posw(3)/2 posf(2)+posf(4)/2-posw(4)/2 posw(3:4)]);
0089         set(hwb,<span class="string">'Visible'</span>,<span class="string">'on'</span>);
0090 
0091         <span class="comment">% --- control panel ---</span>
0092         waitbar(1/steps,hwb,<span class="string">'loading GUI elements - control'</span>);
0093         gui.panels.control.main = uix.BoxPanel(<span class="string">'Parent'</span>,gui.left,<span class="keyword">...</span>
0094             <span class="string">'Title'</span>,<span class="string">'Recalculate RTD Uncertainty'</span>,<span class="string">'MinimizeFcn'</span>,@<a href="minimizePanel.html" class="code" title="function minimizePanel(src,~)">minimizePanel</a>,<span class="keyword">...</span>
0095             <span class="string">'TitleColor'</span>,colors.BoxINV,<span class="string">'ForegroundColor'</span>,colors.BoxTitle);
0096         gui.panels.control.VBox = uix.VBox(<span class="string">'Parent'</span>,gui.panels.control.main,<span class="keyword">...</span>
0097             <span class="string">'Spacing'</span>,3,<span class="string">'Padding'</span>,3);
0098         <span class="comment">% uncertainty method</span>
0099         gui.panels.control.HBox1 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.control.VBox,<span class="keyword">...</span>
0100             <span class="string">'Spacing'</span>,3);
0101         gui.text_handles.uncertMethod = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox1,<span class="keyword">...</span>
0102             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0103             <span class="string">'String'</span>,<span class="string">'Method'</span>);
0104         tstr = [<span class="string">'&lt;HTML&gt;Choose the uncertainty calculation method.&lt;br&gt;&lt;br&gt;'</span>,<span class="keyword">...</span>
0105             <span class="string">'&lt;u&gt;Available options:&lt;/u&gt;&lt;br&gt;'</span>,<span class="keyword">...</span>
0106             <span class="string">'&lt;font color=&quot;red&quot;&gt;Multi exp. (LSQ) | Multi exp. (LU decomp.):&lt;br&gt;'</span>,<span class="keyword">...</span>
0107             <span class="string">'&lt;font color=&quot;black&quot;&gt;'</span>,<span class="keyword">...</span>
0108             <span class="string">'&lt;b&gt;RMS - unbounded&lt;/b&gt; Keep all uncert models.&lt;br&gt;'</span>,<span class="keyword">...</span>
0109             <span class="string">'&lt;b&gt;RMS - bounded&lt;/b&gt; Only keep models within Lm and chi2 bounds.&lt;br&gt;'</span>,<span class="keyword">...</span>
0110             <span class="string">'&lt;font color=&quot;red&quot;&gt;Multi modal:&lt;br&gt;'</span>,<span class="keyword">...</span>
0111             <span class="string">'&lt;font color=&quot;black&quot;&gt;'</span>,<span class="keyword">...</span>
0112             <span class="string">'&lt;b&gt;RMS - unbounded&lt;/b&gt; Keep all uncert models.&lt;br&gt;'</span>,<span class="keyword">...</span>
0113             <span class="string">'&lt;b&gt;RMS - bounded&lt;/b&gt; Only keep models within Lm and chi2 bounds.&lt;br&gt;'</span>,<span class="keyword">...</span>
0114             <span class="string">'&lt;b&gt;Threshold&lt;/b&gt; Vary fit parameter by threshold.&lt;br&gt;'</span>,<span class="keyword">...</span>
0115             <span class="string">'&lt;b&gt;Conf. Interval&lt;/b&gt; Vary fit parameter randomly within confidence interval.&lt;br&gt;&lt;br&gt;'</span>,<span class="keyword">...</span>
0116             <span class="string">'&lt;u&gt;Default value:&lt;/u&gt;&lt;br&gt;'</span>,<span class="keyword">...</span>
0117             <span class="string">'&lt;b&gt;RMS - bounded&lt;/b&gt;&lt;br&gt;'</span>];
0118         gui.popup_handles.uncertMethod = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox1,<span class="keyword">...</span>
0119             <span class="string">'Style'</span>,<span class="string">'popup'</span>,<span class="string">'String'</span>,{<span class="string">'RMS - unbounded'</span>,<span class="string">'RMS - bounded'</span>},<span class="keyword">...</span>
0120             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0121             <span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'control'</span>,<span class="string">'Callback'</span>,@<a href="#_sub6" class="code" title="subfunction uv_onPopupMethod(src,~)">uv_onPopupMethod</a>);
0122         set(gui.panels.control.HBox1,<span class="string">'Widths'</span>,[150 -1]);
0123         <span class="comment">% number of uncertainty models</span>
0124         gui.panels.control.HBox2 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.control.VBox,<span class="keyword">...</span>
0125             <span class="string">'Spacing'</span>,3);        
0126         gui.text_handles.uncertN = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox2,<span class="keyword">...</span>
0127             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0128             <span class="string">'String'</span>,<span class="string">'#models'</span>);
0129         uix.Empty(<span class="string">'Parent'</span>,gui.panels.control.HBox2);
0130         tstr = <span class="string">'Number of uncertainty models to calculate.'</span>;
0131         gui.edit_handles.uncertN = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox2,<span class="keyword">...</span>
0132             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'uncertN'</span>,<span class="keyword">...</span>
0133             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0134             <span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0135         set(gui.panels.control.HBox2,<span class="string">'Widths'</span>,[150 -1 -1]);
0136         <span class="comment">% bound1: chi2 range</span>
0137         gui.panels.control.HBox3 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.control.VBox,<span class="keyword">...</span>
0138             <span class="string">'Spacing'</span>,3);
0139         gui.text_handles.uncertchi2 = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox3,<span class="keyword">...</span>
0140             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0141             <span class="string">'String'</span>,[char(hex2dec(<span class="string">'03A7'</span>)),char(hex2dec(<span class="string">'00B2'</span>)),<span class="keyword">...</span>
0142             <span class="string">' range          min | max'</span>]);
0143         tstr = <span class="string">'Lower bound of chi2 range.'</span>;
0144         gui.edit_handles.uncertchi2_min = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox3,<span class="keyword">...</span>
0145             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'control'</span>,<span class="keyword">...</span>
0146             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0147             <span class="string">'Enable'</span>,<span class="string">'off'</span>,<span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0148         tstr = <span class="string">'Upper bound of chi2 range.'</span>;
0149         gui.edit_handles.uncertchi2_max = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox3,<span class="keyword">...</span>
0150             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'control'</span>,<span class="keyword">...</span>
0151             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0152             <span class="string">'Enable'</span>,<span class="string">'off'</span>,<span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0153         set(gui.panels.control.HBox3,<span class="string">'Widths'</span>,[150 -1 -1]);
0154         <span class="comment">% bound2: model norm range</span>
0155         gui.panels.control.HBox4 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.control.VBox,<span class="keyword">...</span>
0156             <span class="string">'Spacing'</span>,3);
0157         gui.text_handles.uncertmnorm = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox4,<span class="keyword">...</span>
0158             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0159             <span class="string">'String'</span>,[<span class="string">'|Lm|'</span>,char(hex2dec(<span class="string">'2082'</span>)),<span class="string">' range      min | max'</span>]);
0160         tstr = <span class="string">'Lower bound of model norm range.'</span>;
0161         gui.edit_handles.uncertmnorm_min = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox4,<span class="keyword">...</span>
0162             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'control'</span>,<span class="keyword">...</span>
0163             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0164             <span class="string">'Enable'</span>,<span class="string">'off'</span>,<span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0165         tstr = <span class="string">'Upper bound of model norm range.'</span>;
0166         gui.edit_handles.uncertmnorm_max = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox4,<span class="keyword">...</span>
0167             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'control'</span>,<span class="keyword">...</span>
0168             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0169             <span class="string">'Enable'</span>,<span class="string">'off'</span>,<span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0170         set(gui.panels.control.HBox4,<span class="string">'Widths'</span>,[150 -1 -1]);
0171         <span class="comment">% bound3: threshold</span>
0172         gui.panels.control.HBox5 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.control.VBox,<span class="keyword">...</span>
0173             <span class="string">'Spacing'</span>,3);
0174         gui.text_handles.uncertThresh = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox5,<span class="keyword">...</span>
0175             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0176             <span class="string">'String'</span>,<span class="string">'Threshold'</span>);
0177         uix.Empty(<span class="string">'Parent'</span>,gui.panels.control.HBox5);
0178         tstr = <span class="string">'Threshold value (0.05 = 5%).'</span>;
0179         gui.edit_handles.uncertThresh = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox5,<span class="keyword">...</span>
0180             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'uncertThresh'</span>,<span class="keyword">...</span>
0181             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0182             <span class="string">'Enable'</span>,<span class="string">'off'</span>,<span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0183         set(gui.panels.control.HBox5,<span class="string">'Widths'</span>,[150 -1 -1]);
0184         <span class="comment">% max tries</span>
0185         gui.panels.control.HBox6 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.control.VBox,<span class="keyword">...</span>
0186             <span class="string">'Spacing'</span>,3);
0187         gui.text_handles.uncertMax = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox6,<span class="keyword">...</span>
0188             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0189             <span class="string">'String'</span>,<span class="string">'Max. #tries'</span>);
0190         uix.Empty(<span class="string">'Parent'</span>,gui.panels.control.HBox6);
0191         tstr = <span class="string">'Maximum number of unsuccesful tries.'</span>;
0192         gui.edit_handles.uncertMax = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox6,<span class="keyword">...</span>
0193             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'uncertMax'</span>,<span class="keyword">...</span>
0194             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0195             <span class="string">'Enable'</span>,<span class="string">'off'</span>,<span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0196         set(gui.panels.control.HBox6,<span class="string">'Widths'</span>,[150 -1 -1]);
0197         <span class="comment">% RUN button</span>
0198         gui.panels.control.HBox7 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.control.VBox,<span class="keyword">...</span>
0199             <span class="string">'Spacing'</span>,3);
0200         uix.Empty(<span class="string">'Parent'</span>,gui.panels.control.HBox7);
0201         uix.Empty(<span class="string">'Parent'</span>,gui.panels.control.HBox7);
0202         tstr = [<span class="string">'&lt;HTML&gt;RUN uncertainty calculation.&lt;br&gt;'</span>,<span class="keyword">...</span>
0203             <span class="string">'Regularization is the same as in main NUCLEUSinv GUI.'</span>];
0204         gui.push_handles.reset = uicontrol(<span class="string">'Parent'</span>,gui.panels.control.HBox7,<span class="keyword">...</span>
0205             <span class="string">'String'</span>,<span class="string">'RUN'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'process'</span>,<span class="keyword">...</span>
0206             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0207             <span class="string">'BackGroundColor'</span>,<span class="string">'g'</span>,<span class="string">'Callback'</span>,@<a href="#_sub7" class="code" title="subfunction uv_onPushRun(src,~)">uv_onPushRun</a>);
0208         set(gui.panels.control.HBox7,<span class="string">'Widths'</span>,[150 -1 -1]);
0209 
0210         <span class="comment">% --- process panel ---</span>
0211         waitbar(2/steps,hwb,<span class="string">'loading GUI elements - process'</span>);
0212         gui.panels.process.main = uix.BoxPanel(<span class="string">'Parent'</span>,gui.left,<span class="keyword">...</span>
0213             <span class="string">'Title'</span>,<span class="string">'Process Uncertainty Runs'</span>,<span class="string">'MinimizeFcn'</span>,@<a href="minimizePanel.html" class="code" title="function minimizePanel(src,~)">minimizePanel</a>,<span class="keyword">...</span>
0214             <span class="string">'TitleColor'</span>,colors.BoxINV,<span class="string">'ForegroundColor'</span>,colors.BoxTitle);
0215         gui.panels.process.VBox = uix.VBox(<span class="string">'Parent'</span>,gui.panels.process.main,<span class="keyword">...</span>
0216             <span class="string">'Spacing'</span>,3,<span class="string">'Padding'</span>,3);
0217         <span class="comment">% chi2 range</span>
0218         gui.panels.process.HBox1 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.process.VBox,<span class="keyword">...</span>
0219             <span class="string">'Spacing'</span>,3);
0220         gui.text_handles.chi2 = uicontrol(<span class="string">'Parent'</span>,gui.panels.process.HBox1,<span class="keyword">...</span>
0221             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0222             <span class="string">'String'</span>,[char(hex2dec(<span class="string">'03A7'</span>)),char(hex2dec(<span class="string">'00B2'</span>)),<span class="keyword">...</span>
0223             <span class="string">' range          min | max'</span>]);
0224         tstr = <span class="string">'Lower bound of chi2 range.'</span>;
0225         gui.edit_handles.chi2_min = uicontrol(<span class="string">'Parent'</span>,gui.panels.process.HBox1,<span class="keyword">...</span>
0226             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'process'</span>,<span class="keyword">...</span>
0227             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0228             <span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0229         tstr = <span class="string">'Upper bound of chi2 range.'</span>;
0230         gui.edit_handles.chi2_max = uicontrol(<span class="string">'Parent'</span>,gui.panels.process.HBox1,<span class="keyword">...</span>
0231             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'2'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'process'</span>,<span class="keyword">...</span>
0232             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0233             <span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0234         set(gui.panels.process.HBox1,<span class="string">'Widths'</span>,[150 -1 -1]);
0235         <span class="comment">% model norm range</span>
0236         gui.panels.process.HBox2 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.process.VBox,<span class="keyword">...</span>
0237             <span class="string">'Spacing'</span>,3);
0238         gui.text_handles.mnorm = uicontrol(<span class="string">'Parent'</span>,gui.panels.process.HBox2,<span class="keyword">...</span>
0239             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0240             <span class="string">'String'</span>,[<span class="string">'|Lm|'</span>,char(hex2dec(<span class="string">'2082'</span>)),<span class="string">' range      min | max'</span>]);
0241         tstr = <span class="string">'Lower bound of model norm range.'</span>;
0242         gui.edit_handles.mnorm_min = uicontrol(<span class="string">'Parent'</span>,gui.panels.process.HBox2,<span class="keyword">...</span>
0243             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'process'</span>,<span class="keyword">...</span>
0244             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0245             <span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0246         tstr = <span class="string">'Upper bound of model norm range.'</span>;
0247         gui.edit_handles.mnorm_max = uicontrol(<span class="string">'Parent'</span>,gui.panels.process.HBox2,<span class="keyword">...</span>
0248             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'2'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'process'</span>,<span class="keyword">...</span>
0249             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0250             <span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0251         set(gui.panels.process.HBox2,<span class="string">'Widths'</span>,[150 -1 -1]);
0252         <span class="comment">% RESET button</span>
0253         gui.panels.process.HBox3 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.process.VBox,<span class="keyword">...</span>
0254             <span class="string">'Spacing'</span>,3);
0255         uix.Empty(<span class="string">'Parent'</span>,gui.panels.process.HBox3);
0256         tstr = <span class="string">'SEND bounds to recaluclation panel above.'</span>;
0257         gui.push_handles.send = uicontrol(<span class="string">'Parent'</span>,gui.panels.process.HBox3,<span class="keyword">...</span>
0258             <span class="string">'String'</span>,<span class="string">'SEND'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'process'</span>,<span class="keyword">...</span>
0259             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0260             <span class="string">'Callback'</span>,@<a href="#_sub2" class="code" title="subfunction uv_onPushSend(src,~)">uv_onPushSend</a>);
0261         tstr = <span class="string">'RESET processing bounds and plots.'</span>;
0262         gui.push_handles.reset = uicontrol(<span class="string">'Parent'</span>,gui.panels.process.HBox3,<span class="keyword">...</span>
0263             <span class="string">'String'</span>,<span class="string">'RESET'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'process'</span>,<span class="keyword">...</span>
0264             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0265             <span class="string">'Callback'</span>,@<a href="#_sub9" class="code" title="subfunction uv_onPushReset(src,~)">uv_onPushReset</a>);
0266         set(gui.panels.process.HBox3,<span class="string">'Widths'</span>,[150 -1 -1]);
0267 
0268         <span class="comment">% --- RTD panel ---</span>
0269         waitbar(3/steps,hwb,<span class="string">'loading GUI elements - RTD bounds'</span>);
0270         gui.panels.rtd.main = uix.BoxPanel(<span class="string">'Parent'</span>,gui.left,<span class="keyword">...</span>
0271             <span class="string">'Title'</span>,<span class="string">'RTD Calculation Bounds'</span>,<span class="string">'MinimizeFcn'</span>,@<a href="minimizePanel.html" class="code" title="function minimizePanel(src,~)">minimizePanel</a>,<span class="keyword">...</span>
0272             <span class="string">'TitleColor'</span>,colors.BoxINV,<span class="string">'ForegroundColor'</span>,colors.BoxTitle);
0273         gui.panels.rtd.VBox = uix.VBox(<span class="string">'Parent'</span>,gui.panels.rtd.main,<span class="keyword">...</span>
0274             <span class="string">'Spacing'</span>,3,<span class="string">'Padding'</span>,3);
0275         <span class="comment">% RTD range</span>
0276         gui.panels.rtd.HBox1 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.rtd.VBox,<span class="keyword">...</span>
0277             <span class="string">'Spacing'</span>,3);
0278         gui.text_handles.rtd = uicontrol(<span class="string">'Parent'</span>,gui.panels.rtd.HBox1,<span class="keyword">...</span>
0279             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0280             <span class="string">'String'</span>,<span class="string">'RTD range       min | max'</span>);
0281         tstr = [<span class="string">'&lt;HTML&gt;Minimum relaxation time in RTDs used&lt;br&gt;'</span>,<span class="keyword">...</span>
0282             <span class="string">'for calculating statistics on E0 &amp; TLGM.'</span>];
0283         gui.edit_handles.rtd_min = uicontrol(<span class="string">'Parent'</span>,gui.panels.rtd.HBox1,<span class="keyword">...</span>
0284             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'rtd'</span>,<span class="keyword">...</span>
0285             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0286             <span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0287         tstr = [<span class="string">'&lt;HTML&gt;Maximum relaxation time in RTDs used&lt;br&gt;'</span>,<span class="keyword">...</span>
0288             <span class="string">'for calculating statistics on E0 &amp; TLGM.'</span>];
0289         gui.edit_handles.rtd_max = uicontrol(<span class="string">'Parent'</span>,gui.panels.rtd.HBox1,<span class="keyword">...</span>
0290             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'2'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'rtd'</span>,<span class="keyword">...</span>
0291             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0292             <span class="string">'Callback'</span>,@<a href="#_sub1" class="code" title="subfunction uv_onEditValue(src,~)">uv_onEditValue</a>);
0293         set(gui.panels.rtd.HBox1,<span class="string">'Widths'</span>,[150 -1 -1]);
0294         <span class="comment">% RESET button</span>
0295         gui.panels.rtd.HBox3 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.rtd.VBox,<span class="keyword">...</span>
0296             <span class="string">'Spacing'</span>,3);
0297         uix.Empty(<span class="string">'Parent'</span>,gui.panels.rtd.HBox3);
0298         uix.Empty(<span class="string">'Parent'</span>,gui.panels.rtd.HBox3);
0299         tstr = <span class="string">'RESET RTDs calculation bounds.'</span>;
0300         gui.push_handles.reset_rtd = uicontrol(<span class="string">'Parent'</span>,gui.panels.rtd.HBox3,<span class="keyword">...</span>
0301             <span class="string">'String'</span>,<span class="string">'RESET'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'rtd'</span>,<span class="keyword">...</span>
0302             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0303             <span class="string">'Callback'</span>,@<a href="#_sub9" class="code" title="subfunction uv_onPushReset(src,~)">uv_onPushReset</a>);
0304         set(gui.panels.rtd.HBox3,<span class="string">'Widths'</span>,[150 -1 -1]);
0305 
0306         <span class="comment">% --- Statistics panel ---</span>
0307         waitbar(4/steps,hwb,<span class="string">'loading GUI elements - statistics'</span>);
0308         gui.panels.info.main = uix.BoxPanel(<span class="string">'Parent'</span>,gui.left,<span class="keyword">...</span>
0309             <span class="string">'Title'</span>,<span class="string">'Uncertainty Statistics'</span>,<span class="string">'MinimizeFcn'</span>,@<a href="minimizePanel.html" class="code" title="function minimizePanel(src,~)">minimizePanel</a>,<span class="keyword">...</span>
0310             <span class="string">'TitleColor'</span>,colors.BoxINV,<span class="string">'ForegroundColor'</span>,colors.BoxTitle);
0311         gui.panels.info.VBox = uix.VBox(<span class="string">'Parent'</span>,gui.panels.info.main,<span class="keyword">...</span>
0312             <span class="string">'Spacing'</span>,3,<span class="string">'Padding'</span>,3);
0313         <span class="comment">% mean TLGM</span>
0314         gui.panels.info.HBox1 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.info.VBox,<span class="keyword">...</span>
0315             <span class="string">'Spacing'</span>,3);
0316         gui.text_handles.TLGM = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox1,<span class="keyword">...</span>
0317             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0318             <span class="string">'String'</span>,<span class="string">'TLGM            mean | std'</span>);
0319         tstr = <span class="string">'MEAN of all TLGM values.'</span>;
0320         gui.edit_handles.TLGM_mean = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox1,<span class="keyword">...</span>
0321             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="keyword">...</span>
0322             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0323             <span class="string">'BackgroundColor'</span>,colors.BoxPRC);
0324         tstr = <span class="string">'STD of all TLGM values.'</span>;
0325         gui.edit_handles.TLGM_std = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox1,<span class="keyword">...</span>
0326             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'2'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="keyword">...</span>
0327             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0328             <span class="string">'BackgroundColor'</span>,colors.BoxPRC);
0329         set(gui.panels.info.HBox1,<span class="string">'Widths'</span>,[150 -1 -1]);
0330         <span class="comment">% aad TLGM</span>
0331         gui.panels.info.HBox2 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.info.VBox,<span class="keyword">...</span>
0332             <span class="string">'Spacing'</span>,3);
0333         gui.text_handles.TLGM_aad = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox2,<span class="keyword">...</span>
0334             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0335             <span class="string">'String'</span>,<span class="string">'TLGM            aad(mean)'</span>);
0336         uix.Empty(<span class="string">'Parent'</span>,gui.panels.info.HBox2);
0337         tstr = <span class="string">'AAD (average absolute deviation from mean) of all TLGM values.'</span>;
0338         gui.edit_handles.TLGM_aad = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox2,<span class="keyword">...</span>
0339             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0340             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'2'</span>,<span class="string">'FontSize'</span>,myui.fontsize);
0341         set(gui.panels.info.HBox2,<span class="string">'Widths'</span>,[150 -1 -1]);
0342         <span class="comment">% median TLGM</span>
0343         gui.panels.info.HBox3 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.info.VBox,<span class="keyword">...</span>
0344             <span class="string">'Spacing'</span>,3);
0345         gui.text_handles.TLGM_med = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox3,<span class="keyword">...</span>
0346             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0347             <span class="string">'String'</span>,<span class="string">'TLGM median | aad(med)'</span>);
0348         tstr = <span class="string">'MEDIAN of all TLGM values.'</span>;
0349         gui.edit_handles.TLGM_med = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox3,<span class="keyword">...</span>
0350             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="keyword">...</span>
0351             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0352             <span class="string">'BackgroundColor'</span>,colors.BoxCPS);
0353         tstr = <span class="string">'AAD (average absolute deviation from median) of all TLGM values.'</span>;
0354         gui.edit_handles.TLGM_aadmed = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox3,<span class="keyword">...</span>
0355             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'2'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="keyword">...</span>
0356             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0357             <span class="string">'BackgroundColor'</span>,colors.BoxCPS);
0358         set(gui.panels.info.HBox3,<span class="string">'Widths'</span>,[150 -1 -1]);
0359         <span class="comment">% mean E0</span>
0360         gui.panels.info.HBox4 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.info.VBox,<span class="keyword">...</span>
0361             <span class="string">'Spacing'</span>,3);
0362         gui.text_handles.E0 = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox4,<span class="keyword">...</span>
0363             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0364             <span class="string">'String'</span>,<span class="string">'E0                mean | std'</span>);
0365         tstr = <span class="string">'MEAN of all E0 values.'</span>;
0366         gui.edit_handles.E0_mean = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox4,<span class="keyword">...</span>
0367             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="keyword">...</span>
0368             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0369             <span class="string">'BackgroundColor'</span>,colors.BoxPRC);
0370         tstr = <span class="string">'STD of all E0 values.'</span>;
0371         gui.edit_handles.E0_std = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox4,<span class="keyword">...</span>
0372             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'2'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="keyword">...</span>
0373             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0374             <span class="string">'BackgroundColor'</span>,colors.BoxPRC);
0375         set(gui.panels.info.HBox4,<span class="string">'Widths'</span>,[150 -1 -1]);
0376         <span class="comment">% aad E0</span>
0377         gui.panels.info.HBox5 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.info.VBox,<span class="keyword">...</span>
0378             <span class="string">'Spacing'</span>,3);
0379         gui.text_handles.E0_aad = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox5,<span class="keyword">...</span>
0380             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0381             <span class="string">'String'</span>,<span class="string">'E0                aad(mean)'</span>);
0382         uix.Empty(<span class="string">'Parent'</span>,gui.panels.info.HBox5);
0383         tstr = <span class="string">'AAD (average absolute deviation from mean) of all E0 values.'</span>;
0384         gui.edit_handles.E0_aad = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox5,<span class="keyword">...</span>
0385             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0386             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'2'</span>,<span class="string">'FontSize'</span>,myui.fontsize);
0387         set(gui.panels.info.HBox5,<span class="string">'Widths'</span>,[150 -1 -1]);
0388         <span class="comment">% median E0</span>
0389         gui.panels.info.HBox6 = uix.HBox(<span class="string">'Parent'</span>,gui.panels.info.VBox,<span class="keyword">...</span>
0390             <span class="string">'Spacing'</span>,3);
0391         gui.text_handles.E0_med = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox6,<span class="keyword">...</span>
0392             <span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
0393             <span class="string">'String'</span>,<span class="string">'E0     median | aad(med)'</span>);
0394         tstr = <span class="string">'MEDIAN of all E0 values.'</span>;
0395         gui.edit_handles.E0_med = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox6,<span class="keyword">...</span>
0396             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'0'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="keyword">...</span>
0397             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0398             <span class="string">'BackgroundColor'</span>,colors.BoxCPS);
0399         tstr = <span class="string">'AAD (average absolute deviation from median) of all E0 values.'</span>;
0400         gui.edit_handles.E0_aadmed = uicontrol(<span class="string">'Parent'</span>,gui.panels.info.HBox6,<span class="keyword">...</span>
0401             <span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'2'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="keyword">...</span>
0402             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0403             <span class="string">'BackgroundColor'</span>,colors.BoxCPS);
0404         set(gui.panels.info.HBox6,<span class="string">'Widths'</span>,[150 -1 -1]);
0405 
0406         <span class="comment">% --- update MAIN GUI button ---</span>
0407         tstr = <span class="string">'UPDATE uncertainty data in main NUCLEUSinv GUI.'</span>;
0408         gui.push_handles.update = uicontrol(<span class="string">'Parent'</span>,gui.left,<span class="keyword">...</span>
0409             <span class="string">'String'</span>,<span class="string">'UPDATE MAIN GUI'</span>,<span class="string">'FontSize'</span>,myui.fontsize,<span class="string">'Tag'</span>,<span class="string">'update'</span>,<span class="keyword">...</span>
0410             <span class="string">'ToolTipString'</span>,tstr,<span class="string">'UserData'</span>,struct(<span class="string">'Tooltipstr'</span>,tstr),<span class="keyword">...</span>
0411             <span class="string">'Callback'</span>,@<a href="#_sub8" class="code" title="subfunction uv_onPushUpdate(src,~)">uv_onPushUpdate</a>);
0412 
0413         <span class="comment">% fix text vertical alignment</span>
0414         jh = findjobj(gui.text_handles.uncertMethod);
0415         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0416         jh = findjobj(gui.text_handles.uncertN);
0417         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0418         jh = findjobj(gui.text_handles.uncertchi2);
0419         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0420         jh = findjobj(gui.text_handles.uncertmnorm);
0421         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0422         jh = findjobj(gui.text_handles.uncertThresh);
0423         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0424         jh = findjobj(gui.text_handles.uncertMax);
0425         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0426         jh = findjobj(gui.text_handles.chi2);
0427         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0428         jh = findjobj(gui.text_handles.mnorm);
0429         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0430         jh = findjobj(gui.text_handles.rtd);
0431         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0432         jh = findjobj(gui.text_handles.TLGM);
0433         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0434         jh = findjobj(gui.text_handles.TLGM_aad);
0435         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0436         jh = findjobj(gui.text_handles.TLGM_med);
0437         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0438         jh = findjobj(gui.text_handles.E0);
0439         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0440         jh = findjobj(gui.text_handles.E0_aad);
0441         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0442         jh = findjobj(gui.text_handles.E0_med);
0443         jh.setVerticalAlignment(javax.swing.JLabel.CENTER);
0444 
0445         <span class="comment">% empty space at bottom of left side</span>
0446         uix.Empty(<span class="string">'Parent'</span>,gui.left);
0447         <span class="comment">% adjust the heights of all left-column-panels</span>
0448         heights = [22 22 22 22 28 -1; 22+7*24+9*3 22+3*24+5*3 22+2*24+4*4 22+6*24+8*3 28 -1];
0449         <span class="comment">% panel header is always 22 high</span>
0450         set(gui.left,<span class="string">'Heights'</span>,heights(2,:),<span class="keyword">...</span>
0451             <span class="string">'MinimumHeights'</span>,[22 22 22 22 28 0]);        
0452 
0453         <span class="comment">% --- plot boxes ---</span>
0454         waitbar(5/steps,hwb,<span class="string">'loading GUI elements - graphics'</span>);
0455         gui.rightPanel = uix.TabPanel(<span class="string">'Parent'</span>,gui.right,<span class="keyword">...</span>
0456             <span class="string">'BackGroundColor'</span>,colors.panelBG);
0457         <span class="comment">% -- tab1</span>
0458         gui.righttop1 = uix.HBox(<span class="string">'Parent'</span>,gui.rightPanel,<span class="keyword">...</span>
0459             <span class="string">'BackGroundColor'</span>,colors.panelBG,<span class="string">'Spacing'</span>,5);
0460         gui.pbox11 = uicontainer(<span class="string">'Parent'</span>,gui.righttop1,<span class="keyword">...</span>
0461             <span class="string">'BackGroundColor'</span>,colors.panelBG);
0462         gui.pbox12 = uicontainer(<span class="string">'Parent'</span>,gui.righttop1,<span class="keyword">...</span>
0463             <span class="string">'BackGroundColor'</span>,colors.panelBG);
0464         set(gui.righttop1,<span class="string">'Widths'</span>,[-1 -1 ]);
0465         gui.rightbot = uix.HBox(<span class="string">'Parent'</span>,gui.right,<span class="keyword">...</span>
0466             <span class="string">'BackGroundColor'</span>,colors.panelBG,<span class="string">'Spacing'</span>,5);
0467         gui.pbox2 = uicontainer(<span class="string">'Parent'</span>,gui.rightbot,<span class="keyword">...</span>
0468             <span class="string">'BackGroundColor'</span>,colors.panelBG);
0469 
0470         <span class="comment">% -- tab2</span>
0471         gui.righttop2 = uix.HBox(<span class="string">'Parent'</span>,gui.rightPanel,<span class="keyword">...</span>
0472             <span class="string">'BackGroundColor'</span>,colors.panelBG,<span class="string">'Spacing'</span>,5);
0473         gui.pbox21 = uicontainer(<span class="string">'Parent'</span>,gui.righttop2,<span class="keyword">...</span>
0474             <span class="string">'BackGroundColor'</span>,colors.panelBG);
0475         gui.pbox22 = uicontainer(<span class="string">'Parent'</span>,gui.righttop2,<span class="keyword">...</span>
0476             <span class="string">'BackGroundColor'</span>,colors.panelBG);
0477         set(gui.righttop2,<span class="string">'Widths'</span>,[-1 -1 ]);
0478 
0479         gui.rightPanel.TabTitles = {<span class="string">'Statistics'</span>,<span class="string">'Histograms'</span>};
0480         gui.rightPanel.TabWidth = 75;
0481         gui.rightPanel.TabEnables = {<span class="string">'on'</span>,<span class="string">'on'</span>};
0482 
0483         <span class="comment">% -- plot axes --</span>
0484         gui.axes11 = axes(<span class="string">'Parent'</span>,gui.pbox12,<span class="string">'Box'</span>,<span class="string">'on'</span>);
0485         gui.axes12 = axes(<span class="string">'Parent'</span>,gui.pbox11,<span class="string">'Box'</span>,<span class="string">'on'</span>);
0486         gui.axes2 = axes(<span class="string">'Parent'</span>,gui.pbox2,<span class="string">'Box'</span>,<span class="string">'on'</span>);
0487         gui.axes21 = axes(<span class="string">'Parent'</span>,gui.pbox21,<span class="string">'Box'</span>,<span class="string">'on'</span>);
0488         gui.axes22 = axes(<span class="string">'Parent'</span>,gui.pbox22,<span class="string">'Box'</span>,<span class="string">'on'</span>);
0489 
0490         <span class="comment">% the chi2 vs. xn plot has a context menu</span>
0491         gui.cm_handles.axes_chi2 = uicontextmenu(fig_uncert);
0492         gui.cm_handles.axes_color = uimenu(gui.cm_handles.axes_chi2,<span class="keyword">...</span>
0493             <span class="string">'Label'</span>,<span class="string">'color by'</span>);
0494         gui.cm_handles.axes_color_none = uimenu(gui.cm_handles.axes_color,<span class="keyword">...</span>
0495             <span class="string">'Label'</span>,<span class="string">'none'</span>,<span class="string">'Tag'</span>,<span class="string">'none'</span>,<span class="string">'Checked'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0496             <span class="string">'Callback'</span>,@<a href="#_sub3" class="code" title="subfunction uv_onContextPlotsColor(src,~)">uv_onContextPlotsColor</a>);
0497         gui.cm_handles.axes_color_chi2 = uimenu(gui.cm_handles.axes_color,<span class="keyword">...</span>
0498             <span class="string">'Label'</span>,<span class="string">'chi2'</span>,<span class="string">'Tag'</span>,<span class="string">'chi2'</span>,<span class="string">'Callback'</span>,@<a href="#_sub3" class="code" title="subfunction uv_onContextPlotsColor(src,~)">uv_onContextPlotsColor</a>);
0499         gui.cm_handles.axes_color_mnorm = uimenu(gui.cm_handles.axes_color,<span class="keyword">...</span>
0500             <span class="string">'Label'</span>,<span class="string">'xn'</span>,<span class="string">'Tag'</span>,<span class="string">'xn'</span>,<span class="string">'Callback'</span>,@<a href="#_sub3" class="code" title="subfunction uv_onContextPlotsColor(src,~)">uv_onContextPlotsColor</a>);
0501         set(gui.axes12,<span class="string">'UIContextMenu'</span>,gui.cm_handles.axes_chi2);
0502 
0503         <span class="comment">% the RTD plot has a context menu</span>
0504         gui.cm_handles.axes_rtd = uicontextmenu(fig_uncert);
0505         gui.cm_handles.axes_rtd_lines = uimenu(gui.cm_handles.axes_rtd,<span class="keyword">...</span>
0506             <span class="string">'Label'</span>,<span class="string">'lines'</span>,<span class="string">'Tag'</span>,<span class="string">'lines'</span>,<span class="string">'Checked'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0507             <span class="string">'Callback'</span>,@<a href="#_sub4" class="code" title="subfunction uv_onContextPlotsRTD(src,~)">uv_onContextPlotsRTD</a>);
0508         gui.cm_handles.axes_rtd_patch = uimenu(gui.cm_handles.axes_rtd,<span class="keyword">...</span>
0509             <span class="string">'Label'</span>,<span class="string">'patch'</span>);
0510         gui.cm_handles.axes_rtd_patch_mean = uimenu(gui.cm_handles.axes_rtd_patch,<span class="keyword">...</span>
0511             <span class="string">'Label'</span>,<span class="string">'mean / std'</span>,<span class="string">'Tag'</span>,<span class="string">'patchmean'</span>,<span class="keyword">...</span>
0512             <span class="string">'Callback'</span>,@<a href="#_sub4" class="code" title="subfunction uv_onContextPlotsRTD(src,~)">uv_onContextPlotsRTD</a>);
0513         gui.cm_handles.axes_rtd_patch_median = uimenu(gui.cm_handles.axes_rtd_patch,<span class="keyword">...</span>
0514             <span class="string">'Label'</span>,<span class="string">'median / aad'</span>,<span class="string">'Tag'</span>,<span class="string">'patchmedian'</span>,<span class="keyword">...</span>
0515             <span class="string">'Callback'</span>,@<a href="#_sub4" class="code" title="subfunction uv_onContextPlotsRTD(src,~)">uv_onContextPlotsRTD</a>);
0516         set(gui.axes2,<span class="string">'UIContextMenu'</span>,gui.cm_handles.axes_rtd);
0517 
0518         <span class="comment">% --- store main GUI settings ---</span>
0519         gui.myui = nucleus.gui.myui;
0520         gui.myui.heights = heights;
0521         gui.figh_nucleus = figh_nucleus;
0522 
0523         <span class="comment">% --- save gui data to GUI ---</span>
0524         setappdata(fig_uncert,<span class="string">'gui'</span>,gui);
0525 
0526         <span class="comment">% make GUI visible</span>
0527         delete(hwb);
0528         set(gui.main,<span class="string">'Visible'</span>,<span class="string">'on'</span>);
0529 
0530         <span class="comment">% initialize color style</span>
0531         uv.colorstyle = <span class="string">'none'</span>;
0532         <span class="comment">% initialize RTD plot style</span>
0533         uv.rtd_plotstyle = <span class="string">'lines'</span>;
0534     <span class="keyword">else</span>
0535         data = getappdata(fig_uncert,<span class="string">'data'</span>);
0536         uv = data.uv;
0537     <span class="keyword">end</span>
0538     <span class="comment">% if the figure is already open load the GUI data</span>
0539     gui = getappdata(fig_uncert,<span class="string">'gui'</span>);
0540     <span class="comment">% update new NUCLEUSinv data</span>
0541     setappdata(fig_uncert,<span class="string">'data'</span>,nucleus_data);
0542     data = getappdata(fig_uncert,<span class="string">'data'</span>);
0543     <span class="comment">% clear axes</span>
0544     <a href="clearAllAxes.html" class="code" title="function clearAllAxes(figh)">clearAllAxes</a>(fig_uncert);
0545 
0546     <span class="comment">% round all chi2 and xn values to 6 digits</span>
0547     chi2_all = data.results.invstd.uncert.chi2_all;
0548     chi2_all = round(1e6.*chi2_all)./1e6;
0549     data.results.invstd.uncert.chi2_all = chi2_all;
0550     mnorm_all = data.results.invstd.uncert.mnorm_all;
0551     mnorm_all = round(1e6.*mnorm_all)./1e6;
0552     data.results.invstd.uncert.mnorm_all = mnorm_all;
0553 
0554     <span class="comment">% create logical mask</span>
0555     uv.touse = ones(nucleus_data.uncert.N,1);
0556     <span class="comment">% --- fill the edit fields ---</span>
0557     invstd = data.results.invstd;
0558     uncert = invstd.uncert;
0559     <span class="comment">% 1.) control</span>
0560     uv.uncertMethod = uncert.params.uncert.Method;
0561     uv.uncertN = uncert.params.uncert.N;
0562     set(gui.edit_handles.uncertN,<span class="string">'String'</span>,num2str(uv.uncertN));
0563     uv.uncertThresh = uncert.params.uncert.Thresh;
0564     set(gui.edit_handles.uncertThresh,<span class="string">'String'</span>,num2str(uv.uncertThresh));
0565     uv.uncertMax = uncert.params.uncert.Max;
0566     set(gui.edit_handles.uncertMax,<span class="string">'String'</span>,num2str(uv.uncertMax));
0567     uv.chi2_range_calc  = [min(uncert.chi2_all) max(uncert.chi2_all)];
0568     uv.mnorm_range_calc = [min(uncert.mnorm_all) max(uncert.mnorm_all)];
0569     <span class="comment">% set popup menu</span>
0570     <span class="keyword">switch</span> invstd.invtype
0571         <span class="keyword">case</span> {<span class="string">'LU'</span>,<span class="string">'NNLS'</span>}
0572             set(gui.popup_handles.uncertMethod,<span class="keyword">...</span>
0573                 <span class="string">'String'</span>,{<span class="string">'RMS - unbounded'</span>,<span class="string">'RMS - bounded'</span>})
0574             <span class="keyword">switch</span> uncert.params.uncert.Method
0575                 <span class="keyword">case</span> <span class="string">'RMS_free'</span>
0576                     set(gui.popup_handles.uncertMethod,<span class="string">'Value'</span>,1);
0577                 <span class="keyword">case</span> <span class="string">'RMS_bound'</span>
0578                     set(gui.popup_handles.uncertMethod,<span class="string">'Value'</span>,2);
0579             <span class="keyword">end</span>
0580         <span class="keyword">case</span> <span class="string">'MUMO'</span>
0581             set(gui.popup_handles.uncertMethod,<span class="keyword">...</span>
0582                 <span class="string">'String'</span>,{<span class="string">'RMS - unbounded'</span>,<span class="string">'RMS - bounded'</span>,<span class="string">'Threshold'</span>,<span class="string">'Conf. Interval'</span>})
0583             <span class="keyword">switch</span> uncert.params.uncert.Method
0584                 <span class="keyword">case</span> <span class="string">'RMS_free'</span>
0585                     set(gui.popup_handles.uncertMethod,<span class="string">'Value'</span>,1);
0586                 <span class="keyword">case</span> <span class="string">'RMS_bound'</span>
0587                     set(gui.popup_handles.uncertMethod,<span class="string">'Value'</span>,2);
0588                 <span class="keyword">case</span> <span class="string">'thresh'</span>
0589                     set(gui.popup_handles.uncertMethod,<span class="string">'Value'</span>,3);
0590                 <span class="keyword">case</span> <span class="string">'ci'</span>
0591                     set(gui.popup_handles.uncertMethod,<span class="string">'Value'</span>,4);
0592             <span class="keyword">end</span>
0593     <span class="keyword">end</span>
0594     set(gui.edit_handles.uncertN,<span class="string">'String'</span>,num2str(uncert.params.uncert.N));
0595     <span class="comment">% 2.) process</span>
0596     chi2_range  = uv.chi2_range_calc;
0597     mnorm_range = uv.mnorm_range_calc;
0598     set(gui.edit_handles.chi2_min,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,chi2_range(1,1)));
0599     set(gui.edit_handles.chi2_max,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,chi2_range(1,2)));
0600     set(gui.edit_handles.mnorm_min,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,mnorm_range(1,1)));
0601     set(gui.edit_handles.mnorm_max,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,mnorm_range(1,2)));
0602     <span class="comment">% 3.) RTD range</span>
0603     rtd_range = data.invstd.time;
0604     set(gui.edit_handles.rtd_min,<span class="string">'String'</span>,num2str(rtd_range(1,1)));
0605     set(gui.edit_handles.rtd_max,<span class="string">'String'</span>,num2str(rtd_range(1,2)));
0606     uv.chi2_range = chi2_range;
0607     uv.mnorm_range = mnorm_range;
0608     uv.rtd_range = rtd_range;
0609 
0610     <span class="comment">% update data</span>
0611     data.uv = uv;
0612     setappdata(fig_uncert,<span class="string">'data'</span>,data);
0613     <a href="#_sub6" class="code" title="subfunction uv_onPopupMethod(src,~)">uv_onPopupMethod</a>(gui.popup_handles.uncertMethod);
0614 
0615     <span class="comment">% plot all uncertainty data</span>
0616     <a href="#_sub10" class="code" title="subfunction uv_updateInformation(figh)">uv_updateInformation</a>(fig_uncert);
0617     <a href="beautifyAxes.html" class="code" title="function beautifyAxes(figh)">beautifyAxes</a>(fig_uncert);
0618 <span class="keyword">else</span>
0619     helpdlg({<span class="string">'function: UNCERTVIEW'</span>,<span class="keyword">...</span>
0620         <span class="string">'Cannot continue because there is no data!'</span>},<span class="keyword">...</span>
0621         <span class="string">'No uncertainty data.'</span>);
0622 <span class="keyword">end</span>
0623 
0624 <span class="keyword">end</span>
0625 
0626 <span class="comment">%% subfunction to update the edit fields</span>
0627 <a name="_sub1" href="#_subfunctions" class="code">function uv_onEditValue(src,~)</a>
0628 figh = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
0629 gui = getappdata(figh,<span class="string">'gui'</span>);
0630 data = getappdata(figh,<span class="string">'data'</span>);
0631 uv = data.uv;
0632 
0633 <span class="comment">% get the edit field value</span>
0634 val = str2double(get(src,<span class="string">'String'</span>));
0635 
0636 <span class="keyword">switch</span> get(src,<span class="string">'Tag'</span>)
0637     <span class="keyword">case</span> <span class="string">'uncertN'</span>
0638         <span class="keyword">if</span> val &lt; 10
0639             uncertN = 10;
0640         <span class="keyword">else</span>
0641             uncertN = round(val);
0642         <span class="keyword">end</span>
0643         set(src,<span class="string">'String'</span>,num2str(uncertN));
0644         uv.uncertN = uncertN;
0645         data.uv = uv;
0646     <span class="keyword">case</span> <span class="string">'uncertThresh'</span>
0647     <span class="keyword">case</span> <span class="string">'uncertMax'</span>
0648     <span class="keyword">case</span> <span class="string">'control'</span>
0649         <span class="comment">% set the value with the desired layout</span>
0650         set(src,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,val));
0651         chi2_range_calc(1,1) = str2double(get(gui.edit_handles.uncertchi2_min,<span class="string">'String'</span>));
0652         chi2_range_calc(1,2) = str2double(get(gui.edit_handles.uncertchi2_max,<span class="string">'String'</span>));
0653         mnorm_range_calc(1,1) = str2double(get(gui.edit_handles.uncertmnorm_min,<span class="string">'String'</span>));
0654         mnorm_range_calc(1,2) = str2double(get(gui.edit_handles.uncertmnorm_max,<span class="string">'String'</span>));
0655         <span class="comment">% update data</span>
0656         uv.chi2_range_calc = chi2_range_calc;
0657         uv.mnorm_range_calc = mnorm_range_calc;
0658         data.uv = uv;
0659     <span class="keyword">case</span> <span class="string">'process'</span>
0660         <span class="comment">% set the value with the desired layout</span>
0661         set(src,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,val));
0662         <span class="comment">% get all range values</span>
0663         chi2_range(1,1) = str2double(get(gui.edit_handles.chi2_min,<span class="string">'String'</span>));
0664         chi2_range(1,2) = str2double(get(gui.edit_handles.chi2_max,<span class="string">'String'</span>));
0665         mnorm_range(1,1) = str2double(get(gui.edit_handles.mnorm_min,<span class="string">'String'</span>));
0666         mnorm_range(1,2) = str2double(get(gui.edit_handles.mnorm_max,<span class="string">'String'</span>));
0667         <span class="comment">% fix wrong user input</span>
0668         <span class="keyword">if</span> chi2_range(2) &lt;= chi2_range(1)
0669             warndlg({<span class="string">'function: UNCERTVIEW'</span>,<span class="keyword">...</span>
0670             <span class="string">'Lower bound is larger than upper bound!'</span>},<span class="keyword">...</span>
0671             <span class="string">'Resetting.'</span>);
0672             chi2_range(1) = min(data.results.invstd.uncert.chi2_all);
0673             chi2_range(2) = max(data.results.invstd.uncert.chi2_all);            
0674             set(gui.edit_handles.chi2_min,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,chi2_range(1)));
0675             set(gui.edit_handles.chi2_max,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,chi2_range(2)));
0676         <span class="keyword">end</span>
0677         <span class="keyword">if</span> mnorm_range(2) &lt;= mnorm_range(1)            
0678             warndlg({<span class="string">'function: UNCERTVIEW'</span>,<span class="keyword">...</span>
0679             <span class="string">'Lower bound is larger than upper bound!'</span>},<span class="keyword">...</span>
0680             <span class="string">'Resetting.'</span>);
0681             mnorm_range(1) = min(data.results.invstd.uncert.mnorm_all);
0682             mnorm_range(2) = max(data.results.invstd.uncert.mnorm_all);
0683             set(gui.edit_handles.mnorm_min,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,mnorm_range(1)));
0684             set(gui.edit_handles.mnorm_max,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,mnorm_range(2)));
0685         <span class="keyword">end</span>
0686         <span class="comment">% update data</span>
0687         uv.chi2_range = chi2_range;
0688         uv.mnorm_range = mnorm_range;
0689         data.uv = uv;
0690         <span class="comment">% update logical mask for plotting</span>
0691         data = <a href="#_sub5" class="code" title="subfunction data = uv_updateMASK(data)">uv_updateMASK</a>(data);
0692     <span class="keyword">case</span> <span class="string">'rtd'</span>
0693         <span class="comment">% set the value with the desired layout</span>
0694         set(src,<span class="string">'String'</span>,num2str(val));
0695         <span class="comment">% get all range values</span>
0696         rtd_range(1,1) = str2double(get(gui.edit_handles.rtd_min,<span class="string">'String'</span>));
0697         rtd_range(1,2) = str2double(get(gui.edit_handles.rtd_max,<span class="string">'String'</span>));
0698         <span class="comment">% update data</span>
0699         uv.rtd_range = rtd_range;
0700         data.uv = uv;
0701 <span class="keyword">end</span>
0702 
0703 <span class="comment">% update GUI data</span>
0704 setappdata(figh,<span class="string">'data'</span>,data);
0705 <span class="comment">% update information</span>
0706 <a href="#_sub10" class="code" title="subfunction uv_updateInformation(figh)">uv_updateInformation</a>(figh);
0707 <span class="keyword">end</span>
0708 
0709 <span class="comment">%% subfunction to copy the chi2 and xn range to the control panel</span>
0710 <a name="_sub2" href="#_subfunctions" class="code">function uv_onPushSend(src,~)</a>
0711 figh = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
0712 gui = getappdata(figh,<span class="string">'gui'</span>);
0713 data = getappdata(figh,<span class="string">'data'</span>);
0714 uv = data.uv;
0715 
0716 <span class="comment">% get all data</span>
0717 chi2_range(1,1) = str2double(get(gui.edit_handles.chi2_min,<span class="string">'String'</span>));
0718 chi2_range(1,2) = str2double(get(gui.edit_handles.chi2_max,<span class="string">'String'</span>));
0719 mnorm_range(1,1) = str2double(get(gui.edit_handles.mnorm_min,<span class="string">'String'</span>));
0720 mnorm_range(1,2) = str2double(get(gui.edit_handles.mnorm_max,<span class="string">'String'</span>));
0721 
0722 <span class="comment">% copy data to calc</span>
0723 uv.chi2_range_calc = chi2_range;
0724 uv.mnorm_range_calc = mnorm_range;
0725 data.uv = uv;
0726 
0727 <span class="comment">% write values to edit field</span>
0728 set(gui.edit_handles.uncertchi2_min,<span class="keyword">...</span>
0729     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range_calc(1)));
0730 set(gui.edit_handles.uncertchi2_max,<span class="keyword">...</span>
0731     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range_calc(2)));
0732 set(gui.edit_handles.uncertmnorm_min,<span class="keyword">...</span>
0733     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range_calc(1)));
0734 set(gui.edit_handles.uncertmnorm_max,<span class="keyword">...</span>
0735     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range_calc(2)));
0736 
0737 <span class="comment">% update GUI data</span>
0738 setappdata(figh,<span class="string">'data'</span>,data);
0739 <span class="keyword">end</span>
0740 
0741 <span class="comment">%% subfunction to control the line color</span>
0742 <a name="_sub3" href="#_subfunctions" class="code">function uv_onContextPlotsColor(src,~)</a>
0743 figh = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
0744 gui = getappdata(figh,<span class="string">'gui'</span>);
0745 data = getappdata(figh,<span class="string">'data'</span>);
0746 uv = data.uv;
0747 
0748 <span class="comment">% switch through different plot options</span>
0749 <span class="keyword">switch</span> get(src,<span class="string">'Tag'</span>)
0750     <span class="keyword">case</span> <span class="string">'none'</span>
0751         set(gui.cm_handles.axes_color_none,<span class="string">'Checked'</span>,<span class="string">'on'</span>);
0752         set(gui.cm_handles.axes_color_chi2,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0753         set(gui.cm_handles.axes_color_mnorm,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0754     <span class="keyword">case</span> <span class="string">'chi2'</span>
0755         set(gui.cm_handles.axes_color_none,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0756         set(gui.cm_handles.axes_color_chi2,<span class="string">'Checked'</span>,<span class="string">'on'</span>);
0757         set(gui.cm_handles.axes_color_mnorm,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0758     <span class="keyword">case</span> <span class="string">'xn'</span>
0759         set(gui.cm_handles.axes_color_none,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0760         set(gui.cm_handles.axes_color_chi2,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0761         set(gui.cm_handles.axes_color_mnorm,<span class="string">'Checked'</span>,<span class="string">'on'</span>);
0762 <span class="keyword">end</span>
0763 uv.colorstyle = get(src,<span class="string">'Tag'</span>);
0764 
0765 <span class="comment">% update GUI data</span>
0766 data.uv = uv;
0767 setappdata(figh,<span class="string">'data'</span>,data);
0768 <span class="comment">% update information and plots</span>
0769 <a href="#_sub10" class="code" title="subfunction uv_updateInformation(figh)">uv_updateInformation</a>(figh);
0770 <span class="keyword">end</span>
0771 
0772 <span class="comment">%% subfunction to control RTD axes context menu</span>
0773 <a name="_sub4" href="#_subfunctions" class="code">function uv_onContextPlotsRTD(src,~)</a>
0774 figh = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
0775 gui = getappdata(figh,<span class="string">'gui'</span>);
0776 data = getappdata(figh,<span class="string">'data'</span>);
0777 uv = data.uv;
0778 
0779 <span class="comment">% switch through different plot options</span>
0780 <span class="keyword">switch</span> get(src,<span class="string">'Tag'</span>)
0781     <span class="keyword">case</span> <span class="string">'lines'</span>
0782         set(gui.cm_handles.axes_rtd_lines,<span class="string">'Checked'</span>,<span class="string">'on'</span>);
0783         set(gui.cm_handles.axes_rtd_patch_mean,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0784         set(gui.cm_handles.axes_rtd_patch_median,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0785     <span class="keyword">case</span> <span class="string">'patchmean'</span>
0786         set(gui.cm_handles.axes_rtd_lines,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0787         set(gui.cm_handles.axes_rtd_patch_mean,<span class="string">'Checked'</span>,<span class="string">'on'</span>);
0788         set(gui.cm_handles.axes_rtd_patch_median,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0789     <span class="keyword">case</span> <span class="string">'patchmedian'</span>
0790         set(gui.cm_handles.axes_rtd_lines,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0791         set(gui.cm_handles.axes_rtd_patch_mean,<span class="string">'Checked'</span>,<span class="string">'off'</span>);
0792         set(gui.cm_handles.axes_rtd_patch_median,<span class="string">'Checked'</span>,<span class="string">'on'</span>);
0793 <span class="keyword">end</span>
0794 uv.rtd_plotstyle = get(src,<span class="string">'Tag'</span>);
0795 
0796 <span class="comment">% update GUI data</span>
0797 data.uv = uv;
0798 setappdata(figh,<span class="string">'data'</span>,data);
0799 <span class="comment">% update information and plots</span>
0800 <a href="#_sub10" class="code" title="subfunction uv_updateInformation(figh)">uv_updateInformation</a>(figh);
0801 <span class="keyword">end</span>
0802 
0803 <span class="comment">%% subfunction to update the logical mask</span>
0804 <a name="_sub5" href="#_subfunctions" class="code">function data = uv_updateMASK(data)</a>
0805 uncert = data.results.invstd.uncert;
0806 uv = data.uv;
0807 
0808 mask1 = uncert.chi2_all &gt;= uv.chi2_range(1) &amp; uncert.chi2_all &lt;= uv.chi2_range(2);
0809 mask2 = uncert.mnorm_all &gt;= uv.mnorm_range(1) &amp; uncert.mnorm_all &lt;= uv.mnorm_range(2);
0810 uv.touse = mask1 &amp; mask2;
0811 
0812 data.uv = uv;
0813 <span class="keyword">end</span>
0814 
0815 <span class="comment">%% subfunction to update control panel based on uncertainty method</span>
0816 <a name="_sub6" href="#_subfunctions" class="code">function uv_onPopupMethod(src,~)</a>
0817 figh = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
0818 gui = getappdata(figh,<span class="string">'gui'</span>);
0819 data = getappdata(figh,<span class="string">'data'</span>);
0820 uv = data.uv;
0821 invstd = data.results.invstd;
0822 
0823 val = get(gui.popup_handles.uncertMethod,<span class="string">'Value'</span>);
0824 
0825 <span class="keyword">switch</span> invstd.invtype
0826     <span class="keyword">case</span> {<span class="string">'LU'</span>,<span class="string">'NNLS'</span>}
0827         <span class="keyword">switch</span> val
0828             <span class="keyword">case</span> 1 <span class="comment">% RMS_free</span>
0829                 uv.uncertMethod = <span class="string">'RMS_free'</span>;
0830                 set(gui.edit_handles.uncertchi2_min,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0831                 set(gui.edit_handles.uncertchi2_max,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0832                 set(gui.edit_handles.uncertmnorm_min,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0833                 set(gui.edit_handles.uncertmnorm_max,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0834                 set(gui.edit_handles.uncertThresh,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0835                 set(gui.edit_handles.uncertMax,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0836             <span class="keyword">case</span> 2 <span class="comment">% RMS_bound</span>
0837                 uv.uncertMethod = <span class="string">'RMS_bound'</span>;
0838                 set(gui.edit_handles.uncertchi2_min,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0839                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range_calc(1)));
0840                 set(gui.edit_handles.uncertchi2_max,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0841                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range_calc(2)));
0842                 set(gui.edit_handles.uncertmnorm_min,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0843                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range_calc(1)));
0844                 set(gui.edit_handles.uncertmnorm_max,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0845                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range_calc(2)));
0846                 set(gui.edit_handles.uncertThresh,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0847                 set(gui.edit_handles.uncertMax,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0848                     <span class="string">'String'</span>,num2str(uv.uncertMax));
0849         <span class="keyword">end</span>
0850     <span class="keyword">case</span> <span class="string">'MUMO'</span>
0851         <span class="keyword">switch</span> val
0852             <span class="keyword">case</span> 1 <span class="comment">% RMS_free</span>
0853                 uv.uncertMethod = <span class="string">'RMS_free'</span>;
0854                 set(gui.edit_handles.uncertchi2_min,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0855                 set(gui.edit_handles.uncertchi2_max,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0856                 set(gui.edit_handles.uncertmnorm_min,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0857                 set(gui.edit_handles.uncertmnorm_max,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0858                 set(gui.edit_handles.uncertThresh,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0859                 set(gui.edit_handles.uncertMax,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0860             <span class="keyword">case</span> 2 <span class="comment">% RMS_bound</span>
0861                 uv.uncertMethod = <span class="string">'RMS_bound'</span>;
0862                 set(gui.edit_handles.uncertchi2_min,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0863                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range_calc(1)));
0864                 set(gui.edit_handles.uncertchi2_max,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0865                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range_calc(2)));
0866                 set(gui.edit_handles.uncertmnorm_min,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0867                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range_calc(1)));
0868                 set(gui.edit_handles.uncertmnorm_max,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0869                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range_calc(2)));
0870                 set(gui.edit_handles.uncertThresh,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0871                 set(gui.edit_handles.uncertMax,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0872                     <span class="string">'String'</span>,num2str(uv.uncertMax));
0873             <span class="keyword">case</span> 3 <span class="comment">% threshold</span>
0874                 uv.uncertMethod = <span class="string">'thresh'</span>;
0875                 uv.chi2_range_calc = [0 10];
0876                 uv.mnorm_range_calc = [0 10];
0877                 set(gui.edit_handles.uncertchi2_min,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0878                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range_calc(1)));
0879                 set(gui.edit_handles.uncertchi2_max,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0880                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range_calc(2)));
0881                 set(gui.edit_handles.uncertmnorm_min,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0882                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range_calc(1)));
0883                 set(gui.edit_handles.uncertmnorm_max,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0884                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range_calc(2)));
0885                 set(gui.edit_handles.uncertThresh,<span class="string">'Enable'</span>,<span class="string">'on'</span>);
0886                 set(gui.edit_handles.uncertMax,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0887                     <span class="string">'String'</span>,num2str(uv.uncertMax));
0888             <span class="keyword">case</span> 4 <span class="comment">% ci - confidence intrval</span>
0889                 uv.uncertMethod = <span class="string">'ci'</span>;
0890                 uv.chi2_range_calc = [0 10];
0891                 uv.mnorm_range_calc = [0 10];
0892                 set(gui.edit_handles.uncertchi2_min,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0893                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range_calc(1)));
0894                 set(gui.edit_handles.uncertchi2_max,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0895                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range_calc(2)));
0896                 set(gui.edit_handles.uncertmnorm_min,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0897                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range_calc(1)));
0898                 set(gui.edit_handles.uncertmnorm_max,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0899                     <span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range_calc(2)));
0900                 set(gui.edit_handles.uncertThresh,<span class="string">'Enable'</span>,<span class="string">'off'</span>);
0901                 set(gui.edit_handles.uncertMax,<span class="string">'Enable'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
0902                     <span class="string">'String'</span>,num2str(uv.uncertMax));
0903         <span class="keyword">end</span>
0904 <span class="keyword">end</span>
0905 
0906 <span class="comment">% update GUI data</span>
0907 data.uv = uv;
0908 setappdata(figh,<span class="string">'data'</span>,data);
0909 <span class="keyword">end</span>
0910 
0911 <span class="comment">%% subfunction to start a new uncertainty calculation</span>
0912 <a name="_sub7" href="#_subfunctions" class="code">function uv_onPushRun(src,~)</a>
0913 figh = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
0914 gui = getappdata(figh,<span class="string">'gui'</span>);
0915 data = getappdata(figh,<span class="string">'data'</span>);
0916 uv = data.uv;
0917 invstd = data.results.invstd;
0918 uncert = invstd.uncert;
0919 
0920 <span class="comment">% original fit parameter</span>
0921 iparam = invstd.invparams;
0922 <span class="comment">% original uncertainty parameter</span>
0923 uparam = uncert.params;
0924 <span class="comment">% new uncertainty parameter from GUI</span>
0925 uparam.uncert.Method = uv.uncertMethod;
0926 uparam.uncert.Thresh = uv.uncertThresh;
0927 uparam.uncert.chi2_range = uv.chi2_range_calc;
0928 uparam.uncert.mnorm_range = uv.mnorm_range_calc;
0929 uparam.uncert.N = uv.uncertN;
0930 uparam.uncert.Max = uv.uncertMax;
0931 invstd = <a href="../../../nucleus/functions/inversion/estimateUncertainty.html" class="code" title="function [invstd,uncert] = estimateUncertainty(invtype,invstd,iparam,parameter)">estimateUncertainty</a>(invstd.invtype,invstd,iparam,uparam);
0932 
0933 <span class="comment">% save updated inversion results</span>
0934 invstd.uncert.params = uparam;
0935 data.results.invstd = invstd;
0936 
0937 <span class="comment">% update GUI data</span>
0938 <span class="comment">% round all chi2 and xn values to 6 digits</span>
0939 chi2_all = data.results.invstd.uncert.chi2_all;
0940 chi2_all = round(1e6.*chi2_all)./1e6;
0941 data.results.invstd.uncert.chi2_all = chi2_all;
0942 mnorm_all = data.results.invstd.uncert.mnorm_all;
0943 mnorm_all = round(1e6.*mnorm_all)./1e6;
0944 data.results.invstd.uncert.mnorm_all = mnorm_all;
0945 
0946 <span class="comment">% create logical mask</span>
0947 uv.touse = ones(uv.uncertN,1);
0948 
0949 <span class="comment">% 1.) control</span>
0950 uv.chi2_range_calc = [min(chi2_all) max(chi2_all)];
0951 uv.mnorm_range_calc = [min(mnorm_all) max(mnorm_all)];
0952 
0953 <span class="comment">% 2.) process</span>
0954 uv.chi2_range = uv.chi2_range_calc;
0955 uv.mnorm_range = uv.mnorm_range_calc;
0956 set(gui.edit_handles.chi2_min,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range(1,1)));
0957 set(gui.edit_handles.chi2_max,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.chi2_range(1,2)));
0958 set(gui.edit_handles.mnorm_min,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range(1,1)));
0959 set(gui.edit_handles.mnorm_max,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,uv.mnorm_range(1,2)));
0960 
0961 <span class="comment">% update data</span>
0962 data.uv = uv;
0963 setappdata(figh,<span class="string">'data'</span>,data);
0964 
0965 <span class="comment">% plot all uncertainty data</span>
0966 <a href="#_sub10" class="code" title="subfunction uv_updateInformation(figh)">uv_updateInformation</a>(figh);
0967 <a href="beautifyAxes.html" class="code" title="function beautifyAxes(figh)">beautifyAxes</a>(figh);
0968 <span class="keyword">end</span>
0969 
0970 <span class="comment">%% subfunction to update the main NUCLEUSinv GUI</span>
0971 <a name="_sub8" href="#_subfunctions" class="code">function uv_onPushUpdate(src,~)</a>
0972 figh = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
0973 <span class="comment">% local GUI data</span>
0974 uvgui = getappdata(figh,<span class="string">'gui'</span>);
0975 uvdata = getappdata(figh,<span class="string">'data'</span>);
0976 <span class="comment">% NUCLEUSinv data</span>
0977 gui = getappdata(uvgui.figh_nucleus,<span class="string">'gui'</span>);
0978 data = getappdata(uvgui.figh_nucleus,<span class="string">'data'</span>);
0979 INVdata = getappdata(uvgui.figh_nucleus,<span class="string">'INVdata'</span>);
0980 
0981 <span class="comment">% get signal id</span>
0982 id = data.results.invstd.uncert.params.id;
0983 <span class="comment">% get data</span>
0984 INVdata0 = INVdata{id};
0985 
0986 <span class="comment">% --- update data ---</span>
0987 <span class="comment">% -- general settings --</span>
0988 data.uncert.N = uvdata.uv.uncertN;
0989 data.uncert.Method = uvdata.uv.uncertMethod;
0990 data.uncert.Thresh = uvdata.uv.uncertThresh;
0991 data.uncert.Max = uvdata.uv.uncertMax;
0992 
0993 <span class="comment">% -- check if data was excluded --</span>
0994 <span class="keyword">if</span> sum(uvdata.uv.touse == 0) &gt; 0
0995     <span class="comment">% if yes, proceed</span>
0996     in = uvdata.uv.touse == 1;
0997     data.uncert.N = sum(in);
0998     uvdata.results.invstd.uncert.params.uncert.N = sum(in);
0999     uvdata.results.invstd.uncert.chi2_all = uvdata.results.invstd.uncert.chi2_all(in);
1000     uvdata.results.invstd.uncert.mnorm_all = uvdata.results.invstd.uncert.mnorm_all(in);
1001     uvdata.results.invstd.uncert.rnorm_all = uvdata.results.invstd.uncert.rnorm_all(in);
1002     uvdata.results.invstd.uncert.interp_f = uvdata.results.invstd.uncert.interp_f(in,:);
1003     uvdata.results.invstd.uncert.interp_s = uvdata.results.invstd.uncert.interp_s(:,in');
1004     uvdata.results.invstd.uncert.interp_E0 = uvdata.results.invstd.uncert.interp_E0(in);
1005     uvdata.results.invstd.uncert.E0 = [mean(uvdata.results.invstd.uncert.interp_E0) std(uvdata.results.invstd.uncert.interp_E0)];
1006     uvdata.results.invstd.uncert.interp_Tlgm = uvdata.results.invstd.uncert.interp_Tlgm(in);
1007     uvdata.results.invstd.uncert.Tlgm = [mean(uvdata.results.invstd.uncert.interp_Tlgm) std(uvdata.results.invstd.uncert.interp_Tlgm)];
1008 <span class="keyword">end</span>
1009 
1010 <span class="comment">% update data structs</span>
1011 data.results.invstd.uncert = uvdata.results.invstd.uncert;
1012 INVdata0.results.invstd = uvdata.results.invstd;
1013 
1014 <span class="comment">% update INVdata</span>
1015 INVdata{id} = INVdata0;
1016 <span class="comment">% update GUI data</span>
1017 setappdata(uvgui.figh_nucleus,<span class="string">'data'</span>,data);
1018 <span class="comment">% update GUI INVdata</span>
1019 setappdata(uvgui.figh_nucleus,<span class="string">'INVdata'</span>,INVdata);
1020 
1021 <span class="comment">% update relevant GUI elements</span>
1022 set(gui.edit_handles.uncert_N,<span class="string">'String'</span>,num2str(data.results.invstd.uncert.params.uncert.N))
1023 
1024 <span class="comment">% update plots and INFO fields in main NUCLEUS GUI</span>
1025 <a href="updatePlotsSignal.html" class="code" title="function updatePlotsSignal">updatePlotsSignal</a>;
1026 <a href="updatePlotsDistribution.html" class="code" title="function updatePlotsDistribution">updatePlotsDistribution</a>;
1027 <a href="updateInfo.html" class="code" title="function updateInfo(src,~) %#ok<INUSD>">updateInfo</a>(gui.plots.SignalPanel);
1028 
1029 <span class="keyword">end</span>
1030 
1031 <span class="comment">%% subfunction to reset chi2 and model norm bounds</span>
1032 <a name="_sub9" href="#_subfunctions" class="code">function uv_onPushReset(src,~)</a>
1033 figh = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
1034 gui = getappdata(figh,<span class="string">'gui'</span>);
1035 data = getappdata(figh,<span class="string">'data'</span>);
1036 uv = data.uv;
1037 invstd = data.results.invstd;
1038 uncert = invstd.uncert;
1039 
1040 <span class="keyword">switch</span> get(src,<span class="string">'Tag'</span>)
1041     <span class="keyword">case</span> <span class="string">'process'</span>
1042         <span class="comment">% reset to original values</span>
1043         chi2_range  = [min(uncert.chi2_all) max(uncert.chi2_all)];
1044         mnorm_range = [min(uncert.mnorm_all) max(uncert.mnorm_all)];
1045         <span class="comment">% update edit fields</span>
1046         set(gui.edit_handles.chi2_min,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,chi2_range(1,1)));
1047         set(gui.edit_handles.chi2_max,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,chi2_range(1,2)));
1048         set(gui.edit_handles.mnorm_min,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,mnorm_range(1,1)));
1049         set(gui.edit_handles.mnorm_max,<span class="string">'String'</span>,sprintf(<span class="string">'%7.6f'</span>,mnorm_range(1,2)));
1050         <span class="comment">% update data</span>
1051         uv.chi2_range = chi2_range;
1052         uv.mnorm_range = mnorm_range;
1053         data.uv = uv;
1054         <span class="comment">% update logical mask for plotting</span>
1055         data = <a href="#_sub5" class="code" title="subfunction data = uv_updateMASK(data)">uv_updateMASK</a>(data);
1056     <span class="keyword">case</span> <span class="string">'rtd'</span>
1057         <span class="comment">% reset to original values</span>
1058         rtd_range = data.invstd.time;
1059         <span class="comment">% update edit fields</span>
1060         set(gui.edit_handles.rtd_min,<span class="string">'String'</span>,num2str(rtd_range(1,1)));
1061         set(gui.edit_handles.rtd_max,<span class="string">'String'</span>,num2str(rtd_range(1,2)));
1062         <span class="comment">% update data</span>
1063         uv.rtd_range = rtd_range;
1064         data.uv = uv;
1065 <span class="keyword">end</span>
1066 
1067 setappdata(figh,<span class="string">'data'</span>,data);
1068 <span class="comment">% update information</span>
1069 <a href="#_sub10" class="code" title="subfunction uv_updateInformation(figh)">uv_updateInformation</a>(figh);
1070 <span class="keyword">end</span>
1071 
1072 <span class="comment">%% subfunction to update the information output</span>
1073 <a name="_sub10" href="#_subfunctions" class="code">function uv_updateInformation(figh)</a>
1074 gui = getappdata(figh,<span class="string">'gui'</span>);
1075 data = getappdata(figh,<span class="string">'data'</span>);
1076 invstd = data.results.invstd;
1077 uncert = invstd.uncert;
1078 uv = data.uv;
1079 
1080 <span class="comment">% which models to use</span>
1081 in = data.uv.touse == 1;
1082 <span class="comment">% RTD time vector</span>
1083 T = data.results.invstd.T1T2me;
1084 <span class="comment">% RTD mask</span>
1085 mask = T &gt;= uv.rtd_range(1) &amp; T &lt;= uv.rtd_range(2);
1086 
1087 <span class="comment">% kernel matrices for pure (single) E0 estimation</span>
1088 iparam = invstd.invparams;
1089 <span class="keyword">switch</span> iparam.T1T2
1090     <span class="keyword">case</span> <span class="string">'T1'</span>
1091         K0 = <a href="../../../nucleus/functions/inversion/createKernelMatrix.html" class="code" title="function K = createKernelMatrix(t,T,Tbulk,Tdiff,Tflag,T1IRfac)">createKernelMatrix</a>(10*data.results.nmrproc.t(end),T',<span class="keyword">...</span>
1092             iparam.Tb,iparam.Td,<span class="string">'T1'</span>,iparam.T1IRfac);
1093     <span class="keyword">case</span> <span class="string">'T2'</span>
1094         K0 = <a href="../../../nucleus/functions/inversion/createKernelMatrix.html" class="code" title="function K = createKernelMatrix(t,T,Tbulk,Tdiff,Tflag,T1IRfac)">createKernelMatrix</a>(0,T',iparam.Tb,<span class="keyword">...</span>
1095             iparam.Td,<span class="string">'T2'</span>,iparam.T1IRfac);
1096 <span class="keyword">end</span>
1097 
1098 TLGM_tmp = zeros(sum(in),1);
1099 E0_tmp = zeros(sum(in),1);
1100 c = 0;
1101 <span class="keyword">for</span> i = 1:size(uncert.interp_f,1)
1102     <span class="keyword">if</span> in(i)
1103         F = uncert.interp_f(i,:);
1104         c = c + 1;
1105         TLGM_tmp(c,1) = <a href="../../../nucleus/functions/inversion/getTLogMean.html" class="code" title="function [TLGM,index] = getTLogMean(T,f,varargin)">getTLogMean</a>(T,F,mask);
1106         E0_tmp(c,1) = K0(mask')*F(mask')';
1107     <span class="keyword">end</span>
1108 <span class="keyword">end</span>
1109 
1110 <span class="comment">% TLGM</span>
1111 uv.Tlgm = [mean(TLGM_tmp) std(TLGM_tmp)];
1112 set(gui.edit_handles.TLGM_mean,<span class="string">'String'</span>,sprintf(<span class="string">'%5.4f'</span>,uv.Tlgm(1)));
1113 set(gui.edit_handles.TLGM_std,<span class="string">'String'</span>,sprintf(<span class="string">'%5.4f'</span>,2*uv.Tlgm(2)));
1114 <span class="comment">% aad - mean</span>
1115 uv.Tlgm_aad = <a href="../../../nucleus/functions/inversion/getAAD.html" class="code" title="function aad = getAAD(x,flag,dim)">getAAD</a>(TLGM_tmp,0);
1116 set(gui.edit_handles.TLGM_aad,<span class="string">'String'</span>,sprintf(<span class="string">'%5.4f'</span>,2*uv.Tlgm_aad));
1117 <span class="comment">% aad - median</span>
1118 uv.Tlgm_aadmed = [median(TLGM_tmp) <a href="../../../nucleus/functions/inversion/getAAD.html" class="code" title="function aad = getAAD(x,flag,dim)">getAAD</a>(TLGM_tmp,1)];
1119 set(gui.edit_handles.TLGM_med,<span class="string">'String'</span>,sprintf(<span class="string">'%5.4f'</span>,uv.Tlgm_aadmed(1)));
1120 set(gui.edit_handles.TLGM_aadmed,<span class="string">'String'</span>,sprintf(<span class="string">'%5.4f'</span>,2*uv.Tlgm_aadmed(2)));
1121 <span class="comment">% E0</span>
1122 uv.E0 = [mean(E0_tmp) std(E0_tmp)];
1123 set(gui.edit_handles.E0_mean,<span class="string">'String'</span>,sprintf(<span class="string">'%5.4f'</span>,uv.E0(1)));
1124 set(gui.edit_handles.E0_std,<span class="string">'String'</span>,sprintf(<span class="string">'%5.4f'</span>,2*uv.E0(2)));
1125 <span class="comment">% aad - mean</span>
1126 uv.E0_aad = <a href="../../../nucleus/functions/inversion/getAAD.html" class="code" title="function aad = getAAD(x,flag,dim)">getAAD</a>(E0_tmp,0);
1127 set(gui.edit_handles.E0_aad,<span class="string">'String'</span>,sprintf(<span class="string">'%5.4f'</span>,2*uv.E0_aad));
1128 <span class="comment">% aad - median</span>
1129 uv.E0_aadmed = [median(E0_tmp) <a href="../../../nucleus/functions/inversion/getAAD.html" class="code" title="function aad = getAAD(x,flag,dim)">getAAD</a>(E0_tmp,1)];
1130 set(gui.edit_handles.E0_med,<span class="string">'String'</span>,sprintf(<span class="string">'%5.4f'</span>,uv.E0_aadmed(1)));
1131 set(gui.edit_handles.E0_aadmed,<span class="string">'String'</span>,sprintf(<span class="string">'%5.4f'</span>,2*uv.E0_aadmed(2)));
1132 
1133 <span class="comment">% update GUI data</span>
1134 data.uv = uv;
1135 setappdata(figh,<span class="string">'data'</span>,data);
1136 <span class="comment">% update plots</span>
1137 <a href="#_sub11" class="code" title="subfunction uv_updatePlots(figh)">uv_updatePlots</a>(figh);
1138 
1139 <span class="keyword">end</span>
1140 
1141 <span class="comment">%% subfunction to update all plots</span>
1142 <a name="_sub11" href="#_subfunctions" class="code">function uv_updatePlots(figh)</a>
1143 gui = getappdata(figh,<span class="string">'gui'</span>);
1144 data = getappdata(figh,<span class="string">'data'</span>);
1145 
1146 <span class="comment">% clear axes</span>
1147 <a href="clearAllAxes.html" class="code" title="function clearAllAxes(figh)">clearAllAxes</a>(figh);
1148 hold(gui.axes11,<span class="string">'on'</span>);
1149 hold(gui.axes12,<span class="string">'on'</span>);
1150 hold(gui.axes2,<span class="string">'on'</span>);
1151 hold(gui.axes21,<span class="string">'on'</span>);
1152 hold(gui.axes22,<span class="string">'on'</span>);
1153 
1154 <span class="comment">% get relevant data</span>
1155 uv = data.uv;
1156 invstd = data.results.invstd;
1157 uncert = invstd.uncert;
1158 col = gui.myui.colors;
1159 
1160 <span class="comment">% get indices for models to use and not to use</span>
1161 in = data.uv.touse == 1;
1162 out = data.uv.touse == 0;
1163 
1164 <span class="keyword">switch</span> uv.colorstyle
1165     <span class="keyword">case</span> <span class="string">'none'</span>
1166         <span class="comment">% default gray</span>
1167         lcolors = [0.5 0.5 0.5];
1168         tmpchi2 = uncert.chi2_all(in);
1169         tmpmnorm = uncert.mnorm_all(in);
1170         tmpE0 = uncert.interp_E0(in);
1171         tmpTlgm = uncert.interp_Tlgm(in);
1172         clims = [0 1];
1173     <span class="keyword">case</span> <span class="string">'chi2'</span>
1174         tmp = uncert.chi2_all(in);
1175         [tmpchi2,idx] = sort(tmp);
1176         lcolors = tmpchi2;
1177         tmpmnorm = uncert.mnorm_all(in);
1178         tmpmnorm = tmpmnorm(idx);
1179         tmpE0 = uncert.interp_E0(in);
1180         tmpE0 = tmpE0(idx);
1181         tmpTlgm = uncert.interp_Tlgm(in);
1182         tmpTlgm = tmpTlgm(idx);
1183         clims = [min(uncert.chi2_all) max(uncert.chi2_all)];
1184     <span class="keyword">case</span> <span class="string">'xn'</span>
1185         tmp = uncert.mnorm_all(in);
1186         [tmpmnorm,idx] = sort(tmp);
1187         lcolors = tmpmnorm;
1188         tmpchi2 = uncert.chi2_all(in);
1189         tmpchi2 = tmpchi2(idx);
1190         tmpE0 = uncert.interp_E0(in);
1191         tmpE0 = tmpE0(idx);
1192         tmpTlgm = uncert.interp_Tlgm(in);
1193         tmpTlgm = tmpTlgm(idx);
1194         clims = [min(uncert.mnorm_all) max(uncert.mnorm_all)];
1195 <span class="keyword">end</span>
1196 
1197 <span class="comment">% --- chi2 vs model norm ---</span>
1198 scatter(uncert.chi2_all(out),uncert.mnorm_all(out),[],<span class="string">'red'</span>,<span class="keyword">...</span>
1199     <span class="string">'LineWidth'</span>,1,<span class="string">'Parent'</span>,gui.axes12);
1200 scatter(gui.axes12,tmpchi2,tmpmnorm,[],lcolors,<span class="keyword">...</span>
1201     <span class="string">'LineWidth'</span>,1);
1202 plot(invstd.chi2,invstd.xn,<span class="string">'+'</span>,<span class="string">'MarkerSize'</span>,10,<span class="string">'Color'</span>,col.FIT,<span class="string">'Parent'</span>,gui.axes12);
1203 <span class="comment">% axis limits</span>
1204 xlims = [min([uncert.chi2_all(in); invstd.chi2]) max([uncert.chi2_all(in); invstd.chi2])];
1205 dx = xlims(2)-xlims(1);
1206 xlims = [xlims(1)-dx/5 xlims(2)+dx/5];
1207 ylims = [min([uncert.mnorm_all(in); invstd.xn]) max([uncert.mnorm_all(in); invstd.xn])];
1208 dy = ylims(2)-ylims(1);
1209 ylims = [ylims(1)-dy/5 ylims(2)+dy/5];
1210 <span class="comment">% -- lines indicating TLGM and E0 bounds --</span>
1211 line([min(uncert.chi2_all(in)) min(uncert.chi2_all(in))],[ylims(1) ylims(2)],<span class="string">'Color'</span>,[0.25 0.25 0.25],<span class="keyword">...</span>
1212     <span class="string">'LineStyle'</span>,<span class="string">':'</span>,<span class="string">'LineWidth'</span>,0.75,<span class="string">'Parent'</span>,gui.axes12,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1213 line([max(uncert.chi2_all(in)) max(uncert.chi2_all(in))],[ylims(1) ylims(2)],<span class="string">'Color'</span>,[0.25 0.25 0.25],<span class="keyword">...</span>
1214     <span class="string">'LineStyle'</span>,<span class="string">':'</span>,<span class="string">'LineWidth'</span>,0.75,<span class="string">'Parent'</span>,gui.axes12,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1215 line([xlims(1) xlims(2)],[min(uncert.mnorm_all(in)) min(uncert.mnorm_all(in))],<span class="string">'Color'</span>,[0.25 0.25 0.25],<span class="keyword">...</span>
1216     <span class="string">'LineStyle'</span>,<span class="string">':'</span>,<span class="string">'LineWidth'</span>,0.75,<span class="string">'Parent'</span>,gui.axes12,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1217 line([xlims(1) xlims(2)],[max(uncert.mnorm_all(in)) max(uncert.mnorm_all(in))],<span class="string">'Color'</span>,[0.25 0.25 0.25],<span class="keyword">...</span>
1218     <span class="string">'LineStyle'</span>,<span class="string">':'</span>,<span class="string">'LineWidth'</span>,0.75,<span class="string">'Parent'</span>,gui.axes12,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1219 <span class="comment">% axis setings</span>
1220 set(gui.axes12,<span class="string">'XScale'</span>,<span class="string">'lin'</span>,<span class="string">'XLim'</span>,xlims);
1221 set(gui.axes12,<span class="string">'YScale'</span>,<span class="string">'log'</span>,<span class="string">'YLim'</span>,ylims);
1222 set(gui.axes12,<span class="string">'CLim'</span>,clims);
1223 set(get(gui.axes12,<span class="string">'XLabel'</span>),<span class="string">'String'</span>,<span class="string">'X (error weighted residuals)'</span>);
1224 set(get(gui.axes12,<span class="string">'YLabel'</span>),<span class="string">'String'</span>,<span class="string">'model norm |Lm|_{2}'</span>);
1225 
1226 <span class="comment">% --- TLGM vs E0 ---</span>
1227 scatter(uncert.interp_Tlgm(out),uncert.interp_E0(out),[],<span class="string">'red'</span>,<span class="keyword">...</span>
1228     <span class="string">'LineWidth'</span>,1,<span class="string">'DisplayName'</span>,<span class="string">'runs (out)'</span>,<span class="string">'Parent'</span>,gui.axes11);
1229 scatter(tmpTlgm,tmpE0,[],lcolors,<span class="keyword">...</span>
1230     <span class="string">'LineWidth'</span>,1,<span class="string">'DisplayName'</span>,<span class="string">'runs (in)'</span>,<span class="string">'Parent'</span>,gui.axes11);
1231 plot(invstd.Tlgm,invstd.E0,<span class="string">'+'</span>,<span class="string">'MarkerSize'</span>,10,<span class="string">'Color'</span>,col.FIT,<span class="keyword">...</span>
1232     <span class="string">'DisplayName'</span>,<span class="string">'init'</span>,<span class="string">'Parent'</span>,gui.axes11);
1233 errorbar(uv.Tlgm(1),uv.E0(1),2*uv.E0(2),2*uv.E0(2),2*uv.Tlgm(2),2*uv.Tlgm(2),<span class="keyword">...</span>
1234     <span class="string">'Color'</span>,col.BoxPRC,<span class="string">'LineWidth'</span>,2,<span class="string">'DisplayName'</span>,<span class="string">'mean (2*std)'</span>,<span class="string">'Parent'</span>,gui.axes11);
1235 errorbar(uv.Tlgm_aadmed(1),uv.E0_aadmed(1),2*uv.E0_aadmed(2),2*uv.E0_aadmed(2),2*uv.Tlgm_aadmed(2),2*uv.Tlgm_aadmed(2),<span class="keyword">...</span>
1236     <span class="string">'Color'</span>,col.BoxCPS,<span class="string">'LineWidth'</span>,2,<span class="string">'DisplayName'</span>,<span class="string">'median (2*aad)'</span>,<span class="string">'Parent'</span>,gui.axes11);
1237 <span class="comment">% axis limits</span>
1238 <span class="comment">% xlims = [min([uncert.interp_Tlgm; invstd.Tlgm; uv.Tlgm(1)])*0.95 ...</span>
1239 <span class="comment">%     max([uncert.interp_Tlgm; invstd.Tlgm; uv.Tlgm(1)])*1.05];</span>
1240 <span class="comment">% ylims = [min([uncert.interp_E0; invstd.E0; uv.E0(1)])*0.95 ...</span>
1241 <span class="comment">%     max([uncert.interp_E0; invstd.E0; uv.E0(1)])*1.05];</span>
1242 xlims = [min([uncert.interp_Tlgm(in); invstd.Tlgm; uv.Tlgm(1)])*0.975 <span class="keyword">...</span>
1243     max([uncert.interp_Tlgm(in); invstd.Tlgm; uv.Tlgm(1)])*1.025];
1244 ylims = [min([uncert.interp_E0(in); invstd.E0; uv.E0(1)])*0.975 <span class="keyword">...</span>
1245     max([uncert.interp_E0(in); invstd.E0; uv.E0(1)])*1.025];
1246 <span class="comment">% -- lines indicating TLGM and E0 bounds --</span>
1247 line([min(uncert.interp_Tlgm(in)) min(uncert.interp_Tlgm(in))],[ylims(1) ylims(2)],<span class="string">'Color'</span>,[0.25 0.25 0.25],<span class="keyword">...</span>
1248     <span class="string">'LineStyle'</span>,<span class="string">':'</span>,<span class="string">'LineWidth'</span>,0.75,<span class="string">'HandleVisibility'</span>,<span class="string">'off'</span>,<span class="string">'Parent'</span>,gui.axes11,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1249 line([max(uncert.interp_Tlgm(in)) max(uncert.interp_Tlgm(in))],[ylims(1) ylims(2)],<span class="string">'Color'</span>,[0.25 0.25 0.25],<span class="keyword">...</span>
1250     <span class="string">'LineStyle'</span>,<span class="string">':'</span>,<span class="string">'LineWidth'</span>,0.75,<span class="string">'HandleVisibility'</span>,<span class="string">'off'</span>,<span class="string">'Parent'</span>,gui.axes11,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1251 line([xlims(1) xlims(2)],[min(uncert.interp_E0(in)) min(uncert.interp_E0(in))],<span class="string">'Color'</span>,[0.25 0.25 0.25],<span class="keyword">...</span>
1252     <span class="string">'LineStyle'</span>,<span class="string">':'</span>,<span class="string">'LineWidth'</span>,0.75,<span class="string">'HandleVisibility'</span>,<span class="string">'off'</span>,<span class="string">'Parent'</span>,gui.axes11,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1253 line([xlims(1) xlims(2)],[max(uncert.interp_E0(in)) max(uncert.interp_E0(in))],<span class="string">'Color'</span>,[0.25 0.25 0.25],<span class="keyword">...</span>
1254     <span class="string">'LineStyle'</span>,<span class="string">':'</span>,<span class="string">'LineWidth'</span>,0.75,<span class="string">'HandleVisibility'</span>,<span class="string">'off'</span>,<span class="string">'Parent'</span>,gui.axes11,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1255 legend(gui.axes11,<span class="string">'Location'</span>,<span class="string">'NorthEast'</span>);
1256 <span class="comment">% axis settings</span>
1257 set(gui.axes11,<span class="string">'XScale'</span>,<span class="string">'lin'</span>,<span class="string">'XLim'</span>,xlims);
1258 set(gui.axes11,<span class="string">'YScale'</span>,<span class="string">'lin'</span>,<span class="string">'YLim'</span>,ylims);
1259 set(gui.axes11,<span class="string">'CLim'</span>,clims);
1260 set(get(gui.axes11,<span class="string">'XLabel'</span>),<span class="string">'String'</span>,<span class="string">'TLGM'</span>);
1261 set(get(gui.axes11,<span class="string">'YLabel'</span>),<span class="string">'String'</span>,<span class="string">'initial amplitude E0'</span>);
1262 
1263 <span class="comment">% --- RTDs ---</span>
1264 plotmethod = 1;
1265 <span class="keyword">switch</span> uv.rtd_plotstyle
1266     <span class="keyword">case</span> <span class="string">'patchmean'</span>
1267         plotmethod = 2;
1268     <span class="keyword">case</span> <span class="string">'patchmedian'</span>
1269         plotmethod = 3;
1270     <span class="keyword">otherwise</span>
1271         <span class="comment">% nothing to do because 'lines' is default</span>
1272 <span class="keyword">end</span>
1273 
1274 <span class="comment">% the 'init' RTD</span>
1275 F0 = invstd.T1T2f;
1276 <span class="comment">% normalize all curves to the median of all E0 values</span>
1277 E0norm = uv.E0_aadmed(1);
1278 <span class="keyword">if</span> sum(F0)&gt;0
1279     F = (data.invstd.porosity*100).*F0./E0norm;
1280     ylims = [0 max(F)*1.05];
1281 <span class="keyword">else</span>
1282     ylims = [-1 1];
1283 <span class="keyword">end</span>
1284 <span class="comment">% the uncertainty runs</span>
1285 <span class="comment">% only the selected ones within the chi2 and xn bounds</span>
1286 FDIST = uncert.interp_f(in,:);
1287 <span class="comment">% scaling</span>
1288 FDIST = (data.invstd.porosity*100).*FDIST./E0norm;
1289 
1290 <span class="comment">% if selected plot lines</span>
1291 <span class="keyword">if</span> plotmethod == 1
1292     <span class="comment">% find maximum for axis limts</span>
1293     f_max = max([ylims(2) max(FDIST(:))]);
1294     <span class="keyword">switch</span> uv.colorstyle
1295         <span class="keyword">case</span> {<span class="string">'chi2'</span>,<span class="string">'xn'</span>}
1296             <span class="comment">% get colormap from chi2 vs xn axis</span>
1297             cmap = get(gui.axes12,<span class="string">'Colormap'</span>);
1298             <span class="comment">% make vector of values to sort</span>
1299             idc = linspace(clims(1),clims(2),size(cmap,1));
1300             <span class="keyword">for</span> i1 = 1:sum(in)
1301                 <span class="comment">% find closest value (need for coloring)</span>
1302                 idc1 = find(abs(idc-tmp(idx(i1)))==min(abs(idc-tmp(idx(i1)))));
1303                 <span class="comment">% idc1 = abs(idc-tmp(idx(i1)))==min(abs(idc-tmp(idx(i1))));</span>
1304                 <span class="comment">% plot line with correct color</span>
1305                 plot(invstd.T1T2me,FDIST(idx(i1),:),<span class="string">'-'</span>,<span class="string">'Color'</span>,cmap(idc1(1),:),<span class="keyword">...</span>
1306                     <span class="string">'LineWidth'</span>,1,<span class="string">'Displayname'</span>,num2str(tmp(idx(i1))),<span class="string">'Parent'</span>,gui.axes2);
1307             <span class="keyword">end</span>
1308             <span class="comment">% adjust color limits</span>
1309             set(gui.axes2,<span class="string">'CLim'</span>,clims);
1310         <span class="keyword">otherwise</span>
1311             <span class="comment">% need to plot transpose of FDIST because 'x' is a column vector</span>
1312             <span class="comment">% otherwise plot goes bananas if numel(x) = #models</span>
1313             plot(invstd.T1T2me,FDIST',<span class="string">'-'</span>,<span class="string">'Color'</span>,[0.5 0.5 0.5],<span class="keyword">...</span>
1314                 <span class="string">'LineWidth'</span>,1,<span class="string">'Parent'</span>,gui.axes2);
1315     <span class="keyword">end</span>
1316 <span class="keyword">end</span>
1317 
1318 <span class="comment">% if selcted plot patch</span>
1319 <span class="keyword">if</span> plotmethod &gt; 1
1320     <span class="comment">% what kind of patch is created</span>
1321     <span class="keyword">if</span> plotmethod == 2 <span class="comment">% mean +- std</span>
1322         mean_f = mean(FDIST);
1323         std_f = std(FDIST);
1324     <span class="keyword">else</span> <span class="comment">% median +- mad</span>
1325         mean_f = median(FDIST);
1326         std_f = <a href="../../../nucleus/functions/inversion/getAAD.html" class="code" title="function aad = getAAD(x,flag,dim)">getAAD</a>(FDIST,1);
1327     <span class="keyword">end</span>
1328 
1329     <span class="comment">% patch lower and upper bounds</span>
1330     patch_f_std1 = [mean_f+std_f;mean_f-std_f];
1331     patch_f_std2 = [mean_f+2*std_f;mean_f-2*std_f];
1332     patch_f_std3 = [mean_f+3*std_f;mean_f-3*std_f];
1333     patch_f_std1(patch_f_std1&lt;0) = 0;
1334     patch_f_std2(patch_f_std2&lt;0) = 0;
1335     patch_f_std3(patch_f_std3&lt;0) = 0;
1336     f_max = max([ylims(2) max(patch_f_std1) max(patch_f_std2) max(patch_f_std3)]);
1337 
1338     <span class="comment">% draw all three patches on top of each other</span>
1339     verts = [invstd.T1T2me patch_f_std3(2,:)'; flipud(invstd.T1T2me) flipud(patch_f_std3(1,:)')];
1340     faces = 1:1:size(verts,1);
1341     patch(<span class="string">'Faces'</span>,faces,<span class="string">'Vertices'</span>,verts,<span class="string">'FaceColor'</span>,[0.6 0.6 0.6],<span class="keyword">...</span>
1342         <span class="string">'FaceAlpha'</span>,0.75,<span class="string">'EdgeColor'</span>,<span class="string">'none'</span>,<span class="string">'Parent'</span>,gui.axes2);
1343     verts = [invstd.T1T2me patch_f_std2(2,:)'; flipud(invstd.T1T2me) flipud(patch_f_std2(1,:)')];
1344     faces = 1:1:size(verts,1);
1345     patch(<span class="string">'Faces'</span>,faces,<span class="string">'Vertices'</span>,verts,<span class="string">'FaceColor'</span>,[0.4 0.4 0.4],<span class="keyword">...</span>
1346         <span class="string">'FaceAlpha'</span>,0.75,<span class="string">'EdgeColor'</span>,<span class="string">'none'</span>,<span class="string">'Parent'</span>,gui.axes2);
1347     verts = [invstd.T1T2me patch_f_std1(2,:)'; flipud(invstd.T1T2me) flipud(patch_f_std1(1,:)')];
1348     faces = 1:1:size(verts,1);
1349     patch(<span class="string">'Faces'</span>,faces,<span class="string">'Vertices'</span>,verts,<span class="string">'FaceColor'</span>,[0.2 0.2 0.2],<span class="keyword">...</span>
1350         <span class="string">'FaceAlpha'</span>,0.75,<span class="string">'EdgeColor'</span>,<span class="string">'none'</span>,<span class="string">'Parent'</span>,gui.axes2);
1351 <span class="keyword">end</span>
1352 
1353 <span class="comment">% adjust y-limits</span>
1354 ylims(2) = max([ylims(2) max(f_max)*1.05]);
1355 
1356 <span class="comment">% plot original solution</span>
1357 plot(invstd.T1T2me,F,<span class="string">'-'</span>,<span class="string">'Color'</span>,col.FIT,<span class="string">'Parent'</span>,gui.axes2);
1358 
1359 <span class="comment">% -- RTD bounds --</span>
1360 uv = data.uv;
1361 line([uv.rtd_range(1) uv.rtd_range(1)],[0 ylims(2)],<span class="string">'Color'</span>,[0.25 0.25 0.25],<span class="keyword">...</span>
1362     <span class="string">'LineStyle'</span>,<span class="string">'-.'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'Parent'</span>,gui.axes2,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1363 line([uv.rtd_range(2) uv.rtd_range(2)],[0 ylims(2)],<span class="string">'Color'</span>,[0.25 0.25 0.25],<span class="keyword">...</span>
1364     <span class="string">'LineStyle'</span>,<span class="string">'-.'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'Parent'</span>,gui.axes2,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1365 
1366 <span class="comment">% axes properties:</span>
1367 ticks = round(log10(min(invstd.T1T2me)) :1: log10(max(invstd.T1T2me)));
1368 set(gui.axes2,<span class="string">'XScale'</span>,<span class="string">'log'</span>,<span class="string">'XLim'</span>,[10^(ticks(1)) 10^(ticks(end))],<span class="string">'XTick'</span>,10.^ticks);
1369 set(gui.axes2,<span class="string">'YScale'</span>,<span class="string">'lin'</span>,<span class="string">'YLim'</span>,ylims);
1370 set(get(gui.axes2,<span class="string">'XLabel'</span>),<span class="string">'String'</span>,<span class="string">'relaxation time'</span>);
1371 set(get(gui.axes2,<span class="string">'YLabel'</span>),<span class="string">'String'</span>,<span class="string">'amplitude'</span>);
1372 grid(gui.axes2,<span class="string">'on'</span>);
1373 
1374 <span class="comment">% --- Histograms ---</span>
1375 hasStatBox = strcmp(data.info.stat,<span class="string">'off'</span>);
1376 <span class="comment">% get the kernel density estimate (more precise compared to a simple histogram)</span>
1377 <span class="keyword">if</span> hasStatBox
1378     <span class="comment">% Statistics ToolBox</span>
1379     [f1,xi1] = ksdensity(uncert.interp_E0(in));
1380     [f2,xi2] = ksdensity(uncert.interp_Tlgm(in));
1381 <span class="keyword">else</span>
1382     <span class="comment">% FEX contribution</span>
1383     [~,f1,xi1] = kde(uncert.interp_E0(in),numel(uncert.interp_E0(in)));
1384     [~,f2,xi2] = kde(uncert.interp_Tlgm(in),numel(uncert.interp_Tlgm(in)));
1385 <span class="keyword">end</span>
1386 
1387 <span class="comment">% plot the KDEs</span>
1388 plot(xi1,f1,<span class="string">'Color'</span>,[0.5 0.5 0.5],<span class="string">'DisplayName'</span>,<span class="string">'KDE'</span>,<span class="string">'Parent'</span>,gui.axes21);
1389 plot(xi2,f2,<span class="string">'Color'</span>,[0.5 0.5 0.5],<span class="string">'DisplayName'</span>,<span class="string">'KDE'</span>,<span class="string">'Parent'</span>,gui.axes22);
1390 
1391 <span class="comment">% &quot;init&quot; E0</span>
1392 line([invstd.E0 invstd.E0],[0 max(f1)],<span class="string">'Color'</span>,col.FIT,<span class="keyword">...</span>
1393     <span class="string">'LineStyle'</span>,<span class="string">':'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'Parent'</span>,gui.axes21,<span class="string">'DisplayName'</span>,<span class="string">'init'</span>,<span class="keyword">...</span>
1394     <span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1395 <span class="comment">% &quot;init&quot; TLGM</span>
1396 line([invstd.Tlgm invstd.Tlgm],[0 max(f2)],<span class="string">'Color'</span>,col.FIT,<span class="keyword">...</span>
1397     <span class="string">'LineStyle'</span>,<span class="string">':'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'Parent'</span>,gui.axes22,<span class="string">'DisplayName'</span>,<span class="string">'init'</span>,<span class="keyword">...</span>
1398     <span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1399 
1400 <span class="comment">% mean E0</span>
1401 line([uv.E0(1) uv.E0(1)],[0 max(f1)],<span class="string">'Color'</span>,col.BoxPRC,<span class="keyword">...</span>
1402     <span class="string">'LineStyle'</span>,<span class="string">'-'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'Parent'</span>,gui.axes21,<span class="string">'DisplayName'</span>,<span class="string">'mean'</span>);
1403 line([uv.E0(1)+2*uv.E0(2) uv.E0(1)+2*uv.E0(2)],[0 max(f1)],<span class="string">'Color'</span>,col.BoxPRC,<span class="keyword">...</span>
1404     <span class="string">'LineStyle'</span>,<span class="string">'--'</span>,<span class="string">'LineWidth'</span>,1,<span class="string">'Parent'</span>,gui.axes21,<span class="string">'DisplayName'</span>,<span class="string">'2*std'</span>);
1405 line([uv.E0(1)-2*uv.E0(2) uv.E0(1)-2*uv.E0(2)],[0 max(f1)],<span class="string">'Color'</span>,col.BoxPRC,<span class="keyword">...</span>
1406     <span class="string">'LineStyle'</span>,<span class="string">'--'</span>,<span class="string">'LineWidth'</span>,1,<span class="string">'Parent'</span>,gui.axes21,<span class="string">'DisplayName'</span>,<span class="string">'2*std'</span>,<span class="keyword">...</span>
1407     <span class="string">'HandleVisibility'</span>,<span class="string">'off'</span>,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1408 
1409 <span class="comment">% mean TLGM</span>
1410 line([uv.Tlgm(1) uv.Tlgm(1)],[0 max(f2)],<span class="string">'Color'</span>,col.BoxPRC,<span class="keyword">...</span>
1411     <span class="string">'LineStyle'</span>,<span class="string">'-'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'Parent'</span>,gui.axes22,<span class="string">'DisplayName'</span>,<span class="string">'mean'</span>);
1412 line([uv.Tlgm(1)+2*uv.Tlgm(2) uv.Tlgm(1)+2*uv.Tlgm(2)],[0 max(f2)],<span class="string">'Color'</span>,col.BoxPRC,<span class="keyword">...</span>
1413     <span class="string">'LineStyle'</span>,<span class="string">'--'</span>,<span class="string">'LineWidth'</span>,1,<span class="string">'Parent'</span>,gui.axes22,<span class="string">'DisplayName'</span>,<span class="string">'2*std'</span>);
1414 line([uv.Tlgm(1)-2*uv.Tlgm(2) uv.Tlgm(1)-2*uv.Tlgm(2)],[0 max(f2)],<span class="string">'Color'</span>,col.BoxPRC,<span class="keyword">...</span>
1415     <span class="string">'LineStyle'</span>,<span class="string">'--'</span>,<span class="string">'LineWidth'</span>,1,<span class="string">'Parent'</span>,gui.axes22,<span class="string">'DisplayName'</span>,<span class="string">'2*std'</span>,<span class="keyword">...</span>
1416     <span class="string">'HandleVisibility'</span>,<span class="string">'off'</span>,<span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1417 
1418 <span class="comment">% median E0</span>
1419 line([uv.E0_aadmed(1) uv.E0_aadmed(1)],[0 max(f1)],<span class="string">'Color'</span>,col.BoxCPS,<span class="keyword">...</span>
1420     <span class="string">'LineStyle'</span>,<span class="string">'-'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'Parent'</span>,gui.axes21,<span class="string">'DisplayName'</span>,<span class="string">'median'</span>);
1421 line([uv.E0_aadmed(1)+2*uv.E0_aadmed(2) uv.E0_aadmed(1)+2*uv.E0_aadmed(2)],<span class="keyword">...</span>
1422     [0 max(f1)],<span class="string">'Color'</span>,col.BoxCPS,<span class="string">'LineStyle'</span>,<span class="string">'--'</span>,<span class="string">'LineWidth'</span>,1,<span class="keyword">...</span>
1423     <span class="string">'Parent'</span>,gui.axes21,<span class="string">'DisplayName'</span>,<span class="string">'2*aad'</span>);
1424 line([uv.E0_aadmed(1)-2*uv.E0_aadmed(2) uv.E0_aadmed(1)-2*uv.E0_aadmed(2)],<span class="keyword">...</span>
1425     [0 max(f1)],<span class="string">'Color'</span>,col.BoxCPS,<span class="string">'LineStyle'</span>,<span class="string">'--'</span>,<span class="string">'LineWidth'</span>,1,<span class="keyword">...</span>
1426     <span class="string">'Parent'</span>,gui.axes21,<span class="string">'DisplayName'</span>,<span class="string">'2*aad'</span>,<span class="string">'HandleVisibility'</span>,<span class="string">'off'</span>,<span class="keyword">...</span>
1427     <span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1428 
1429 <span class="comment">% median TLGM</span>
1430 line([uv.Tlgm_aadmed(1) uv.Tlgm_aadmed(1)],[0 max(f2)],<span class="string">'Color'</span>,col.BoxCPS,<span class="keyword">...</span>
1431     <span class="string">'LineStyle'</span>,<span class="string">'-'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'Parent'</span>,gui.axes22,<span class="string">'DisplayName'</span>,<span class="string">'median'</span>);
1432 line([uv.Tlgm_aadmed(1)+2*uv.Tlgm_aadmed(2) uv.Tlgm_aadmed(1)+2*uv.Tlgm_aadmed(2)],<span class="keyword">...</span>
1433     [0 max(f2)],<span class="string">'Color'</span>,col.BoxCPS,<span class="string">'LineStyle'</span>,<span class="string">'--'</span>,<span class="string">'LineWidth'</span>,1,<span class="keyword">...</span>
1434     <span class="string">'Parent'</span>,gui.axes22,<span class="string">'DisplayName'</span>,<span class="string">'2*aad'</span>);
1435 line([uv.Tlgm_aadmed(1)-2*uv.Tlgm_aadmed(2) uv.Tlgm_aadmed(1)-2*uv.Tlgm_aadmed(2)],<span class="keyword">...</span>
1436     [0 max(f2)],<span class="string">'Color'</span>,col.BoxCPS,<span class="string">'LineStyle'</span>,<span class="string">'--'</span>,<span class="string">'LineWidth'</span>,1,<span class="keyword">...</span>
1437     <span class="string">'Parent'</span>,gui.axes22,<span class="string">'DisplayName'</span>,<span class="string">'2*aad'</span>,<span class="string">'HandleVisibility'</span>,<span class="string">'off'</span>,<span class="keyword">...</span>
1438     <span class="string">'Tag'</span>,<span class="string">'infolines'</span>);
1439 
1440 legend(gui.axes22,<span class="string">'Location'</span>,<span class="string">'NorthWest'</span>);
1441 
1442 <span class="comment">% axes properties</span>
1443 set(get(gui.axes21,<span class="string">'XLabel'</span>),<span class="string">'String'</span>,<span class="string">'E0'</span>);
1444 set(get(gui.axes21,<span class="string">'YLabel'</span>),<span class="string">'String'</span>,<span class="string">'kernel denisty estimate'</span>);
1445 set(get(gui.axes22,<span class="string">'XLabel'</span>),<span class="string">'String'</span>,<span class="string">'TLGM'</span>);
1446 set(get(gui.axes22,<span class="string">'YLabel'</span>),<span class="string">'String'</span>,<span class="string">'kernel density estimate'</span>);
1447 
1448 <span class="comment">% hold off all axes</span>
1449 hold(gui.axes11,<span class="string">'off'</span>);
1450 hold(gui.axes12,<span class="string">'off'</span>);
1451 hold(gui.axes2,<span class="string">'off'</span>);
1452 hold(gui.axes21,<span class="string">'off'</span>);
1453 hold(gui.axes22,<span class="string">'off'</span>);
1454 <span class="keyword">end</span>
1455 
1456 <span class="comment">%% close function</span>
1457 <a name="_sub12" href="#_subfunctions" class="code">function uv_closeme(src,~)</a>
1458 figh = ancestor(src,<span class="string">'figure'</span>,<span class="string">'toplevel'</span>);
1459 <span class="comment">% try to close the sub GUI in a clean manner</span>
1460 <span class="keyword">try</span>
1461     <span class="comment">% NOTE: maybe needed at some later point</span>
1462     <span class="comment">%     gui = getappdata(figh,'gui');</span>
1463     <span class="comment">%     data = getappdata(gui.figh_nucleus,'data');</span>
1464     <span class="comment">%     % update NUCLEUSinv</span>
1465     <span class="comment">%     setappdata(gui.figh_nucleus,'data',data);</span>
1466     delete(figh);
1467 <span class="keyword">catch</span>
1468     <span class="comment">% if this is not working: just close it</span>
1469     delete(figh);
1470 <span class="keyword">end</span>
1471 
1472 <span class="keyword">end</span>
1473 
1474 <span class="comment">%------------- END OF CODE --------------</span>
1475 
1476 <span class="comment">%% License:</span>
1477 <span class="comment">% MIT License</span>
1478 <span class="comment">%</span>
1479 <span class="comment">% Copyright (c) 2024 Thomas Hiller</span>
1480 <span class="comment">%</span>
1481 <span class="comment">% Permission is hereby granted, free of charge, to any person obtaining a copy</span>
1482 <span class="comment">% of this software and associated documentation files (the &quot;Software&quot;), to deal</span>
1483 <span class="comment">% in the Software without restriction, including without limitation the rights</span>
1484 <span class="comment">% to use, copy, modify, merge, publish, distribute, sublicense, and/or sell</span>
1485 <span class="comment">% copies of the Software, and to permit persons to whom the Software is</span>
1486 <span class="comment">% furnished to do so, subject to the following conditions:</span>
1487 <span class="comment">%</span>
1488 <span class="comment">% The above copyright notice and this permission notice shall be included in all</span>
1489 <span class="comment">% copies or substantial portions of the Software.</span>
1490 <span class="comment">%</span>
1491 <span class="comment">% THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
1492 <span class="comment">% IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
1493 <span class="comment">% FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span>
1494 <span class="comment">% AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span>
1495 <span class="comment">% LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span>
1496 <span class="comment">% OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE</span>
1497 <span class="comment">% SOFTWARE.</span></pre></div>
<hr><address>Generated by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>